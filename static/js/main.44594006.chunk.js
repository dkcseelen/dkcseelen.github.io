(this.webpackJsonpcontexion=this.webpackJsonpcontexion||[]).push([[0],{43:function(e,t,n){},44:function(e,t,n){"use strict";n.r(t);var r,a=n(0),i=n.n(a),o=n(22),s=n.n(o),l=n(7),c=n(10),u=n(13),h=n(5),d=n(3);!function(e){e.Green="green",e.Red="red",e.Blue="blue",e.Yellow="#fff020"}(r||(r={}));var p=function(e){var t={marginLeft:5,marginRight:5};return i.a.createElement("div",null,i.a.createElement("button",{style:t,onClick:function(){e.valueChanged(e.value-1)}},"-"),i.a.createElement("label",null,e.value),i.a.createElement("button",{style:t,onClick:function(){e.valueChanged(e.value+1)}},"+"))};function C(e){return e.players.find((function(t){return t.id===e.activePlayerId}))}function f(e){var t=C(e);return null===t||void 0===t?void 0:t.machines.find((function(e){return e.Id===t.activeMachineId}))}function v(e){return C(e).cellSize}function m(e){return{type:"SwitchScreen",screen:e}}var g=n(2),b=n(9),y=n.n(b),w=n(12),O=n(4),S=n(6);function k(e,t){return e.replaceAll("*","{".concat(t,"}"))}function I(e,t){return e.replaceAll("{".concat(t,"}"),"*")}var M=function(){function e(){Object(O.a)(this,e),this.actor={Act:function(e){var t=[],n="*"+e.Content;return t.push({Content:n,Channel:r.Green}),Promise.resolve(t)}},this.id="10"}return Object(S.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Style:{BorderColor:"blue",Color:"grey",Name:"Add *",Description:"Puts a star in front of the string. Each machine adds a unique star, so the star added can only be equal to another star added by this machine"},Api:{InputChannels:[r.Green],OutputChannels:[r.Green]},DependingOn:[],DirectlyDependingOn:[]}}}]),e}(),D=function(){function e(){Object(O.a)(this,e),this.actor={Act:function(e){var t=[],n="0"+e.Content;return t.push({Content:n,Channel:r.Green}),Promise.resolve(t)}},this.id="11"}return Object(S.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Style:{BorderColor:"#fff020",Color:"darkorange",Name:"Add 0",Description:"Puts a zero in front of the string"},Api:{InputChannels:[r.Green],OutputChannels:[r.Green]},DependingOn:[],DirectlyDependingOn:[]}}}]),e}(),x=function(){function e(){Object(O.a)(this,e),this.actor={Act:function(e){var t=[],n=r.Green;if(e.Content.length<2)n=r.Red;else if("{"!==e.Content[0])e.Content[0]!==e.Content[1]&&(n=r.Red);else{var a=e.Content.indexOf("}"),i=e.Content.substring(0,a+1);if(e.Content.length<2*i.length)n=r.Red;else e.Content.substring(a+1,a+i.length+1)!==i&&(n=r.Red)}return t.push({Content:e.Content,Channel:n}),Promise.resolve(t)}},this.id="9"}return Object(S.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Style:{BorderColor:"red",Color:"green",Name:"Compare",Description:"Compares the first two characters in the string. If they are the same, exits green. If they are different exits red"},Api:{InputChannels:[r.Green],OutputChannels:[r.Green,r.Red]},DependingOn:[],DirectlyDependingOn:[]}}}]),e}(),E=function(){function e(){Object(O.a)(this,e),this.actor={Act:function(e){var t,n=[];if(e.Content.length<1)t="";else if("{"!==e.Content[0])t=e.Content[0]+e.Content;else{var a=e.Content.indexOf("}");t=e.Content.substring(0,a+1)+e.Content}return n.push({Content:t,Channel:r.Green}),Promise.resolve(n)}},this.id="6"}return Object(S.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Style:{BorderColor:"green",Color:"yellow",Name:"Copy",Description:"Copies the first character of the string and puts it in front of the string"},Api:{InputChannels:[r.Green],OutputChannels:[r.Green]},DependingOn:[],DirectlyDependingOn:[]}}}]),e}(),G=function(){function e(){Object(O.a)(this,e),this.actor={Act:function(e){var t,n=[];if(e.Content.length<1)t="";else if("{"!==e.Content[0])t=e.Content.substring(1);else{var a=e.Content.indexOf("}");t=e.Content.substring(a+1)}return n.push({Content:t,Channel:r.Green}),Promise.resolve(n)}},this.id="7"}return Object(S.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Style:{BorderColor:"firebrick",Color:"red",Name:"Delete",Description:"Deletes the first character of the string"},Api:{InputChannels:[r.Green],OutputChannels:[r.Green]},DependingOn:[],DirectlyDependingOn:[]}}}]),e}(),T=function(){function e(){Object(O.a)(this,e),this.actor={Act:function(e){var t=[];return t.push({Content:e.Content,Channel:r.Green}),Promise.resolve(t)}},this.id="0"}return Object(S.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Style:{Color:"white",BorderColor:"green",Name:"Start",Description:"Starting point of the computation. Acts as a move machine for all other purposes"},Api:{InputChannels:[r.Green],OutputChannels:[r.Green]},DependingOn:[],DirectlyDependingOn:[]}}}]),e}(),A=function(){function e(){Object(O.a)(this,e),this.actor={Act:function(e){var t=[],n="";if(e.Content.length>0){var a=e.Content[0];n=a>="0"&&a<="8"||a>="a"&&a<"z"||a>="A"&&a<"Z"?String.fromCharCode(a.charCodeAt(0)+1)+e.Content.slice(1):"9"===a?"0"+e.Content.slice(1):"z"===a?"a"+e.Content.slice(1):"Z"===a?"A"+e.Content.slice(1):e.Content}return t.push({Content:n,Channel:r.Green}),Promise.resolve(t)}},this.id="12"}return Object(S.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Style:{BorderColor:"DodgerBlue",Color:"MediumVioletRed",Name:"Increment",Description:"Increases a number in front of the string by 1, makes a letter the next letter in the alphabet. 9 becomes 0, z becomes a. All other starting characters are not changed"},Api:{InputChannels:[r.Green],OutputChannels:[r.Green]},DependingOn:[],DirectlyDependingOn:[]}}}]),e}(),j=function(){function e(){Object(O.a)(this,e),this.actor={Act:function(e){var t=[];return t.push({Content:e.Content,Channel:r.Green}),Promise.resolve(t)}},this.id="5"}return Object(S.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Style:{Color:"green",BorderColor:"lightgreen",Name:"Move",Description:"Does nothing with the string, only used to get the message to the right place"},Api:{InputChannels:[r.Green],OutputChannels:[r.Green]},DependingOn:[],DirectlyDependingOn:[]}}}]),e}(),R=function(){function e(){Object(O.a)(this,e),this.actor={Act:function(e){var t=[];return t.push({Content:e.Content,Channel:r.Green}),Promise.resolve(t)}},this.id="1"}return Object(S.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Style:{Color:"white",BorderColor:"red",Name:"Start",Description:"Starting point of the computation. Acts as a move machine for all other purposes"},Api:{InputChannels:[r.Green],OutputChannels:[r.Green]},DependingOn:[],DirectlyDependingOn:[]}}}]),e}(),F=function(){function e(){Object(O.a)(this,e),this.actor={Act:function(e){var t,n=[];if(e.Content.length<2)t=e.Content;else if("{"!==e.Content[0])t=e.Content.substring(1)+e.Content.substring(0,1);else{var a=e.Content.indexOf("}");t=e.Content.substring(a+1)+e.Content.substring(0,a+1)}return n.push({Content:t,Channel:r.Green}),Promise.resolve(n)}},this.id="8"}return Object(S.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Style:{BorderColor:"blue",Color:"cyan",Name:"Rotate",Description:"Removes the first character of the string, and adds it to the end of the string"},Api:{InputChannels:[r.Green],OutputChannels:[r.Green]},DependingOn:[],DirectlyDependingOn:[]}}}]),e}();function L(e){return e.length<6}function B(e){return"0"===e||"1"===e||"2"===e||"3"===e}var N=n(17),P=n(31),z=function e(){Object(O.a)(this,e)};function W(){var e=new Int32Array(4);e=window.crypto.getRandomValues(e);var t="";return e.forEach((function(e){t+=e.toString(16)})),t}function U(e){return e=e.replaceAll("(","").replaceAll(")","").replaceAll("{","").replaceAll("}","")}z.CellSize=100,z.MinimumColumns=6,z.MinimumRows=5,z.MenuBackGround="rgba(255,255,255,0.86)";var q=n(8);function V(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:K,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,r=Math.round(Math.random()*(n-t))+t,a="",i=e.length,o=0;o<r;o++)a+=e[Math.round(Math.random()*(i-1))];return a}var Y,H="abcdefghijklmnopqrstuvwxyz",X="ABCDEFGHIJKLMNOPQRSTUVWXYZ",_="0123456789",J="!@#$%^&_-+= []\\|:;?.,/'",K=H+X+_+J;function Z(e,t,n){return[{Order:0,Channel:r.Green,Content:V(e,t,n)}]}function Q(){for(var e=Math.round(6*Math.random())+3,t="",n=K.length,a=0;a<e;a++){var i=K[Math.round(Math.random()*(n-1))],o=Math.round(6*Math.random());0===o&&o++,t+=i.repeat(o)}return[{Order:0,Channel:r.Green,Content:t}]}!function(e){e[e.Up=0]="Up",e[e.Right=1]="Right",e[e.Down=2]="Down",e[e.Left=3]="Left"}(Y||(Y={}));var $={AllowedMachines:["0","5","6","7","8","9","10","11","12"],LevelDescription:"The machine should append the length of the input string to the string",MachineDescription:"Appends the length of the input string to the string",Name:"AppendLength",Id:"13",Style:{Color:"Brown",BorderColor:"RebeccaPurple"},InputChannels:[],OutputChannels:[{Channel:r.Green,Direction:Y.Right,Status:"Exists"}],Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"four"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"aabccd"}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"1"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"This is hard"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"This might even be harder"}],showing:!0}],Cell:{Row:1,Column:7},GetRandomTestInputs:function(){return Z(K,0,30)},GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){var i=t.value;n.push({Channel:r.Green,Order:i.Order,Content:i.Content+i.Content.length.toString()})}}catch(o){a.e(o)}finally{a.f()}return n}};var ee={AllowedMachines:["0","5","6","7","8","9","10","11","12"],LevelDescription:"The machine should return the length of the input string",MachineDescription:"Returns the length of the input string",Name:"GetLength",Id:"15",Style:{Color:"GoldenRod",BorderColor:"Orchid"},InputChannels:[],OutputChannels:[{Channel:r.Green,Direction:Y.Up,Status:"Exists"}],Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"four"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"aabccd"}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"1"}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"This is hard"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"This might even be harder"}],showing:!0}],Cell:{Row:2,Column:7},GetRandomTestInputs:function(){return Z(K,0,30)},GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){var i=t.value;n.push({Channel:r.Green,Order:i.Order,Content:i.Content.length.toString()})}}catch(o){a.e(o)}finally{a.f()}return n}};var te={AllowedMachines:["0","5","6","7","8","9","10","11","12"],LevelDescription:"The machine should exit green if the first character is a number, exit red if it is a letter and exit blue otherwise",MachineDescription:"Exits green if the first character is a number, exits red if it is a letter and exits blue otherwise",Name:"GetType",Id:"16",Style:{Color:"Orange",BorderColor:"LightGoldenRodYellow"},InputChannels:[],OutputChannels:[{Channel:r.Blue,Direction:Y.Down,Status:"Exists"},{Channel:r.Green,Direction:Y.Right,Status:"Exists"}],Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"42"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"this starts with a letter"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:",#@%!"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!0}],Cell:{Row:2,Column:3},GetRandomTestInputs:Z,GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){var i=t.value,o=r.Blue;if(0===i.Content.length)o=r.Blue;else{var s=i.Content[0];-1!==_.indexOf(s)?o=r.Green:(-1!==H.indexOf(s)||-1!==X.indexOf(s))&&(o=r.Red)}n.push({Channel:o,Order:i.Order,Content:i.Content})}}catch(l){a.e(l)}finally{a.f()}return n}};var ne={AllowedMachines:["0","5","6","7","9"],LevelDescription:"The machine should exit green if the message is empty, otherwise exit red",MachineDescription:"Exits green if the message is empty, otherwise exits red",Name:"IsEmpty",Id:"1",Style:{Color:"OrangeRed",BorderColor:"ForestGreen"},InputChannels:[{Direction:Y.Right,Channel:r.Green,Status:"Exists",UseMachineColor:!0}],OutputChannels:[{Channel:r.Green,Direction:Y.Down,Status:"Exists"}],Tests:[{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"abc"}],showing:!0}],Cell:{Row:0,Column:0},GetRandomTestInputs:Z,GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){var i=t.value;""===i.Content?n.push({Channel:r.Green,Order:i.Order,Content:i.Content}):n.push({Channel:r.Red,Order:i.Order,Content:i.Content})}}catch(o){a.e(o)}finally{a.f()}return n}};var re={AllowedMachines:["0","5","6","7","8","9","10","11","12"],LevelDescription:"The machine should keep all numbers in the input string, and remove all other characters",MachineDescription:"Keeps all numbers in the input string, and removes all other characters",Name:"KeepNumbers",Id:"6",Style:{Color:"PeachPuff",BorderColor:"DarkOrchid"},InputChannels:[],OutputChannels:[{Channel:r.Green,Direction:Y.Down,Status:"Exists"}],Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"42"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"fortytwo"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"1 and 1 is"}],showing:!0}],Cell:{Row:3,Column:3},GetRandomTestInputs:function(){return Z(_+H+J)},GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){var i,o=t.value,s="",l=Object(g.a)(o.Content);try{for(l.s();!(i=l.n()).done;){var c=i.value;-1!==_.indexOf(c)&&(s+=c)}}catch(u){l.e(u)}finally{l.f()}n.push({Channel:r.Green,Order:o.Order,Content:s})}}catch(u){a.e(u)}finally{a.f()}return n}};var ae={AllowedMachines:["0","5","6","7","8","9","10","11","12"],LevelDescription:"The machine should increase the leading input number by 1",MachineDescription:"Increase the input number by 1",Name:"PlusOne",Id:"7",Style:{Color:"Indigo",BorderColor:"DarkTurquoise"},InputChannels:[],OutputChannels:[{Channel:r.Green,Direction:Y.Right,Status:"Exists"}],Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"4"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"0 and some noise 2"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"42"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"9"}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"39"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"23999999 9"}],showing:!0}],Cell:{Row:2,Column:6},GetRandomTestInputs:function(){var e=V("123456789",1,1)+V(_+"ab",0,5);return[{Order:0,Channel:r.Green,Content:e}]},GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){for(var i=t.value,o="",s=i.Content;s.length>0;){if(-1===_.indexOf(s[0]))break;o+=s[0],s=s.slice(1)}if(o.length>1&&"0"===o[0])return[];var l=Number.parseInt(o,10);isNaN(l)?n.push({Channel:r.Green,Order:i.Order,Content:s}):n.push({Channel:r.Green,Order:i.Order,Content:(l+1).toString()+s})}}catch(c){a.e(c)}finally{a.f()}return n}};var ie={AllowedMachines:["0","5","6","7","8","9","10"],LevelDescription:"The machine should remove all repeating characters from the input string",MachineDescription:"Removes all repeating characters from the input string",Name:"RemoveRepeats",Id:"8",Style:{Color:"Brown",BorderColor:"Indigo"},InputChannels:[],OutputChannels:[{Channel:r.Green,Direction:Y.Right,Status:"Exists"}],Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"aabc"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"aaaabccc"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"a"}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"hhhhhhhhhiiiii wwwworllllldddddddd"}],showing:!0}],Cell:{Row:1,Column:1},GetRandomTestInputs:Q,GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){for(var i=t.value,o=i.Content,s="";o.length>1;)o[0]!==o[1]&&(s+=o[0]),o=o.slice(1);s+=o,n.push({Channel:r.Green,Order:i.Order,Content:s})}}catch(l){a.e(l)}finally{a.f()}return n}};var oe={AllowedMachines:["0","5","6","7","8","9","10","11","12"],LevelDescription:"The machine should put the last character in front of the string",MachineDescription:"Rotates the last character to the front of the string",Name:"RotateBackwards",Id:"11",Style:{Color:"Blue",BorderColor:"Cyan"},InputChannels:[],OutputChannels:[{Channel:r.Red,Direction:Y.Right,Status:"Exists"},{Channel:r.Blue,Direction:Y.Up,Status:"Exists"},{Channel:r.Green,Direction:Y.Down,Status:"Exists"}],Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"abc"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"otater"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"a"}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"heat proofC"}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"ello world!H"}],showing:!0}],Cell:{Row:2,Column:5},GetRandomTestInputs:Z,GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){var i=t.value,o=i.Content.length>1?i.Content[i.Content.length-1]+i.Content.slice(0,i.Content.length-1):i.Content;n.push({Channel:r.Green,Order:i.Order,Content:o})}}catch(s){a.e(s)}finally{a.f()}return n}};var se={AllowedMachines:["0","1","2","3","5","6","7","8","9","10","11","12","13","14"],LevelDescription:"Sandbox level, no specific goals",MachineDescription:"",Name:"Sandbox",Id:"12",Style:{Color:"DarkOliveGreen",BorderColor:"Tomato"},InputChannels:[],OutputChannels:[],Tests:[],Cell:{Row:-1,Column:-1},GetRandomTestInputs:Z,GetTestExpectedOutputs:function(e){return[]}};var le={AllowedMachines:["0","5","6","7","8","9","10","11","12"],LevelDescription:"The machine should reverse the characters from the string. Input are only lowercase letters. With limited number of machines at your disposal, this is VERY HARD",MachineDescription:"Reverses the characters from the string. Input can only consist of lowercase letters",Name:"ReverseLimited",Id:"10",Style:{Color:"MediumSlateBlue",BorderColor:"Black"},InputChannels:[],OutputChannels:[{Channel:r.Green,Direction:Y.Right,Status:"Exists"}],Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"abc"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"a"}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"esrever"}],showing:!0}],Cell:{Row:1,Column:9},GetRandomTestInputs:function(){return Z(H)},GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){var i,o=t.value,s="",l=Object(g.a)(o.Content);try{for(l.s();!(i=l.n()).done;){var c=i.value;if(-1===H.indexOf(c))return[]}}catch(h){l.e(h)}finally{l.f()}for(var u=o.Content.length-1;u>=0;u--)s+=o.Content[u];n.push({Channel:r.Green,Order:o.Order,Content:s})}}catch(h){a.e(h)}finally{a.f()}return n}};var ce={AllowedMachines:["0","5","6","7","8","9","10","12","13","14"],LevelDescription:"The machine should reverse the characters from the input string",MachineDescription:"Reverses the characters from the input string",Name:"Reverse",Id:"9",Style:{Color:"MediumSlateBlue",BorderColor:"Aqua"},InputChannels:[],OutputChannels:[{Channel:r.Green,Direction:Y.Right,Status:"Exists"}],Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"abc"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"a"}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"desrever saw sihT"}],showing:!0}],Cell:{Row:4,Column:6},GetRandomTestInputs:function(){return Z(K,3,8)},GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){for(var i=t.value,o="",s=i.Content.length-1;s>=0;s--)o+=i.Content[s];n.push({Channel:r.Green,Order:i.Order,Content:o})}}catch(l){a.e(l)}finally{a.f()}return n}};var ue={AllowedMachines:["0","1","2","3","5","6","7","8","9","10","11","12","13","14"],LevelDescription:"The machine should exit the input both to green and red",MachineDescription:"Exits the input both to green and red",Name:"CopyAll",Id:"14",Style:{Color:"LightGreen",BorderColor:"Yellow"},InputChannels:[],OutputChannels:[{Channel:r.Green,Direction:Y.Down,Status:"Exists"}],Tests:[{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"a"}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"abc"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"aabcc"}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"Copied"}],showing:!0}],Cell:{Row:4,Column:8},GetRandomTestInputs:Z,GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){var i=t.value;n.push({Channel:r.Green,Order:i.Order,Content:i.Content}),n.push({Channel:r.Red,Order:i.Order,Content:i.Content})}}catch(o){a.e(o)}finally{a.f()}return n}};var he={AllowedMachines:["0","5","6","7","8","9","10","11","12"],LevelDescription:"The machine should decrement the leading character, turning 0 into 9, a/A into z/Z",MachineDescription:"Decrements the leading character",Name:"Decrement",Id:"20",Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"bbc"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"0321"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"@bc"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"Iello world"}],showing:!0}],Style:{Color:"MediumVioletRed",BorderColor:"Orange"},InputChannels:[],OutputChannels:[{Channel:r.Green,Direction:Y.Right,Status:"Exists"}],Cell:{Row:2,Column:4},GetRandomTestInputs:Z,GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){var i=t.value,o="";if(i.Content.length>0){var s=i.Content[0],l=s,c=!1,u=de(s,_),h=Object(d.a)(u,2);if(c=h[0],l=h[1],!c){var p=de(s,H),C=Object(d.a)(p,2);c=C[0],l=C[1]}if(!c){var f=de(s,X),v=Object(d.a)(f,2);c=v[0],l=v[1]}o=l+i.Content.substring(1)}n.push({Channel:r.Green,Order:i.Order,Content:o})}}catch(m){a.e(m)}finally{a.f()}return n}};function de(e,t){var n=t.indexOf(e);return-1===n?[!1,e]:n>0?[!0,t[n-1]]:[!0,t[t.length-1]]}var pe={AllowedMachines:["0","5","6","7","8","9","10","12"],LevelDescription:"The machine should increment all characters",MachineDescription:"Increments all characters",Name:"IncrementAll",Id:"21",Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"abc"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"987"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"1+1=3"}],showing:!0}],Style:{Color:"Ivory",BorderColor:"MediumVioletRed"},InputChannels:[],OutputChannels:[{Channel:r.Green,Direction:Y.Right,Status:"Exists"}],Cell:{Row:2,Column:2},GetRandomTestInputs:Z,GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){var i,o=t.value,s="",l=Object(g.a)(o.Content);try{for(l.s();!(i=l.n()).done;){var c=i.value;s+=Ce(c)}}catch(u){l.e(u)}finally{l.f()}n.push({Channel:r.Green,Order:o.Order,Content:s})}}catch(u){a.e(u)}finally{a.f()}return n}};function Ce(e){var t=e,n=!1,r=fe(e,_),a=Object(d.a)(r,2);if(n=a[0],t=a[1],!n){var i=fe(e,H),o=Object(d.a)(i,2);n=o[0],t=o[1]}if(!n){var s=fe(e,X),l=Object(d.a)(s,2);n=l[0],t=l[1]}return t}function fe(e,t){var n=t.indexOf(e);return-1===n?[!1,e]:n<t.length-1?[!0,t[n+1]]:[!0,t[0]]}var ve={AllowedMachines:["0","5","6","7","8","9","10","12"],LevelDescription:"The machine should increment the first character 0 times, the second character once, the third twice etcetera. Characters that cannot be incremented do not count",MachineDescription:"Increments the first character 0 times, the second character once, the third twice, etcetera. Characters that cannot be incremented do not count",Name:"IncrementIncreasing",Id:"22",Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"aaa"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"5432109"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"1-A2@q"}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"hdjik rikdu!"}],showing:!0}],Style:{Color:"Pink",BorderColor:"Purple"},InputChannels:[],OutputChannels:[{Channel:r.Green,Direction:Y.Up,Status:"Exists"}],Cell:{Row:1,Column:5},GetRandomTestInputs:Z,GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){var i,o=t.value,s="",l=0,c=Object(g.a)(o.Content);try{for(c.s();!(i=c.n()).done;){var u=i.value;if(-1===J.indexOf(u)){for(var h=0;h<l;h++)u=Ce(u);l++,s+=u}else s+=u}}catch(d){c.e(d)}finally{c.f()}n.push({Channel:r.Green,Order:o.Order,Content:s})}}catch(d){a.e(d)}finally{a.f()}return n}};var me={AllowedMachines:["0","1","2","3","5","6","7","8","9","10","12","13","14"],LevelDescription:"The machine should store the input from green, appending it to any previously stored message. On red input, it should exit the stored message appended with the input to green, clearing the stored message",MachineDescription:"Stores input from green,appending it to any previously stored message. On red input it exits the stored message appended with the input to green",Name:"JoinAll",Id:"24",Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"a"},{Order:1,Channel:r.Green,Content:"b"},{Order:2,Channel:r.Red,Content:"c"}],showing:!0},{inputs:[{Order:0,Channel:r.Red,Content:""},{Order:1,Channel:r.Green,Content:""},{Order:2,Channel:r.Red,Content:"ab"},{Order:3,Channel:r.Red,Content:""}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"Ma"},{Order:1,Channel:r.Green,Content:"rco"},{Order:2,Channel:r.Red,Content:"?"},{Order:3,Channel:r.Green,Content:"Po"},{Order:4,Channel:r.Green,Content:"lo"},{Order:5,Channel:r.Red,Content:"!"}],showing:!0}],Style:{Color:"Grey",BorderColor:"YellowGreen"},InputChannels:[],OutputChannels:[{Channel:r.Green,Direction:Y.Right,Status:"Exists"}],Cell:{Row:4,Column:7},GetRandomTestInputs:function(){return function(e,t,n,a,i,o){for(var s=Math.round(Math.random()*(t-e))+e,l=[],c=n+a+i+o,u=0;u<s;u++){var h=Math.random()-.499*c,d=r.Green;h<o?d=r.Yellow:(h<o+i||h<o+i+a)&&(d=r.Blue),l.push({Channel:d,Order:u,Content:V()})}return l}(3,8,6,4,0,0)},GetTestExpectedOutputs:function(e){var t,n=[],a=Object(q.a)(e).sort((function(e){return e.Order})),i="",o=Object(g.a)(a);try{for(o.s();!(t=o.n()).done;){var s=t.value;s.Channel===r.Red?(i+=s.Content,n.push({Channel:r.Green,Order:s.Order,Content:i}),i=""):s.Channel===r.Green&&(i+=s.Content)}}catch(l){o.e(l)}finally{o.f()}return n}};var ge={AllowedMachines:["0","5","6","7","8","9","10"],LevelDescription:"The machine should exit the string with each character repeated once",MachineDescription:"Makes sure that each character is repeated once",Name:"MakeTwins",Id:"18",Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"abc"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"aaabcc"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"hello world"}],showing:!0}],Style:{Color:"AntiqueWhite",BorderColor:"GreenYellow"},InputChannels:[],OutputChannels:[{Channel:r.Green,Direction:Y.Down,Status:"Exists"}],Cell:{Row:1,Column:2},GetRandomTestInputs:Q,GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){var i,o=t.value,s="",l=Object(g.a)(o.Content);try{for(l.s();!(i=l.n()).done;){var c=i.value;c!==s[s.length-1]&&(s+=c.repeat(2))}}catch(u){l.e(u)}finally{l.f()}n.push({Channel:r.Green,Order:o.Order,Content:s})}}catch(u){a.e(u)}finally{a.f()}return n}};var be={AllowedMachines:["0","5","6","7","9"],LevelDescription:"If the first characters are duplicates, the machine should clear all the duplicates",MachineDescription:"If the first characters are duplicates, clears those duplicates",Name:"RemoveIfDuplicate",Id:"17",Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"aabc"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"abc"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"a"}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"33333"}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"hhhhhhhello world"}],showing:!0}],Style:{Color:"MediumAquaMarine",BorderColor:"DeepSkyBlue"},InputChannels:[],OutputChannels:[{Channel:r.Blue,Direction:Y.Down,Status:"Exists"},{Channel:r.Green,Direction:Y.Right,Status:"Exists"}],Cell:{Row:1,Column:0},GetRandomTestInputs:Q,GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){var i=t.value,o=i.Content;if(o.length>1){for(var s=i.Content[0],l=!1;o.length>1&&o[1]===s;)o=o.slice(1),l=!0;l&&(o=o.slice(1))}n.push({Channel:r.Green,Order:i.Order,Content:o})}}catch(c){a.e(c)}finally{a.f()}return n}};var ye={AllowedMachines:["0","5","6","7","9"],LevelDescription:"The machine should delete all characters before the first repeated character",MachineDescription:"Deletes all character before the first repeated character",Name:"RemoveUntilRepeat",Id:"19",Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"abbc"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"abca"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"22"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:"1"}],showing:!1},{inputs:[{Order:0,Channel:r.Green,Content:"hello world"}],showing:!0}],Style:{Color:"LawnGreen",BorderColor:"DarkGrey"},InputChannels:[],OutputChannels:[{Channel:r.Green,Direction:Y.Down,Status:"Exists"}],Cell:{Row:2,Column:0},GetRandomTestInputs:Q,GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){for(var i=t.value,o="",s=i.Content;s.length>1;){if(s[0]===s[1]){o=s;break}s=s.slice(1)}n.push({Channel:r.Green,Order:i.Order,Content:o})}}catch(l){a.e(l)}finally{a.f()}return n}};var we={AllowedMachines:["0","5","6","7","8","9","10","12","13"],LevelDescription:"The machine should exit the input to green, and exit an empty message to red",MachineDescription:"Exits the input to green, exits an empty message to red",Name:"Trigger",Id:"23",Tests:[{inputs:[{Order:0,Channel:r.Green,Content:"abc"}],showing:!0},{inputs:[{Order:0,Channel:r.Green,Content:""}],showing:!0}],Style:{Color:"DimGrey",BorderColor:"Thistle"},InputChannels:[],OutputChannels:[{Channel:r.Green,Direction:Y.Right,Status:"Exists"}],Cell:{Row:4,Column:5},GetRandomTestInputs:Z,GetTestExpectedOutputs:function(e){var t,n=[],a=Object(g.a)(e.filter((function(e){return e.Channel===r.Green})));try{for(a.s();!(t=a.n()).done;){var i=t.value;n.push({Channel:r.Green,Order:i.Order,Content:i.Content}),n.push({Channel:r.Red,Order:i.Order,Content:""})}}catch(o){a.e(o)}finally{a.f()}return n}};var Oe,Se=function(){function e(){Object(O.a)(this,e),this.levels=void 0,this.levels=[],this.init()}return Object(S.a)(e,[{key:"init",value:function(){this.levels.push(ne),this.levels.push(ie),this.levels.push(te),this.levels.push(re),this.levels.push(ee),this.levels.push($),this.levels.push(oe),this.levels.push(ae),this.levels.push(le),this.levels.push(ce),this.levels.push(ue),this.levels.push(se),this.levels.push(he),this.levels.push(pe),this.levels.push(ve),this.levels.push(me),this.levels.push(ge),this.levels.push(be,ye,we)}},{key:"GetAllLevels",value:function(){return this.levels}},{key:"GetLevel",value:function(e){var t=this.levels.find((function(t){return t.Id===e}));if(void 0===t)throw Error("Unable to find level with id '".concat(e,"'"));return t}}],[{key:"GetStore",value:function(){return void 0===e.levelStore&&(e.levelStore=new e),e.levelStore}}]),e}();function ke(e,t){if("LoadLevelActionType"===t.type)return function(e){var t=Se.GetStore().GetLevel(e),n=t.Tests.map((function(e,t){return Object(h.a)(Object(h.a)({},e),{},{actualOutputs:void 0,id:t,editable:!1})}));return n.push({actualOutputs:void 0,inputs:[{Channel:r.Green,Content:"",Order:0}],showing:!0,id:n.length,editable:!0}),{allowedMachines:Object(q.a)(t.AllowedMachines),description:t.LevelDescription,name:t.Name,getOutputs:t.GetTestExpectedOutputs,id:t.Id,tests:n}}(t.id);if(void 0!==e){switch(t.type){case"AddTestActionType":var n={actualOutputs:[],showing:!0,inputs:[{Channel:r.Green,Content:"",Order:0}],editable:!0,id:Math.max.apply(Math,Object(q.a)(e.tests.map((function(e){return e.id}))).concat([-1]))+1};e.tests.push(n);break;case"RemoveTestActionType":e.tests=e.tests.filter((function(e){return e.id!==t.testId}));break;case"SetCustomTestActionType":var a=e.tests.find((function(e){return!0===e.editable}));void 0!==a&&(a.inputs=t.inputs);break;case"ReportOutputActionType":case"ClearTestOutputActionType":case"AddInputActionType":case"RemoveInputActionType":case"UpdateInputActionType":var i=e.tests.map((function(e){return e.id===t.testId?function(e,t){switch(t.type){case"ReportOutputActionType":void 0===e.actualOutputs&&(e.actualOutputs=[]);var n=e.actualOutputs.slice();return n.push(t.outputMessage),Object(h.a)(Object(h.a)({},e),{},{actualOutputs:n});case"ClearTestOutputActionType":return Object(h.a)(Object(h.a)({},e),{},{actualOutputs:[]});case"AddInputActionType":var a=Math.max.apply(Math,Object(q.a)(e.inputs.map((function(e){return e.Order}))).concat([-1]))+1,i={Channel:r.Green,Content:"",Order:a};return Object(h.a)(Object(h.a)({},e),{},{inputs:e.inputs.concat(i)});case"RemoveInputActionType":var o=e.inputs.filter((function(e){return e.Order!==t.order})).map((function(e,t){return Object(h.a)(Object(h.a)({},e),{},{Order:t})}));return Object(h.a)(Object(h.a)({},e),{},{inputs:o,actualOutputs:void 0});case"UpdateInputActionType":var s=U(t.input.Content),l=e.inputs.map((function(e){return e.Order===t.input.Order?Object(h.a)(Object(h.a)({},t.input),{},{Content:s}):e}));return Object(h.a)(Object(h.a)({},e),{},{inputs:l});default:return e}}(e,t):e}));e.tests=i;break;case"AddNewMachineActionType":case"ChannelChangedActionType":case"DeleteMachineActionType":case"FixMachineActionType":case"MachineAddedActionType":case"MachineMovedActionType":case"MachineRemovedActionType":e.tests.forEach((function(e){e.actualOutputs=void 0}))}return e}}function Ie(e,t){var n,r=[],a=[],i=Y.Up,o=Object(g.a)(e.OutputChannels);try{for(o.s();!(n=o.n()).done;){var s=n.value;r.push({Channel:s,Direction:i,Status:"Exists"}),i++}}catch(h){o.e(h)}finally{o.f()}if(t&&e.InputChannels.length>1){i=0;var l,c=Object(g.a)(e.InputChannels);try{for(c.s();!(l=c.n()).done;){var u=l.value;a.push({Channel:u,Direction:i,Status:"Exists"}),i++}}catch(h){c.e(h)}finally{c.f()}}return{inputChannels:a,outputChannels:r}}function Me(e){var t,n=Ie(e,!0),r=n.inputChannels,a=n.outputChannels,i=r.length>1,o=r.map((function(e){return Object(h.a)({UseMachineColor:!i},e)})),s=[],l=Object(g.a)(a);try{var c=function(){var e=t.value,n=s.find((function(t){return t[0].Direction===e.Direction}));void 0===n?s.push([e]):n.push(e)};for(l.s();!(t=l.n()).done;)c()}catch(u){l.e(u)}finally{l.f()}return{inputChannels:o,outputChannels:s}}function De(e,t){return e.Column===t.Column&&e.Row===t.Row}Se.levelStore=void 0,function(e){e[e.NoMachineLinked=0]="NoMachineLinked",e[e.InProgress=1]="InProgress",e[e.NonValidMachineUsed=2]="NonValidMachineUsed",e[e.Completed=3]="Completed"}(Oe||(Oe={}));var xe=.9*.28,Ee=.12,Ge=function e(t){Object(O.a)(this,e),this.cellSize=void 0,this.aperture=void 0,this.armLength=void 0,this.armAngle=.05*Math.PI,this.circleRadius=void 0,this.borderWidth=void 0,this.halfSquareSize=void 0,this.shadeOffset=void 0,this.outputSplit=void 0,this.outputLength=void 0,this.outputRadius=void 0,this.outputWidth=void 0,this.outputStartLength=void 0,this.center=void 0,this.apertureAngle=void 0,this.defiatingAngle=void 0,this.protrudingArm=void 0,this.cellSize=t,this.aperture=.23*t,this.armLength=.18*t,this.circleRadius=.28*t,this.borderWidth=.05*t,this.halfSquareSize=.9*this.circleRadius,this.shadeOffset=.008*t,this.outputSplit=Ee*t,this.outputLength=.38*t,this.outputRadius=.15*t,this.outputWidth=.06*t,this.outputStartLength=.25*t,this.center=.5*t,this.apertureAngle=Math.asin(.5*this.aperture/this.circleRadius),this.defiatingAngle=this.armAngle-this.apertureAngle,this.protrudingArm=Math.cos(this.defiatingAngle)*this.armLength};function Te(e,t,n){return function(e,t,n,r){var a=v(Qe.getState())/2;if(null!==n&&null!==r){return Math.atan2(n.y-r.y+t-a,n.x-r.x+e-a)}return}(t,n,e.getClientOffset(),e.getInitialSourceClientOffset())}function Ae(e){switch(e){case Y.Up:return.5*Math.PI;case Y.Right:return 1*Math.PI;case Y.Down:return 1.5*Math.PI;case Y.Left:return 2*Math.PI}}function je(e){if(""===e||void 0===e||null===e)return!1;var t=(new Option).style;return t.color=e,t.color===e.toLowerCase()}function Re(e){if(e.startsWith("rgb(")){var t=e.split("(")[1].split(")")[0].split(",");return{red:Number(t[0]),green:Number(t[1]),blue:Number(t[2])}}return e.startsWith("#")||(e=function(e){var t="#FFFFFF";switch(e.toLowerCase()){case"aliceblue":t="#F0F8FF";break;case"antiquewhite":t="#FAEBD7";break;case"aqua":t="#00FFFF";break;case"aquamarine":t="#7FFFD4";break;case"azure":t="#F0FFFF";break;case"beige":t="#F5F5DC";break;case"bisque":t="#FFE4C4";break;case"black":t="#000000";break;case"blanchedalmond":t="#FFEBCD";break;case"blue":t="#0000FF";break;case"blueviolet":t="#8A2BE2";break;case"brown":t="#A52A2A";break;case"burlywood":t="#DEB887";break;case"cadetblue":t="#5F9EA0";break;case"chartreuse":t="#7FFF00";break;case"chocolate":t="#D2691E";break;case"coral":t="#FF7F50";break;case"cornflowerblue":t="#6495ED";break;case"cornsilk":t="#FFF8DC";break;case"crimson":t="#DC143C";break;case"cyan":t="#00FFFF";break;case"darkblue":t="#00008B";break;case"darkcyan":t="#008B8B";break;case"darkgoldenrod":t="#B8860B";break;case"darkgray":case"darkgrey":t="#A9A9A9";break;case"darkgreen":t="#006400";break;case"darkkhaki":t="#BDB76B";break;case"darkmagenta":t="#8B008B";break;case"darkolivegreen":t="#556B2F";break;case"darkorange":t="#FF8C00";break;case"darkorchid":t="#9932CC";break;case"darkred":t="#8B0000";break;case"darksalmon":t="#E9967A";break;case"darkseagreen":t="#8FBC8F";break;case"darkslateblue":t="#483D8B";break;case"darkslategray":case"darkslategrey":t="#2F4F4F";break;case"darkturquoise":t="#00CED1";break;case"darkviolet":t="#9400D3";break;case"deeppink":t="#FF1493";break;case"deepskyblue":t="#00BFFF";break;case"dimgray":case"dimgrey":t="#696969";break;case"dodgerblue":t="#1E90FF";break;case"firebrick":t="#B22222";break;case"floralwhite":t="#FFFAF0";break;case"forestgreen":t="#228B22";break;case"fuchsia":t="#FF00FF";break;case"gainsboro":t="#DCDCDC";break;case"ghostwhite":t="#F8F8FF";break;case"gold":t="#FFD700";break;case"goldenrod":t="#DAA520";break;case"gray":case"grey":t="#808080";break;case"green":t="#008000";break;case"greenyellow":t="#ADFF2F";break;case"honeydew":t="#F0FFF0";break;case"hotpink":t="#FF69B4";break;case"indianred":t="#CD5C5C";break;case"indigo":t="#4B0082";break;case"ivory":t="#FFFFF0";break;case"khaki":t="#F0E68C";break;case"lavender":t="#E6E6FA";break;case"lavenderblush":t="#FFF0F5";break;case"lawngreen":t="#7CFC00";break;case"lemonchiffon":t="#FFFACD";break;case"lightblue":t="#ADD8E6";break;case"lightcoral":t="#F08080";break;case"lightcyan":t="#E0FFFF";break;case"lightgoldenrodyellow":t="#FAFAD2";break;case"lightgray":case"lightgrey":t="#D3D3D3";break;case"lightgreen":t="#90EE90";break;case"lightpink":t="#FFB6C1";break;case"lightsalmon":t="#FFA07A";break;case"lightseagreen":t="#20B2AA";break;case"lightskyblue":t="#87CEFA";break;case"lightslategray":case"lightslategrey":t="#778899";break;case"lightsteelblue":t="#B0C4DE";break;case"lightyellow":t="#FFFFE0";break;case"lime":t="#00FF00";break;case"limegreen":t="#32CD32";break;case"linen":t="#FAF0E6";break;case"magenta":t="#FF00FF";break;case"maroon":t="#800000";break;case"mediumaquamarine":t="#66CDAA";break;case"mediumblue":t="#0000CD";break;case"mediumorchid":t="#BA55D3";break;case"mediumpurple":t="#9370DB";break;case"mediumseagreen":t="#3CB371";break;case"mediumslateblue":t="#7B68EE";break;case"mediumspringgreen":t="#00FA9A";break;case"mediumturquoise":t="#48D1CC";break;case"mediumvioletred":t="#C71585";break;case"midnightblue":t="#191970";break;case"mintcream":t="#F5FFFA";break;case"mistyrose":t="#FFE4E1";break;case"moccasin":t="#FFE4B5";break;case"navajowhite":t="#FFDEAD";break;case"navy":t="#000080";break;case"oldlace":t="#FDF5E6";break;case"olive":t="#808000";break;case"olivedrab":t="#6B8E23";break;case"orange":t="#FFA500";break;case"orangered":t="#FF4500";break;case"orchid":t="#DA70D6";break;case"palegoldenrod":t="#EEE8AA";break;case"palegreen":t="#98FB98";break;case"paleturquoise":t="#AFEEEE";break;case"palevioletred":t="#DB7093";break;case"papayawhip":t="#FFEFD5";break;case"peachpuff":t="#FFDAB9";break;case"peru":t="#CD853F";break;case"pink":t="#FFC0CB";break;case"plum":t="#DDA0DD";break;case"powderblue":t="#B0E0E6";break;case"purple":t="#800080";break;case"rebeccapurple":t="#663399";break;case"red":t="#FF0000";break;case"rosybrown":t="#BC8F8F";break;case"royalblue":t="#4169E1";break;case"saddlebrown":t="#8B4513";break;case"salmon":t="#FA8072";break;case"sandybrown":t="#F4A460";break;case"seagreen":t="#2E8B57";break;case"seashell":t="#FFF5EE";break;case"sienna":t="#A0522D";break;case"silver":t="#C0C0C0";break;case"skyblue":t="#87CEEB";break;case"slateblue":t="#6A5ACD";break;case"slategray":case"slategrey":t="#708090";break;case"snow":t="#FFFAFA";break;case"springgreen":t="#00FF7F";break;case"steelblue":t="#4682B4";break;case"tan":t="#D2B48C";break;case"teal":t="#008080";break;case"thistle":t="#D8BFD8";break;case"tomato":t="#FF6347";break;case"turquoise":t="#40E0D0";break;case"violet":t="#EE82EE";break;case"wheat":t="#F5DEB3";break;case"white":t="#FFFFFF";break;case"whitesmoke":t="#F5F5F5";break;case"yellow":t="#FFFF00";break;case"yellowgreen":t="#9ACD32"}return t}(e)),{red:parseInt(e.substring(1,3),16),blue:parseInt(e.substring(5,7),16),green:parseInt(e.substring(3,5),16)}}function Fe(e,t){try{var n=Re(e);return"rgba(".concat(n.red,",").concat(n.green,",").concat(n.blue,",").concat(t,")")}catch(r){return"white"}}function Le(e,t){try{var n=Re(e),r=256-(256-n.red)*t,a=256-(256-n.blue)*t,i=256-(256-n.green)*t;return"rgb(".concat(r,",").concat(i,",").concat(a,")")}catch(o){return"white"}}function Be(e,t){var n=Re(e);try{var r=(n.red+n.green+n.blue)/3;return"rgb(".concat(r*t+n.red*(1-t),",").concat(r*t+n.green*(1-t),",").concat(r*t+n.blue*(1-t),")")}catch(a){return"white"}}function Ne(){switch(Math.floor(148*Math.random())){case 0:return"AliceBlue";case 1:return"AntiqueWhite";case 2:return"Aqua";case 3:return"Aquamarine";case 4:return"Azure";case 5:return"Beige";case 6:return"Bisque";case 7:return"Black";case 8:return"BlanchedAlmond";case 9:return"Blue";case 10:return"BlueViolet";case 11:return"Brown";case 12:return"BurlyWood";case 13:return"CadetBlue";case 14:return"Chartreuse";case 15:return"Chocolate";case 16:return"Coral";case 17:return"CornflowerBlue";case 18:return"Cornsilk";case 19:return"Crimson";case 20:return"Cyan";case 21:return"DarkBlue";case 22:return"DarkCyan";case 23:return"DarkGoldenRod";case 24:return"DarkGray";case 25:return"DarkGrey";case 26:return"DarkGreen";case 27:return"DarkKhaki";case 28:return"DarkMagenta";case 29:return"DarkOliveGreen";case 30:return"DarkOrange";case 31:return"DarkOrchid";case 32:return"DarkRed";case 33:return"DarkSalmon";case 34:return"DarkSeaGreen";case 35:return"DarkSlateBlue";case 36:return"DarkSlateGray";case 37:return"DarkSlateGrey";case 38:return"DarkTurquoise";case 39:return"DarkViolet";case 40:return"DeepPink";case 41:return"DeepSkyBlue";case 42:return"DimGray";case 43:return"DimGrey";case 44:return"DodgerBlue";case 45:return"FireBrick";case 46:return"FloralWhite";case 47:return"ForestGreen";case 48:return"Fuchsia";case 49:return"Gainsboro";case 50:return"GhostWhite";case 51:return"Gold";case 52:return"GoldenRod";case 53:return"Gray";case 54:return"Grey";case 55:return"Green";case 56:return"GreenYellow";case 57:return"HoneyDew";case 58:return"HotPink";case 59:return"IndianRed\xa0";case 60:return"Indigo";case 61:return"Ivory";case 62:return"Khaki";case 63:return"Lavender";case 64:return"LavenderBlush";case 65:return"LawnGreen";case 66:return"LemonChiffon";case 67:return"LightBlue";case 68:return"LightCoral";case 69:return"LightCyan";case 70:return"LightGoldenRodYellow";case 71:return"LightGray";case 72:return"LightGrey";case 73:return"LightGreen";case 74:return"LightPink";case 75:return"LightSalmon";case 76:return"LightSeaGreen";case 77:return"LightSkyBlue";case 78:return"LightSlateGray";case 79:return"LightSlateGrey";case 80:return"LightSteelBlue";case 81:return"LightYellow";case 82:return"Lime";case 83:return"LimeGreen";case 84:return"Linen";case 85:return"Magenta";case 86:return"Maroon";case 87:return"MediumAquaMarine";case 88:return"MediumBlue";case 89:return"MediumOrchid";case 90:return"MediumPurple";case 91:return"MediumSeaGreen";case 92:return"MediumSlateBlue";case 93:return"MediumSpringGreen";case 94:return"MediumTurquoise";case 95:return"MediumVioletRed";case 96:return"MidnightBlue";case 97:return"MintCream";case 98:return"MistyRose";case 99:return"Moccasin";case 100:return"NavajoWhite";case 101:return"Navy";case 102:return"OldLace";case 103:return"Olive";case 104:return"OliveDrab";case 105:return"Orange";case 106:return"OrangeRed";case 107:return"Orchid";case 108:return"PaleGoldenRod";case 109:return"PaleGreen";case 110:return"PaleTurquoise";case 111:return"PaleVioletRed";case 112:return"PapayaWhip";case 113:return"PeachPuff";case 114:return"Peru";case 115:return"Pink";case 116:return"Plum";case 117:return"PowderBlue";case 118:return"Purple";case 119:return"RebeccaPurple";case 120:return"Red";case 121:return"RosyBrown";case 122:return"RoyalBlue";case 123:return"SaddleBrown";case 124:return"Salmon";case 125:return"SandyBrown";case 126:return"SeaGreen";case 127:return"SeaShell";case 128:return"Sienna";case 129:return"Silver";case 130:return"SkyBlue";case 131:return"SlateBlue";case 132:return"SlateGray";case 133:return"SlateGrey";case 134:return"Snow";case 135:return"SpringGreen";case 136:return"SteelBlue";case 137:return"Tan";case 138:return"Teal";case 139:return"Thistle";case 140:return"Tomato";case 141:return"Turquoise";case 142:return"Violet";case 143:return"Wheat";case 144:return"White";case 145:return"WhiteSmoke";case 146:return"Yellow";case 147:return"YellowGreen";default:return"White"}}function Pe(e,t){var n,r=1/0,a=void 0,i=Object(g.a)(e);try{for(i.s();!(n=i.n()).done;){var o=n.value,s=t(o);s<r&&(a=o,r=s)}}catch(l){i.e(l)}finally{i.f()}return a}function ze(e,t){var n,r=-1/0,a=void 0,i=Object(g.a)(e);try{for(i.s();!(n=i.n()).done;){var o=n.value,s=t(o);s>r&&(a=o,r=s)}}catch(l){i.e(l)}finally{i.f()}return a}function We(e,t,n,r){if(void 0===e)return e;switch(t.type){case"SetColorActionType":return je(t.color)&&(e.Style.Color=U(t.color)),e;case"SetBorderColorActionType":return je(t.borderColor)&&(e.Style.BorderColor=U(t.borderColor)),e;case"SetNameActionType":return e.Style.Name=U(t.name),e;case"SetDescriptionActionType":return e.Style.Description=U(t.description),e;default:switch(t.type){case"FixMachineActionType":var a=e.Setup.MachineInstances.find((function(e){return e.Id===t.machineInstanceId}));"Deleted"===a.Status&&e.Setup.MachineInstances.filter((function(e){return e.MachineId===a.MachineId})).length<=1&&(e.DependingOnDeleted=e.DependingOnDeleted.filter((function(e){return e!==a.MachineId})))}switch(e.Setup.MachineInstances=function(e,t,n,r){switch(t.type){case"ChannelChangedActionType":var a=e.find((function(e){return e.Id===t.machineInstanceId})),i=a.OutputChannels.findIndex((function(e){return e.Channel===t.channel.Channel})),o=a.OutputChannels.filter((function(e,n){return e.Direction===t.channel.Direction&&"DoesNotExist"!==e.Status&&n!==i}));if(o.length>0&&void 0!==t.angle){for(var s=a.OutputChannels.filter((function(e){return e.Direction!==t.channel.Direction&&"DoesNotExist"!==e.Status})),l=-(o.length-1)/2*Ee*r,c=!1,u=Ae(t.channel.Direction),d=.25*-Math.sin(t.angle-u)*r,p=0;p<o.length;p++)!c&&d<l&&(c=!0,s.push(t.channel)),s.push(o[p]),l+=Ee*r;c||s.push(t.channel),a.OutputChannels=s}else a.OutputChannels[i]=t.channel;return e;case"InputChannelChangedActionType":var C=e.find((function(e){return e.Id===t.machineInstanceId}));return C.InputChannels.find((function(e){return e.Direction===t.channel.Direction})).Direction=C.InputChannels[t.channelIndex].Direction,C.InputChannels[t.channelIndex]=t.channel,e;case"MachineRemovedActionType":return B(e.find((function(e){return e.Id===t.machineInstanceId})).MachineId)&&e.filter((function(e){return B(e.MachineId)})).length<2?e:e.filter((function(e){return e.Id!==t.machineInstanceId}));case"MachineAddedActionType":if(e.some((function(e){return De(e.Cell,t.cell)})))return e;var f=Ie(t.api,!1),v=f.outputChannels,m=f.inputChannels,g=0===e.length?0:Math.max.apply(Math,Object(q.a)(e.map((function(e){return e.Id})))),b={Cell:t.cell,MachineId:t.machineId,OutputChannels:v,InputChannels:m,Id:g+1,Status:"Valid"};return e.push(b),e;case"MachineMovedActionType":return e.some((function(e){return De(e.Cell,t.newCell)}))||(e.find((function(e){return e.Id===t.machineInstanceId})).Cell=t.newCell),e;case"FixMachineActionType":var y=e.find((function(e){return e.Id===t.machineInstanceId}));if("Deleted"===y.Status)return e.filter((function(e){return e.Id!==t.machineInstanceId}));if("ChannelsInvalid"===y.Status){var w=n.GetMachineType(y.MachineId).Api;y.OutputChannels=y.OutputChannels.filter((function(e){return w.OutputChannels.some((function(t){return t===e.Channel}))})),y.OutputChannels=y.OutputChannels.concat(w.OutputChannels.filter((function(e){return!y.OutputChannels.some((function(t){return t.Channel===e}))})).map((function(e){return{Channel:e,Direction:Y.Up,Status:"Exists"}}))),y.InputChannels=y.InputChannels.map((function(e){return"Exists"!==e.Status||w.InputChannels.some((function(t){return t===e.Channel}))?e:Object(h.a)(Object(h.a)({},e),{},{Channel:w.InputChannels[0]})})),y.Status="Valid"}return e;default:return e}}(e.Setup.MachineInstances,t,n,r),t.type){case"MachineAddedActionType":case"MachineRemovedActionType":case"MachineMovedActionType":!function(e){if(e.MachineInstances.length>0){var t=0,n=0,r=Pe(e.MachineInstances,(function(e){return e.Cell.Column})).Cell.Column,a=Pe(e.MachineInstances,(function(e){return e.Cell.Row})).Cell.Row,i=ze(e.MachineInstances,(function(e){return e.Cell.Column})).Cell.Column,o=ze(e.MachineInstances,(function(e){return e.Cell.Row})).Cell.Row;if(r<=0)i+=n=1-r;else{var s=i+2-z.MinimumColumns;s>0&&r>1&&(s+=n=-Math.min(s,r-1),i+=n)}if(a<=0)o+=t=1-a;else{var l=o+2-z.MinimumRows;l>0&&a>1&&(l+=t=-Math.min(l,a-1),o+=t)}e.MachineInstances.forEach((function(e){e.Cell={Row:e.Cell.Row+t,Column:e.Cell.Column+n}})),e.NumberOfColumns=Math.max(i+2,z.MinimumColumns),e.NumberOfRows=Math.max(o+2,z.MinimumRows)}}(e.Setup)}return e}}function Ue(e,t,n){switch(n){case Y.Down:if(t.Row>=e.NumberOfRows-1)return;return{Column:t.Column,Row:t.Row+1};case Y.Up:if(t.Row<=0)return;return{Column:t.Column,Row:t.Row-1};case Y.Right:if(t.Column>=e.NumberOfColumns-1)return;return{Column:t.Column+1,Row:t.Row};case Y.Left:if(t.Column<=0)return;return{Column:t.Column-1,Row:t.Row}}}function qe(e){var t,n=[],r=Object(g.a)(e.MachineInstances);try{for(r.s();!(t=r.n()).done;){var a=t.value;B(a.MachineId)&&n.push(a)}}catch(i){r.e(i)}finally{r.f()}return n}function Ve(e,t){var n,r=Object(g.a)(e.OutputChannels);try{var a=function(){var e=n.value,r=t.OutputChannels.find((function(t){return t.Channel===e}));if(void 0===r||"DoesNotExist"===r.Status)return t.Status="ChannelsInvalid",{v:void 0}};for(r.s();!(n=r.n()).done;){var i=a();if("object"===typeof i)return i.v}}catch(C){r.e(C)}finally{r.f()}var o,s=Object(g.a)(t.OutputChannels.filter((function(e){return"Exists"===e.Status})));try{var l=function(){var n=o.value;if(!e.OutputChannels.some((function(e){return e===n.Channel})))return t.Status="ChannelsInvalid",{v:void 0}};for(s.s();!(o=s.n()).done;){var c=l();if("object"===typeof c)return c.v}}catch(C){s.e(C)}finally{s.f()}var u,h=Object(g.a)(t.InputChannels.filter((function(e){return"Exists"===e.Status})));try{var d=function(){var n=u.value;if(!e.InputChannels.some((function(e){return e===n.Channel})))return t.Status="ChannelsInvalid",{v:void 0}};for(h.s();!(u=h.n()).done;){var p=d();if("object"===typeof p)return p.v}}catch(C){h.e(C)}finally{h.f()}t.Status="Valid"}var Ye=function(){function e(t){Object(O.a)(this,e),this.customMachines=void 0,this.customMachines=t}return Object(S.a)(e,[{key:"GetMachineType",value:function(e){if(L(e))return it.GetStore().GetMachineType(e);var t=this.customMachines.find((function(t){return t.Id===e}));if(void 0===t)throw Error("CustomMachine not found, Id: '".concat(e,"'"));return t}}]),e}();function He(e,t,n,a){return{Id:W(),DirectlyDependingOn:[],Style:{BorderColor:null!==a&&void 0!==a?a:Ne(),Color:null!==n&&void 0!==n?n:Ne(),Name:e,Description:t},Api:{InputChannels:[r.Green],OutputChannels:[]},Setup:{NumberOfRows:z.MinimumRows,NumberOfColumns:z.MinimumColumns,MachineInstances:[{MachineId:"0",OutputChannels:[{Direction:Y.Right,Channel:r.Green,Status:"Exists"}],InputChannels:[],Id:1,Cell:{Row:2,Column:1},Status:"Valid"}]},ExitCells:[{Cell:{Row:2,Column:z.MinimumColumns-1},Direction:Y.Right}],DependingOn:["0"],DependingOnDeleted:[],Status:"Valid"}}var Xe=function(e){return function(e){var t,n=[],r=[],a=[],i=e.machines.find((function(t){return t.Id===e.activeMachineId})),o=Object(g.a)(i.Setup.MachineInstances);try{var s=function(){var i=t.value;if("Deleted"===i.Status)return a.push(i.MachineId),"continue";if(L(i.MachineId)||n.some((function(e){return e===i.MachineId}))||n.push(i.MachineId),!r.some((function(e){return e===i.MachineId}))&&(r.push(i.MachineId),!L(i.MachineId))){var o,s=e.machines.find((function(e){return e.Id===i.MachineId})),l=Object(g.a)(s.DependingOn);try{var c=function(){var e=o.value;r.some((function(t){return t===e}))||r.push(e)};for(l.s();!(o=l.n()).done;)c()}catch(u){l.e(u)}finally{l.f()}}};for(o.s();!(t=o.n()).done;)s()}catch(l){o.e(l)}finally{o.f()}i.DependingOn=r,i.DirectlyDependingOn=n}(e),function(e){var t=e.machines.find((function(t){return t.Id===e.activeMachineId}));t.Setup.MachineInstances.forEach((function(e){e.InputChannels.forEach((function(e){e.Status="DoesNotExist"}))})),t.ExitCells=function(e,t){var n=[],r=[],a=qe(e);r=r.concat(a.map((function(e){return{Cell:e.Cell,Direction:e.OutputChannels[0].Direction}})));for(var i=function(a){for(var i=r[a].Cell,o=void 0,s=void 0;void 0===o&&void 0!==(s=Ue(e,i,r[a].Direction));)i=s,o=e.MachineInstances.find((function(e){return e.Cell.Column===i.Column&&e.Cell.Row===i.Row}));if(void 0===s)return n.push({Direction:r[a].Direction,Cell:i}),"continue";var l=t.GetMachineType(o.MachineId).Api,c=o.InputChannels.find((function(e){return e.Direction===r[a].Direction}));void 0!==c?(l.InputChannels.some((function(e){return e===c.Channel}))||(c.Channel=l.InputChannels[0]),c.Status="Exists"):o.InputChannels.push({Channel:l.InputChannels[0],Direction:r[a].Direction,Status:"Exists"}),r.some((function(e){return e.Cell.Column===i.Column&&e.Cell.Row===i.Row}))||(r=r.concat(o.OutputChannels.map((function(e){return{Cell:i,Direction:e.Direction}}))))},o=0;o<r.length;o++)i(o);return n}(t.Setup,new Ye([].concat(Object(q.a)(e.machines),Object(q.a)(e.deletedMachines))));var n,a=t.ExitCells.map((function(e){switch(e.Direction){case Y.Right:return r.Green;case Y.Up:return r.Blue;case Y.Down:return r.Red;case Y.Left:return r.Yellow;default:throw Error("Invalid value for direction")}})),i=[],o=Object(g.a)(a);try{var s=function(){var e=n.value;i.some((function(t){return t===e}))||i.push(e)};for(o.s();!(n=o.n()).done;)s()}catch(h){o.e(h)}finally{o.f()}var l={InputChannels:qe(t.Setup).map((function(e){switch(e.MachineId){case"0":return r.Green;case"1":return r.Red;case"2":return r.Blue;case"3":return r.Yellow;default:throw Error("Unknown startmachine "+e.MachineId)}})),OutputChannels:i};c=l,u=t.Api,(c.InputChannels.length!==u.InputChannels.length||c.OutputChannels.length!==u.OutputChannels.length||c.InputChannels.some((function(e){return!u.InputChannels.some((function(t){return e===t}))}))||c.OutputChannels.some((function(e){return!u.OutputChannels.some((function(t){return e===t}))})))&&function(e,t){var n,r=e.activeMachineId,a=e.machines.filter((function(e){return e.DirectlyDependingOn.some((function(e){return e===r}))})),i=Object(g.a)(a);try{for(i.s();!(n=i.n()).done;){var o,s=n.value,l=Object(g.a)(s.Setup.MachineInstances.filter((function(e){return"Deleted"!==e.Status&&e.MachineId===r})));try{for(l.s();!(o=l.n()).done;){Ve(t,o.value)}}catch(h){l.e(h)}finally{l.f()}_e(s)}}catch(h){i.e(h)}finally{i.f()}}(e,l);var c,u;t.Api=l,_e(t)}(e),e};function _e(e){e.Setup.MachineInstances.some((function(e){return"Valid"!==e.Status}))?e.Status="Invalid":e.Status="Valid"}var Je=Object(P.a)((function(e,t){switch(t.type){case"SwitchScreen":e.screen=t.screen;break;case"SetMessagesActionType":e.messages=t.messages;break;case"SetMovingOutput":e.movingOutput=t.outputChannel;break;case"ImportPlayerData":var n=e.players.findIndex((function(e){return e.id===t.data.id}));-1!==n?e.players[n]=t.data:e.players.push(t.data);break;case"SwitchPlayer":e.activePlayerId=t.id;break;case"DeletePlayer":e.players=e.players.filter((function(e){return e.id!==t.id})),e.activePlayerId===t.id&&(e.players.length>0?e.activePlayerId=e.players[0].id:e.activePlayerId="");break;case"AddPlayer":var r=Ke(U(t.name));e.players.push(r);break;case"ChangePlayerName":var a=e.players.find((function(e){return e.id===t.id}));void 0!==a&&(a.name=U(t.name));break;default:switch(t.type){case"AddNewMachineActionType":e.messages=[];break;case"LoadLevelActionType":e.screen="playing";break;case"ChannelChangedActionType":"Exists"===t.channel.Status&&(e.movingOutput=void 0)}if(""===e.activePlayerId)return;var i=e.players.find((function(t){return t.id===e.activePlayerId}));void 0!==i&&function(e,t){switch(t.type){case"LoadLevelActionType":var n=e.levelData.find((function(e){return e.Id===t.id}));void 0!==n?e.activeMachineId=n.LastUsedMachineId:(e.levelData.push({Id:t.id,State:Oe.NoMachineLinked,LastUsedMachineId:void 0}),e.activeMachineId=void 0),e.activeLevel=t.id;break;case"UpdateShowAnimations":e.showAnimations=t.show;break;case"UpdateStepTime":e.stepTime=t.stepTime;break;case"AddNewMachineActionType":var r,a=e.levelData.find((function(t){return t.Id===e.activeLevel}));if(void 0===a||void 0===a.LastUsedMachineId){var i=Se.GetStore().GetLevel(e.activeLevel);r=He(i.Name,i.MachineDescription,i.Style.Color,i.Style.BorderColor)}else r=He("New machine","");e.machines.push(r),e.activeMachineId=r.Id,void 0!==a&&(void 0===a.LastUsedMachineId&&(a.LastUsedMachineId=r.Id),a.State===Oe.NoMachineLinked&&(a.State=Oe.InProgress));break;case"LoadCustomMachineActionType":if(void 0===e.machines.find((function(e){return e.Id===t.machineId})))throw Error("Loading an unknown machine, with id "+t.machineId);e.activeMachineId=t.machineId;break;case"ChangeCellSizeActionType":t.cellSize>=10&&t.cellSize<=200&&(e.cellSize=t.cellSize);break;case"SetLevelCompleteActionType":var o=e.levelData.find((function(e){return e.Id===t.levelId}));void 0!==o&&(o.State=Oe.Completed);break;case"DeleteMachineActionType":e.activeMachineId===t.machineId&&(e.activeMachineId=void 0);var s=e.levelData.find((function(e){return e.LastUsedMachineId===t.machineId}));void 0!==s&&(s.LastUsedMachineId=void 0,s.State=Oe.NoMachineLinked);var l,c=e.machines.filter((function(e){return e.DirectlyDependingOn.some((function(e){return e===t.machineId}))})),u=Object(g.a)(c);try{for(u.s();!(l=u.n()).done;){var d=l.value,p=d.Setup.MachineInstances.map((function(e){return e.MachineId===t.machineId?Object(h.a)(Object(h.a)({},e),{},{Status:"Deleted"}):e}));d.Setup.MachineInstances=p,d.DirectlyDependingOn=d.DirectlyDependingOn.filter((function(e){return e!==t.machineId})),d.DependingOnDeleted.push(t.machineId)}}catch(b){u.e(b)}finally{u.f()}c.length>0&&e.deletedMachines.push(e.machines.find((function(e){return e.Id===t.machineId})));var C,f=e.machines.filter((function(e){return e.DependingOn.some((function(e){return e===t.machineId}))})),v=Object(g.a)(f);try{for(v.s();!(C=v.n()).done;){var m=C.value;m.DependingOn=m.DependingOn.filter((function(e){return e!==t.machineId}))}}catch(b){v.e(b)}finally{v.f()}e.machines=e.machines.filter((function(e){return e.Id!==t.machineId})),e.deletedMachines=e.deletedMachines.filter((function(n){return e.machines.some((function(e){return e.DependingOnDeleted.some((function(e){return e===t.machineId}))}))}));break;default:if(void 0===e.activeMachineId)return e;We(e.machines.find((function(t){return t.Id===e.activeMachineId})),t,new Ye(e.machines),e.cellSize)}switch(t.type){case"AddNewMachineActionType":case"ChannelChangedActionType":case"DeleteMachineActionType":case"FixMachineActionType":case"MachineAddedActionType":case"MachineMovedActionType":case"MachineRemovedActionType":void 0!==e.activeMachineId&&Xe(e)}}(i,t)}switch(e.activeLevel=ke(e.activeLevel,t),t.type){case"ReportOutputActionType":!function(e){var t=e.players.find((function(t){return t.id===e.activePlayerId})),n=t.levelData.find((function(t){return t.Id===e.activeLevel.id}));Ze(e)?n.State!==Oe.Completed&&(n.State=Oe.InProgress):n.State=Oe.NonValidMachineUsed;n.LastUsedMachineId=t.activeMachineId}(e);break;case"MachineRemovedActionType":var o=e.players.find((function(t){return t.id===e.activePlayerId})).levelData.find((function(t){return t.Id===e.activeLevel.id}));o.State===Oe.NonValidMachineUsed&&Ze(e)&&(o.State=Oe.InProgress)}}));function Ke(e){return{deletedMachines:[],id:W(),levelData:[],machines:[],name:e,showAnimations:!0,stepTime:10,activeMachineId:void 0,activeLevel:void 0,cellSize:z.CellSize}}function Ze(e){var t;return!1!==(null===(t=f(e))||void 0===t?void 0:t.DependingOn.filter((function(e){return L(e)})).every((function(t){return e.activeLevel.allowedMachines.some((function(e){return e===t}))})))}var Qe=Object(N.b)((function(e,t){if(void 0===e){var n=Ke("anonymous");return{players:[n],activePlayerId:n.id,messages:[],screen:"startMenu",activeLevel:void 0,movingOutput:void 0}}var r=Je(e,t);return window.localStorage.setItem("Players",JSON.stringify(r.players)),window.localStorage.setItem("activePlayer",r.activePlayerId),r}),function(){var e;switch(Number.parseInt(null!==(e=window.localStorage.getItem("Version"))&&void 0!==e?e:"0",10)){case 0:return window.localStorage.removeItem("State"),void window.localStorage.setItem("Version","1");case 1:var t,n=JSON.parse(window.localStorage.getItem("Players")),r=Object(g.a)(n);try{for(r.s();!(t=r.n()).done;){var a,i=t.value,o=Object(g.a)(i.levelData.filter((function(e){return 3===e.State})));try{for(o.s();!(a=o.n()).done;){a.value.State=1}}catch(l){o.e(l)}finally{o.f()}}}catch(l){r.e(l)}finally{r.f()}window.localStorage.setItem("Players",JSON.stringify(n)),window.localStorage.setItem("Version","2")}var s={players:JSON.parse(window.localStorage.getItem("Players")),activePlayerId:window.localStorage.getItem("activePlayer"),messages:[],screen:"startMenu",movingOutput:void 0};if(null!==s.players)return s}(),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),$e=function(){return Qe.getState()},et=function(){function e(){Object(O.a)(this,e),this.greenInput=void 0,this.redInput=void 0}return Object(S.a)(e,[{key:"Act",value:function(e){switch(e.Channel){case r.Green:this.greenInput=e.Content;break;case r.Red:this.redInput=e.Content;break;default:throw Error("Machine does not have inputchannel "+e.Channel)}if(void 0===this.greenInput||void 0===this.redInput)return Promise.resolve([]);var t=this.greenInput.concat(this.redInput);this.greenInput=void 0,this.redInput=void 0;var n=[{Channel:r.Green,Content:t}];return Promise.resolve(n)}}]),e}(),tt=function(){function e(){Object(O.a)(this,e),this.id="14"}return Object(S.a)(e,[{key:"GetActor",value:function(){return new et}},{key:"GetType",value:function(){return{Style:{BorderColor:"Orange",Color:"Grey",Name:"Join",Description:"Exits with the input from the green channel before the red channel"},Api:{InputChannels:[r.Green,r.Red],OutputChannels:[r.Green]},DependingOn:[],DirectlyDependingOn:[]}}}]),e}(),nt=function(){function e(){Object(O.a)(this,e),this.actor={Act:function(e){var t=[],n="{"!==e.Content[0]?1:e.Content.indexOf("}")+1;return t.push({Content:e.Content.slice(0,n),Channel:r.Green}),t.push({Content:e.Content.slice(n),Channel:r.Red}),Promise.resolve(t)}},this.id="13"}return Object(S.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Style:{BorderColor:"Orange",Color:"Black",Name:"Split",Description:"The first character exits green, the other characters exit red"},Api:{InputChannels:[r.Green],OutputChannels:[r.Green,r.Red]},DependingOn:[],DirectlyDependingOn:[]}}}]),e}(),rt=function(){function e(){Object(O.a)(this,e),this.actor={Act:function(e){var t=[];return t.push({Content:e.Content,Channel:r.Green}),Promise.resolve(t)}},this.id="2"}return Object(S.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Style:{Color:"white",BorderColor:"blue",Name:"Start",Description:"Starting point of the computation. Acts as a move machine for all other purposes"},Api:{InputChannels:[r.Green],OutputChannels:[r.Green]},DependingOn:[],DirectlyDependingOn:[]}}}]),e}(),at=function(){function e(){Object(O.a)(this,e),this.actor={Act:function(e){var t=[];return t.push({Content:e.Content,Channel:r.Green}),Promise.resolve(t)}},this.id="3"}return Object(S.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Style:{Color:"white",BorderColor:"#fff020",Name:"Start",Description:"Starting point of the computation. Acts as a move machine for all other purposes"},Api:{InputChannels:[r.Green],OutputChannels:[r.Green]},DependingOn:[],DirectlyDependingOn:[]}}}]),e}(),it=function(){function e(){Object(O.a)(this,e),this.machines=void 0,this.machines=[],this.init()}return Object(S.a)(e,[{key:"init",value:function(){this.machines=[],this.machines.push(new T),this.machines.push(new R),this.machines.push(new rt),this.machines.push(new at),this.machines.push(new j),this.machines.push(new E),this.machines.push(new G),this.machines.push(new F),this.machines.push(new x),this.machines.push(new M),this.machines.push(new D),this.machines.push(new A),this.machines.push(new nt),this.machines.push(new tt)}},{key:"FindMachine",value:function(e){var t=this.machines.find((function(t){return t.id===e}));if(void 0===t)throw new Error("No default machine found with id "+e);return t}},{key:"GetActor",value:function(e,t){if(L(e))return this.FindMachine(e).GetActor();var n,r=null===(n=C($e()))||void 0===n?void 0:n.machines.find((function(t){return t.Id===e}));if(void 0===r)throw new Error("No custom machine found with id "+e);return this.CreateCustomActor(r.Setup,t)}},{key:"GetMachineType",value:function(e){if(L(e))return this.FindMachine(e).GetType();var t=C($e()),n=null===t||void 0===t?void 0:t.machines.find((function(t){return t.Id===e}));if(void 0===n&&void 0===(n=t.deletedMachines.find((function(t){return t.Id===e}))))throw new Error("No custom machine found with id "+e);return n}},{key:"GetAllMachines",value:function(){return this.machines.map((function(e){return e.id}))}},{key:"CreateCustomActor",value:function(e,t){var n=new ct(e,!1);return{Act:function(e){var r={Content:I(k(e.Content,t),n.starNumber),Channel:e.Channel};return n.RunInput(r).then((function(e){return e.map((function(e){return{Channel:e.Channel,Content:I(k(e.Content,n.starNumber),t)}}))}))}}}}],[{key:"GetStore",value:function(){return void 0===e.machineStore&&(e.machineStore=new e),e.machineStore}}]),e}();it.machineStore=void 0;function ot(e){return{type:"LoadLevelActionType",id:e}}function st(e){return{type:"ClearTestOutputActionType",testId:e}}function lt(e){return{type:"SetMessagesActionType",messages:e}}var ct=function(){function e(t,n){Object(O.a)(this,e),this.setup=void 0,this.machines=[],this.store=void 0,this.outputs=[],this.activeSetup=void 0,this.starNumber=void 0,this.setup=t,this.activeSetup=n,this.starNumber=e.starNumberCounter++,this.store=it.GetStore(),this.HandleNextMessages=this.HandleNextMessages.bind(this),this.CalculateNextMessages=this.CalculateNextMessages.bind(this),this.RunInput=this.RunInput.bind(this),this.RunComputation=this.RunComputation.bind(this),this.SetDelay=this.SetDelay.bind(this)}return Object(S.a)(e,[{key:"GetStartMachine",value:function(e){var t="0";switch(e){case r.Green:t="0";break;case r.Red:t="1";break;case r.Blue:t="2";break;case r.Yellow:t="3"}return this.setup.MachineInstances.find((function(e){return e.MachineId===t}))}},{key:"RunComputation",value:function(){var t=Object(w.a)(y.a.mark((function t(n,r){var a;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.StopComputation(),e.starNumberCounter=1,this.starNumber=0,this.machines=[],r.dispatch(st(n)),void 0!==(a=r.getState().activeLevel.tests.find((function(e){return e.id===n})))){t.next=10;break}return t.abrupt("return",Promise.resolve([]));case 10:return t.abrupt("return",this.RunInputs(a.inputs,r,n));case 11:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"RunInputs",value:function(){var e=Object(w.a)(y.a.mark((function e(t,n,r){var a,i,o,s,l=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=[],i=Object(g.a)(t),e.prev=2,s=y.a.mark((function e(){var t,i;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.value,e.next=3,l.RunInput(t,n,r,t.Order).catch((function(e){return Promise.reject(e)}));case 3:i=e.sent,a=a.concat(i.map((function(e){return{Content:e.Content,Channel:e.Channel,Order:t.Order}})));case 5:case"end":return e.stop()}}),e)})),i.s();case 5:if((o=i.n()).done){e.next=9;break}return e.delegateYield(s(),"t0",7);case 7:e.next=5;break;case 9:e.next=14;break;case 11:e.prev=11,e.t1=e.catch(2),i.e(e.t1);case 14:return e.prev=14,i.f(),e.finish(14);case 17:return e.abrupt("return",Promise.resolve(a));case 18:case"end":return e.stop()}}),e,null,[[2,11,14,17]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"RunInput",value:function(e,t,n,r){this.outputs=[];var a=[],i=this.GetStartMachine(e.Channel);if(void 0!==i){var o=i.OutputChannels[0].Direction,s={Content:e.Content,Direction:o,Cell:i.Cell};a.push(s)}return void 0!==t&&this.activeSetup&&C(t.getState()).showAnimations&&t.dispatch(lt(a)),this.OrderNewCalculation({messageLocations:a,store:t,testId:n,order:r})}},{key:"SetDelay",value:function(t,n,r){return new Promise((function(a,i){var o=window.setTimeout((function(){return t(n).then(a).catch(i)}),r);e.cancelComputation=function(){window.clearTimeout(o),i("Computation cancelled")}}))}},{key:"HandleNextMessages",value:function(){var e=Object(w.a)(y.a.mark((function e(t){var n,r,a,i,o,s,l;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.CalculateNextMessages(t.messageLocations);case 2:if(n=e.sent,r=Object(d.a)(n,2),a=r[0],(i=r[1]).length>0&&(this.outputs=this.outputs.concat(i)),void 0!==t.store){o=Object(g.a)(i);try{for(o.s();!(s=o.n()).done;)l=s.value,t.store.dispatch((c={Channel:l.Channel,Content:l.Content,Order:t.order},u=t.testId,{type:"ReportOutputActionType",outputMessage:c,testId:u}))}catch(p){o.e(p)}finally{o.f()}}if(void 0!==t.store&&this.activeSetup&&C(t.store.getState()).showAnimations&&t.store.dispatch(lt(a)),!(a.length>0)){e.next=13;break}return e.abrupt("return",this.OrderNewCalculation(Object(h.a)(Object(h.a)({},t),{},{messageLocations:a})));case 13:return e.abrupt("return",Promise.resolve(this.outputs));case 14:case"end":return e.stop()}var c,u}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"OrderNewCalculation",value:function(t){e.stepCount++;var n=void 0===t.store||C(t.store.getState()).showAnimations;if(this.activeSetup&&n||e.stepCount%1e5===0){var r=void 0!==t.store&&n?100*C(t.store.getState()).stepTime:0;return this.SetDelay(this.HandleNextMessages,t,r)}return this.HandleNextMessages(t)}},{key:"CalculateNextMessages",value:function(){var e=Object(w.a)(y.a.mark((function e(t){var n,a,i,o,s,l,c,u,h,d,p=this;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],a=[],i=Object(g.a)(t),e.prev=3,s=y.a.mark((function e(){var t,i,s,l,c,u,h,d,C,f,v,m;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=o.value,i=void 0,s=t.Cell;case 3:if(void 0!==i){e.next=10;break}if(void 0!==(s=Ue(p.setup,s,t.Direction))){e.next=7;break}return e.abrupt("break",10);case 7:i=p.setup.MachineInstances.find((function(e){return e.Cell.Column===s.Column&&e.Cell.Row===s.Row})),e.next=3;break;case 10:if(void 0!==s){e.next=13;break}return n.push({Cell:void 0,Direction:t.Direction,Content:t.Content}),e.abrupt("return","continue");case 13:if("Valid"===i.Status){e.next=15;break}return e.abrupt("return",{v:Promise.reject("Encountered invalid machine, check your machines")});case 15:return l=r.Green,void 0!==(c=i.InputChannels.find((function(e){return e.Direction===t.Direction})))&&(l=c.Channel),void 0===(u=p.machines.find((function(e){return e.id===i.Id})))&&(h=p.setup.MachineInstances.find((function(e){return e.Id===i.Id})),u={id:h.Id,actor:p.store.GetActor(h.MachineId,p.starNumber)},p.machines.push(u)),d=u.actor,e.next=23,d.Act({Content:t.Content,Channel:l});case 23:C=e.sent,f=Object(g.a)(C);try{for(m=function(){var e=v.value,t=i.OutputChannels.find((function(t){return t.Channel===e.Channel}));if(void 0===t)throw Error("Channelmap "+e.Channel+"undefined");var n={Cell:i.Cell,Content:e.Content,Direction:t.Direction};a.push(n)},f.s();!(v=f.n()).done;)m()}catch(b){f.e(b)}finally{f.f()}case 26:case"end":return e.stop()}}),e)})),i.s();case 6:if((o=i.n()).done){e.next=15;break}return e.delegateYield(s(),"t0",8);case 8:if("continue"!==(l=e.t0)){e.next=11;break}return e.abrupt("continue",13);case 11:if("object"!==typeof l){e.next=13;break}return e.abrupt("return",l.v);case 13:e.next=6;break;case 15:e.next=20;break;case 17:e.prev=17,e.t1=e.catch(3),i.e(e.t1);case 20:return e.prev=20,i.f(),e.finish(20);case 23:c=[],u=0,h=n;case 25:if(!(u<h.length)){e.next=41;break}d=h[u],e.t2=d.Direction,e.next=e.t2===Y.Up?30:e.t2===Y.Down?32:e.t2===Y.Right?34:e.t2===Y.Left?36:38;break;case 30:return c.push({Content:d.Content,Channel:r.Blue}),e.abrupt("break",38);case 32:return c.push({Content:d.Content,Channel:r.Red}),e.abrupt("break",38);case 34:return c.push({Content:d.Content,Channel:r.Green}),e.abrupt("break",38);case 36:return c.push({Content:d.Content,Channel:r.Yellow}),e.abrupt("break",38);case 38:u++,e.next=25;break;case 41:return e.abrupt("return",[a,c]);case 42:case"end":return e.stop()}}),e,null,[[3,17,20,23]])})));return function(t){return e.apply(this,arguments)}}()}],[{key:"StopComputation",value:function(){e.cancelComputation&&(e.cancelComputation(),e.cancelComputation=void 0),e.stepCount=0}}]),e}();ct.cancelComputation=void 0,ct.stepCount=void 0,ct.starNumberCounter=void 0;var ut=Object(l.b)((function(e){return{ShowAnimations:C(e).showAnimations,StepTime:C(e).stepTime}}),{UpdateStepTime:function(e){return{type:"UpdateStepTime",stepTime:e}},UpdateShowAnimations:function(e){return{type:"UpdateShowAnimations",show:e}}})((function(e){return i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",width:"100%",height:"100%"}},i.a.createElement("div",{style:{paddingRight:30}},i.a.createElement("button",{onClick:ct.StopComputation,title:"Stop the running computation"},"Stop")),i.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},i.a.createElement("label",{title:"Show animations, will calculate as fast as possible when turned of"},"Animations"),e.ShowAnimations&&i.a.createElement("label",{title:"Step time in tenths of seconds, lower for faster animations"},"Step Time")),i.a.createElement("div",{style:{display:"flex",flexDirection:"column",width:100}},i.a.createElement("button",{onClick:function(){e.UpdateShowAnimations(!e.ShowAnimations)},style:{marginLeft:5,width:63}},e.ShowAnimations?"On":"Off"),e.ShowAnimations&&i.a.createElement(p,{value:e.StepTime,valueChanged:e.UpdateStepTime})))}));function ht(e,t,n){return{type:"ChannelChangedActionType",machineInstanceId:e,channel:t,angle:n}}var dt="MachineInstance",pt="NewMachine",Ct="OutputChannel",ft="Grid",vt=function(e){var t;if(""===e)t="<Empty>";else{t=e;for(var n=0;-1!==(n=t.indexOf("{",n));){var r=t.indexOf("}",n);t=t.substring(0,n)+"?"+t.substring(r+1)}}return t},mt=function(e){var t=Object(c.c)({item:{type:Ct,channel:e.Channel,machineInstanceId:e.MachineInstanceId,offsetX:e.OffsetX,offsetY:e.OffsetY},begin:function(){e.OnClick(Object(h.a)(Object(h.a)({},e.Channel),{},{Status:"DoesNotExist"}))},end:function(t,n){if(!n.didDrop()){var r=n.getItem(),a=Te(n,e.OffsetX,e.OffsetY);if(void 0!==a){var i=a+2.75*Math.PI,o=Math.floor(i/(.5*Math.PI))%4;e.OnClick({Direction:o,Channel:e.Channel.Channel,Status:r.channel.Status},a)}}},collect:function(e){return{isDragging:e.isDragging()}}}),n=Object(d.a)(t,3),r=n[0].isDragging,o=n[1],s=n[2],l={width:gt*e.CellSize,marginLeft:yt*e.CellSize,opacity:r?0:1,height:bt*e.CellSize,pointerEvents:"all"};return Object(a.useEffect)((function(){s(Object(u.b)(),{captureDraggingState:!0})}),[s]),i.a.createElement("div",{ref:o,style:l,onClick:function(){var t=3===e.Channel.Direction?0:e.Channel.Direction+1;e.OnClick({Direction:t,Channel:e.Channel.Channel,Status:e.Channel.Status})}})},gt=.07,bt=.31,yt=.05,wt=function(e){if(0===e.ChannelModels.length)return i.a.createElement(i.a.Fragment,null);var t=e.cellSize*gt,n=e.cellSize*bt,r=.06*e.cellSize,a=e.cellSize*yt,o=(e.cellSize-(e.ChannelModels.length*(t+a)-a))/2,s=e.cellSize/2-n-r,l=t+a,c=0,u={position:"absolute",marginLeft:o-a,marginTop:s,display:"flex",flexDirection:"row"},h="";switch(e.ChannelModels[0].Direction){case Y.Down:h="rotate(180deg)",s=e.cellSize/2+r,o=e.cellSize-o-t,l=-l;break;case Y.Left:h="rotate(270deg)";var d=s;s=e.cellSize-o-t,o=d,c=-l,l=0;break;case Y.Right:h="rotate(90deg)",s=o,o=e.cellSize/2+r,c=l,l=0}var p={transform:h,height:e.cellSize,width:e.cellSize,position:"absolute",pointerEvents:"none"};return i.a.createElement("div",{style:p},i.a.createElement("div",{style:u},e.ChannelModels.map((function(t,n){return i.a.createElement(mt,{key:n,Channel:t,OnClick:e.OnChanged,MachineInstanceId:e.MachineInstanceId,OffsetX:o+l*n,OffsetY:s+c*n,CellSize:e.cellSize})}))))},Ot=n(20),St=n(19),kt=function(){function e(t,n){if(Object(O.a)(this,e),this.ctx=void 0,this.innerColor=void 0,this.borderColor=void 0,this.inputChannels=void 0,this.outputChannels=void 0,this.draggedOutput=void 0,this.draggedDirection=void 0,this.backgroundColor=void 0,this.drawConstants=void 0,this.ctx=t,this.innerColor=n.MachineStyle.Color,this.borderColor=n.MachineStyle.BorderColor,this.inputChannels=Object(q.a)(n.InputChannels).sort((function(e,t){return e.Direction>t.Direction?1:-1})),this.outputChannels=n.OutputChannels,this.draggedOutput=n.MovingOutput,this.backgroundColor=n.BackgroundColor,this.drawConstants=new Ge(n.CellSize),void 0!==this.draggedOutput&&void 0!==this.draggedOutput){var r=this.draggedOutput.angle+2.75*Math.PI;this.draggedDirection=Math.floor(r/(.5*Math.PI))%4}}return Object(S.a)(e,[{key:"DrawMachine",value:function(){this.DrawBody();var e,t=Object(g.a)(this.inputChannels);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.DrawInputGradient(n)}}catch(h){t.e(h)}finally{t.f()}var r,a=Object(g.a)(this.outputChannels);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.DrawOutputGroup(i,!0)}}catch(h){a.e(h)}finally{a.f()}if(void 0!==this.draggedOutput&&this.DraggedOutputDrawer(!0),0===this.inputChannels.length)this.DrawNoInputOutline();else{var o=0,s=0;do{s=(s+1)%this.inputChannels.length,this.DrawInputOutline(this.inputChannels[o].Direction,this.inputChannels[s].Direction),o++}while(o<this.inputChannels.length)}var l,c=Object(g.a)(this.outputChannels);try{for(c.s();!(l=c.n()).done;){var u=l.value;this.DrawOutputGroup(u,!1)}}catch(h){c.e(h)}finally{c.f()}void 0!==this.draggedOutput&&this.DraggedOutputDrawer(!1)}},{key:"SetShadowStyle",value:function(){this.ctx.shadowColor="black",this.ctx.shadowOffsetX=this.drawConstants.shadeOffset,this.ctx.shadowOffsetY=this.drawConstants.shadeOffset}},{key:"ClearShadowStyle",value:function(){this.ctx.shadowColor="transparent",this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=0}},{key:"DrawOutputGroup",value:function(e,t){this.ClearShadowStyle();var n=Ae(e[0].Direction)+Math.PI,r=e.filter((function(e){return"DoesNotExist"!==e.Status})),a=-(r.length-1)/2*this.drawConstants.outputSplit;if(this.draggedDirection===e[0].Direction)for(var i=-r.length/2*this.drawConstants.outputSplit,o=!1,s=Math.sin(this.draggedOutput.angle-n)*this.drawConstants.outputStartLength,l=0;l<r.length;l++)!o&&s<a&&(o=!0,i+=this.drawConstants.outputSplit),t?this.DrawOutputChannel("black",n,i,2*this.drawConstants.shadeOffset):(this.DrawOutputChannel("black",n,i,this.drawConstants.shadeOffset),this.DrawOutputChannel(r[l].Channel,n,i)),a+=this.drawConstants.outputSplit,i+=this.drawConstants.outputSplit;else{var c,u=Object(g.a)(r);try{for(u.s();!(c=u.n()).done;){var h=c.value;t?this.DrawOutputChannel("black",n,a,2*this.drawConstants.shadeOffset):(this.DrawOutputChannel("black",n,a,this.drawConstants.shadeOffset),this.DrawOutputChannel(h.Channel,n,a)),a+=this.drawConstants.outputSplit}}catch(d){u.e(d)}finally{u.f()}}}},{key:"DraggedOutputDrawer",value:function(e){this.ClearShadowStyle(),e?this.DrawDraggedOutput("black",2*this.drawConstants.shadeOffset):(this.DrawDraggedOutput("black",this.drawConstants.shadeOffset),this.DrawDraggedOutput(this.draggedOutput.channel.Channel,0))}},{key:"DrawDraggedOutput",value:function(e,t){var n=this.draggedOutput.angle+.25*Math.PI,r=Math.floor(n/(.5*Math.PI))*Math.PI*.5,a=this.drawConstants.center+this.drawConstants.outputStartLength*Math.cos(this.draggedOutput.angle)+t,i=this.drawConstants.center+this.drawConstants.outputStartLength*Math.sin(this.draggedOutput.angle)+t,o=a+(this.drawConstants.outputLength-this.drawConstants.outputStartLength)*Math.cos(r),s=i+(this.drawConstants.outputLength-this.drawConstants.outputStartLength)*Math.sin(r);this.ctx.beginPath(),this.ctx.moveTo(this.drawConstants.center,this.drawConstants.center);var l=this.ctx.createRadialGradient(this.drawConstants.center,this.drawConstants.center,0,this.drawConstants.center,this.drawConstants.center,this.drawConstants.outputLength);l.addColorStop(0,this.innerColor),l.addColorStop(.6,e),this.ctx.arcTo(a,i,o,s,this.drawConstants.outputRadius),this.ctx.lineTo(o,s),this.ctx.strokeStyle=l,this.ctx.lineWidth=this.drawConstants.outputWidth,this.ctx.stroke()}},{key:"DrawOutputChannel",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.ctx.beginPath(),this.ctx.moveTo(this.drawConstants.center,this.drawConstants.center);var a=Math.asin(n/this.drawConstants.outputStartLength),i=this.drawConstants.center+this.drawConstants.outputStartLength*Math.cos(t+a)+r,o=this.drawConstants.center+this.drawConstants.outputStartLength*Math.sin(t+a)+r,s=i+(this.drawConstants.outputLength-this.drawConstants.outputStartLength)*Math.cos(t),l=o+(this.drawConstants.outputLength-this.drawConstants.outputStartLength)*Math.sin(t),c=this.ctx.createRadialGradient(this.drawConstants.center,this.drawConstants.center,0,this.drawConstants.center,this.drawConstants.center,this.drawConstants.outputLength);c.addColorStop(0,this.innerColor),c.addColorStop(.6,e),this.ctx.arcTo(i,o,s,l,this.drawConstants.outputRadius),this.ctx.lineTo(s,l),this.ctx.strokeStyle=c,this.ctx.lineWidth=this.drawConstants.outputWidth,this.ctx.stroke()}}]),e}(),It=function(e){Object(Ot.a)(n,e);var t=Object(St.a)(n);function n(){return Object(O.a)(this,n),t.apply(this,arguments)}return Object(S.a)(n,[{key:"DrawBody",value:function(){this.ctx.beginPath(),this.ClearShadowStyle(),this.ctx.moveTo(this.drawConstants.center+this.drawConstants.circleRadius,this.drawConstants.center),this.ctx.arc(this.drawConstants.center,this.drawConstants.center,this.drawConstants.circleRadius,0,2*Math.PI),this.ctx.fillStyle=this.innerColor,this.ctx.fill()}},{key:"DrawInputOutline",value:function(e,t){var n=this.drawConstants.center,r=Ae(e),a=r+this.drawConstants.apertureAngle,i=n+this.drawConstants.circleRadius*Math.cos(a),o=n+this.drawConstants.circleRadius*Math.sin(a),s=i+this.drawConstants.armLength*Math.cos(r+this.drawConstants.armAngle),l=o+this.drawConstants.armLength*Math.sin(r+this.drawConstants.armAngle),c=Ae(t),u=c-this.drawConstants.apertureAngle,h=n+this.drawConstants.circleRadius*Math.cos(u),d=n+this.drawConstants.circleRadius*Math.sin(u),p=h+this.drawConstants.armLength*Math.cos(c-this.drawConstants.armAngle),C=d+this.drawConstants.armLength*Math.sin(c-this.drawConstants.armAngle);this.ctx.beginPath(),this.ctx.moveTo(s,l),this.ctx.lineTo(i,o),this.ctx.arc(n,n,this.drawConstants.circleRadius,a,u),this.ctx.lineTo(p,C),this.ctx.strokeStyle=this.borderColor,this.ctx.lineWidth=this.drawConstants.borderWidth,this.SetShadowStyle(),this.ctx.stroke()}},{key:"DrawNoInputOutline",value:function(){this.ctx.beginPath(),this.ctx.moveTo(this.drawConstants.center+this.drawConstants.circleRadius,this.drawConstants.center),this.ctx.arc(this.drawConstants.center,this.drawConstants.center,this.drawConstants.circleRadius,0,2*Math.PI),this.ctx.strokeStyle=this.borderColor,this.SetShadowStyle(),this.ctx.lineWidth=this.drawConstants.borderWidth,this.ctx.stroke()}},{key:"DrawInputGradient",value:function(e){var t=Ae(e.Direction),n=t-this.drawConstants.apertureAngle,r=this.drawConstants.center+this.drawConstants.circleRadius*Math.cos(n),a=this.drawConstants.center+this.drawConstants.circleRadius*Math.sin(n),i=r+this.drawConstants.armLength*Math.cos(t-this.drawConstants.armAngle),o=a+this.drawConstants.armLength*Math.sin(t-this.drawConstants.armAngle),s=t+this.drawConstants.apertureAngle,l=this.drawConstants.center+this.drawConstants.circleRadius*Math.cos(s),c=this.drawConstants.center+this.drawConstants.circleRadius*Math.sin(s),u=l+this.drawConstants.armLength*Math.cos(t+this.drawConstants.armAngle),h=c+this.drawConstants.armLength*Math.sin(t+this.drawConstants.armAngle);this.ctx.beginPath(),this.ClearShadowStyle(),this.ctx.moveTo(r,a);var d=Math.atan2(o-this.drawConstants.center,i-this.drawConstants.center),p=Math.atan2(h-this.drawConstants.center,u-this.drawConstants.center);this.ctx.arc(this.drawConstants.center,this.drawConstants.center,this.drawConstants.circleRadius+this.drawConstants.protrudingArm,d,p),this.ctx.arc(this.drawConstants.center,this.drawConstants.center,this.drawConstants.circleRadius-.5*this.drawConstants.borderWidth,s,n,!0);var C=this.ctx.createRadialGradient(this.drawConstants.center,this.drawConstants.center,this.drawConstants.circleRadius,this.drawConstants.center,this.drawConstants.center,this.drawConstants.circleRadius+this.drawConstants.protrudingArm);e.UseMachineColor?C.addColorStop(0,this.innerColor):(C.addColorStop(0,e.Channel),C.addColorStop(.7,e.Channel),C.addColorStop(.8,this.backgroundColor)),C.addColorStop(1,this.backgroundColor),this.ctx.fillStyle=C,this.ctx.fill()}}]),n}(kt),Mt=function(e){Object(Ot.a)(n,e);var t=Object(St.a)(n);function n(e,r){var a;return Object(O.a)(this,n),(a=t.call(this,e,r)).closeSide=void 0,a.farSide=void 0,a.innerClose=void 0,a.innerFar=void 0,a.armProtrudingClose=void 0,a.armProtrudingFar=void 0,a.armWidthClose=void 0,a.armWidthFar=void 0,a.closeSide=a.drawConstants.center-a.drawConstants.halfSquareSize,a.farSide=a.drawConstants.center+a.drawConstants.halfSquareSize,a.innerClose=a.drawConstants.center-.5*a.drawConstants.aperture,a.innerFar=a.drawConstants.center+.5*a.drawConstants.aperture,a.armProtrudingClose=a.closeSide-Math.cos(a.drawConstants.armAngle)*a.drawConstants.armLength,a.armProtrudingFar=a.farSide+Math.cos(a.drawConstants.armAngle)*a.drawConstants.armLength,a.armWidthClose=a.innerClose-Math.sin(a.drawConstants.armAngle)*a.drawConstants.armLength,a.armWidthFar=a.innerFar+Math.sin(a.drawConstants.armAngle)*a.drawConstants.armLength,a}return Object(S.a)(n,[{key:"DrawBody",value:function(){this.ctx.beginPath(),this.ClearShadowStyle(),this.ctx.moveTo(this.drawConstants.center+this.drawConstants.circleRadius,this.drawConstants.center),this.ctx.rect(this.drawConstants.center-this.drawConstants.halfSquareSize,this.drawConstants.center-this.drawConstants.halfSquareSize,2*this.drawConstants.halfSquareSize,2*this.drawConstants.halfSquareSize),this.ctx.fillStyle=this.innerColor,this.ctx.fill(),this.ctx.beginPath()}},{key:"DrawInputOutline",value:function(e,t){switch(this.ctx.beginPath(),this.ctx.strokeStyle=this.borderColor,this.SetShadowStyle(),this.ctx.lineWidth=this.drawConstants.borderWidth,e){case Y.Down:this.ctx.moveTo(this.armWidthFar,this.armProtrudingClose),this.ctx.lineTo(this.innerFar,this.closeSide);break;case Y.Left:this.ctx.moveTo(this.armProtrudingFar,this.armWidthFar),this.ctx.lineTo(this.farSide,this.innerFar);break;case Y.Up:this.ctx.moveTo(this.armWidthClose,this.armProtrudingFar),this.ctx.lineTo(this.innerClose,this.farSide);break;case Y.Right:this.ctx.moveTo(this.armProtrudingClose,this.armWidthClose),this.ctx.lineTo(this.closeSide,this.innerClose);break;default:throw Error("Unknown direction")}var n=e;do{switch(n){case Y.Down:this.ctx.lineTo(this.farSide,this.closeSide);break;case Y.Left:this.ctx.lineTo(this.farSide,this.farSide);break;case Y.Up:this.ctx.lineTo(this.closeSide,this.farSide);break;case Y.Right:this.ctx.lineTo(this.closeSide,this.closeSide);break;default:throw Error("Unknown direction")}n=(n+1)%4}while(n!==t);switch(t){case Y.Down:this.ctx.lineTo(this.innerClose,this.closeSide),this.ctx.lineTo(this.armWidthClose,this.armProtrudingClose);break;case Y.Left:this.ctx.lineTo(this.farSide,this.innerClose),this.ctx.lineTo(this.armProtrudingFar,this.armWidthClose);break;case Y.Up:this.ctx.lineTo(this.innerFar,this.farSide),this.ctx.lineTo(this.armWidthFar,this.armProtrudingFar);break;case Y.Right:this.ctx.lineTo(this.closeSide,this.innerFar),this.ctx.lineTo(this.armProtrudingClose,this.armWidthFar);break;default:throw Error("Unknown direction")}this.ctx.stroke()}},{key:"DrawNoInputOutline",value:function(){this.ctx.beginPath(),this.ctx.moveTo(this.drawConstants.center+this.drawConstants.circleRadius,this.drawConstants.center),this.ctx.rect(this.drawConstants.center-this.drawConstants.halfSquareSize,this.drawConstants.center-this.drawConstants.halfSquareSize,2*this.drawConstants.halfSquareSize,2*this.drawConstants.halfSquareSize),this.ctx.strokeStyle=this.borderColor,this.SetShadowStyle(),this.ctx.lineWidth=this.drawConstants.borderWidth,this.ctx.stroke()}},{key:"DrawInputGradient",value:function(e){var t;switch(this.ctx.beginPath(),this.ClearShadowStyle(),e.Direction){case Y.Down:this.ctx.moveTo(this.innerClose,this.closeSide+.4*this.drawConstants.borderWidth),this.ctx.lineTo(this.armWidthClose,this.armProtrudingClose),this.ctx.lineTo(this.armWidthFar,this.armProtrudingClose),this.ctx.lineTo(this.innerFar,this.closeSide+.4*this.drawConstants.borderWidth),this.ctx.lineTo(this.innerClose,this.closeSide+.4*this.drawConstants.borderWidth),t=this.ctx.createLinearGradient(this.drawConstants.center,this.closeSide+.4*this.drawConstants.borderWidth,this.drawConstants.center,this.armProtrudingClose);break;case Y.Left:this.ctx.moveTo(this.farSide-.4*this.drawConstants.borderWidth,this.innerClose),this.ctx.lineTo(this.armProtrudingFar,this.armWidthClose),this.ctx.lineTo(this.armProtrudingFar,this.armWidthFar),this.ctx.lineTo(this.farSide-.4*this.drawConstants.borderWidth,this.innerFar),this.ctx.lineTo(this.farSide-.4*this.drawConstants.borderWidth,this.innerClose),t=this.ctx.createLinearGradient(this.farSide-.4*this.drawConstants.borderWidth,this.drawConstants.center,this.armProtrudingFar,this.drawConstants.center);break;case Y.Up:this.ctx.moveTo(this.innerFar,this.farSide-.4*this.drawConstants.borderWidth),this.ctx.lineTo(this.armWidthFar,this.armProtrudingFar),this.ctx.lineTo(this.armWidthClose,this.armProtrudingFar),this.ctx.lineTo(this.innerClose,this.farSide-.4*this.drawConstants.borderWidth),this.ctx.lineTo(this.innerFar,this.farSide-.4*this.drawConstants.borderWidth),t=this.ctx.createLinearGradient(this.drawConstants.center,this.farSide-.4*this.drawConstants.borderWidth,this.drawConstants.center,this.armProtrudingFar);break;case Y.Right:this.ctx.moveTo(this.closeSide+.4*this.drawConstants.borderWidth,this.innerFar),this.ctx.lineTo(this.armProtrudingClose,this.armWidthFar),this.ctx.lineTo(this.armProtrudingClose,this.armWidthClose),this.ctx.lineTo(this.closeSide+.4*this.drawConstants.borderWidth,this.innerClose),this.ctx.lineTo(this.closeSide+.4*this.drawConstants.borderWidth,this.innerFar),t=this.ctx.createLinearGradient(this.closeSide+.4*this.drawConstants.borderWidth,this.drawConstants.center,this.armProtrudingClose,this.drawConstants.center);break;default:throw Error("Unknown direction")}e.UseMachineColor?t.addColorStop(0,this.innerColor):(t.addColorStop(0,e.Channel),t.addColorStop(.9,e.Channel),t.addColorStop(.9,this.backgroundColor)),t.addColorStop(1,this.backgroundColor),this.ctx.fillStyle=t,this.ctx.fill()}}]),n}(kt),Dt=function(e){var t=Object(a.useRef)(null);return Object(a.useEffect)((function(){if(t.current){var n=t.current.getContext("2d");n.clearRect(0,0,e.CellSize,e.CellSize),(e.IsDefault?new It(n,e):new Mt(n,e)).DrawMachine()}})),i.a.createElement("div",{style:{height:e.CellSize,width:e.CellSize,position:"absolute"}},i.a.createElement("canvas",{ref:t,style:{position:"absolute"},height:e.CellSize,width:e.CellSize}))},xt=n(23),Et=function(e){Object(Ot.a)(n,e);var t=Object(St.a)(n);function n(e){var r;return Object(O.a)(this,n),(r=t.call(this,e)).onClicked=r.onClicked.bind(Object(xt.a)(r)),r}return Object(S.a)(n,[{key:"render",value:function(){var e=this.props.cellSize-2,t={position:"absolute",height:.2*e,width:.4*e,marginLeft:.3*e,marginTop:.05*e,pointerEvents:"all"},n="";switch(this.props.Direction){case Y.Left:n="rotate(90deg)";break;case Y.Up:n="rotate(180deg)";break;case Y.Right:n="rotate(270deg)"}var r={transform:n,height:e,width:e,position:"absolute",pointerEvents:"none"};return i.a.createElement("div",{style:r},i.a.createElement("div",{style:t,onClick:this.onClicked}))}},{key:"onClicked",value:function(e){this.props.OnClick(this.props.Direction)}}]),n}(i.a.Component),Gt=Object(l.b)((function(e,t){var n,r=f(e),a=Le(r.Style.Color,.3),i=r.Setup.MachineInstances.find((function(e){return e.Id===t.MachineInstanceId})),o=L(i.MachineId)?void 0:"Deleted"===i.Status?C(e).deletedMachines.find((function(e){return e.Id===i.MachineId})).Style:C(e).machines.find((function(e){return e.Id===i.MachineId})).Style,s=(null===(n=e.movingOutput)||void 0===n?void 0:n.machineInstanceId)===t.MachineInstanceId?e.movingOutput:void 0;return{MachineInstance:i,MachineStyle:o,BackgroundColor:a,MovingOutput:s}}),(function(e,t){return{ChangeOwnChannel:function(n,r){return e(ht(t.MachineInstanceId,n,r))},ChangeChannel:function(t,n,r){return e(ht(t,n,r))},ChangeInputChannel:function(n,r){return e(function(e,t,n){return{type:"InputChannelChangedActionType",machineInstanceId:e,channelIndex:t,channel:n}}(t.MachineInstanceId,n,r))},FixMachine:function(){return e({type:"FixMachineActionType",machineInstanceId:t.MachineInstanceId})}}}))((function(e){var t,n=Object(c.c)({item:{type:dt,id:e.MachineInstanceId},collect:function(e){return{isDragging:!!e.isDragging()}}}),r=Object(d.a)(n,3),a=r[0].isDragging,o=r[1],s=r[2],l=it.GetStore().GetMachineType(e.MachineInstance.MachineId).Api,u=function(t){var n=e.MachineInstance.InputChannels.findIndex((function(e){return e.Direction===t})),r=e.MachineInstance.InputChannels[n],a=l.InputChannels.indexOf(r.Channel),i={Channel:a===l.InputChannels.length-1?l.InputChannels[0]:l.InputChannels[a+1],Direction:r.Direction,Status:r.Status};e.ChangeInputChannel(n,i)},p=null!==(t=e.MachineStyle)&&void 0!==t?t:it.GetStore().GetMachineType(e.MachineInstance.MachineId).Style,C=l.InputChannels.length>1||e.MachineInstance.InputChannels.some((function(e){return"Exists"===e.Status&&e.Channel!==l.InputChannels[0]})),f=e.MachineInstance.InputChannels.filter((function(e){return"DoesNotExist"!==e.Status})).map((function(e){return Object(h.a)({UseMachineColor:!C},e)})),v={height:e.CellSize,width:e.CellSize,margin:1};switch(e.MachineInstance.Status){case"Deleted":v.borderBottom=e.CellSize/18+"px dotted red",v.boxSizing="border-box",v.opacity=.4;break;case"ChannelsInvalid":v.borderBottom=e.CellSize/18+"px dotted orange",v.boxSizing="border-box"}var m,b=[],y=Object(g.a)(e.MachineInstance.OutputChannels);try{var w=function(){var e=m.value,t=b.find((function(t){return t[0].Direction===e.Direction}));void 0===t?b.push([e]):t.push(e)};for(y.s();!(m=y.n()).done;)w()}catch(S){y.e(S)}finally{y.f()}var O=.5*e.CellSize-xe*e.CellSize;return i.a.createElement("div",{ref:s,style:v},!a&&i.a.createElement(Dt,{MachineStyle:p,IsDefault:L(e.MachineInstance.MachineId),BackgroundColor:e.BackgroundColor,InputChannels:f,OutputChannels:b,MovingOutput:void 0!==e.MovingOutput?e.MovingOutput:void 0,CellSize:e.CellSize}),i.a.createElement("div",{style:{position:"absolute",marginLeft:O,marginTop:O,height:xe*e.CellSize*2,width:xe*e.CellSize*2},ref:o,onClick:function(){"Valid"!==e.MachineInstance.Status&&e.FixMachine()}}),f.filter((function(e){return!e.UseMachineColor})).map((function(t,n){return i.a.createElement(Et,{key:n,Direction:t.Direction,OnClick:u,cellSize:e.CellSize})})),b.map((function(t,n){return i.a.createElement(wt,{key:n,ChannelModels:t,OnChanged:e.ChangeOwnChannel,MachineInstanceId:e.MachineInstanceId,cellSize:e.CellSize})})))})),Tt=Object(l.b)((function(e,t){var n=f(e),r=n.Setup.MachineInstances.find((function(e){return De(e.Cell,t.cellId)})),a=n.ExitCells.find((function(e){return De(e.Cell,t.cellId)})),i=e.messages.find((function(e){return De(e.Cell,t.cellId)})),o=v(e);return{Exit:void 0===a?void 0:a.Direction,Message:void 0===i?void 0:i.Content,MachineInstanceId:void 0===r?void 0:r.Id,CellSize:o}}),{OnNewMachine:function(e,t,n){return{type:"MachineAddedActionType",machineId:e,cell:n,api:t}},OnMovedMachine:function(e,t){return{type:"MachineMovedActionType",machineInstanceId:e,newCell:t}},ChangeChannel:ht})((function(e){var t,n=Object(c.e)({accept:[dt,pt,Ct],drop:function(t,n){switch(t.type){case dt:e.OnMovedMachine(n.getItem().id,e.cellId);break;case pt:var r=n.getItem(),a=it.GetStore().GetMachineType(r.id);e.OnNewMachine(r.id,a.Api,e.cellId);break;case Ct:var i=n.getItem(),o=Te(n,i.offsetX,i.offsetY);if(void 0!==o){var s=o+2.75*Math.PI,l=Math.floor(s/(.5*Math.PI))%4;e.ChangeChannel(i.machineInstanceId,{Direction:l,Channel:i.channel.Channel,Status:i.channel.Status},o)}}}}),r=Object(d.a)(n,2)[1],a={height:e.smallHeigth?.625*e.CellSize:e.CellSize,width:e.smallWidth?.625*e.CellSize:e.CellSize,border:"1px solid black",float:"left",marginTop:-1,marginLeft:-1,position:"relative"},o=.2*e.CellSize;if(void 0!==e.Exit)switch(e.Exit){case Y.Up:a.borderRight="1px solid black",a.borderBottom="1px solid black",a.borderLeft="1px solid black",a.borderTop=o+"px solid blue",a.marginTop=-o;break;case Y.Down:a.borderRight="1px solid black",a.borderTop="1px solid black",a.borderLeft="1px solid black",a.borderBottom=o+"px solid red",a.marginBottom=1-o;break;case Y.Right:a.borderTop="1px solid black",a.borderBottom="1px solid black",a.borderLeft="1px solid black",a.borderRight=o+"px solid green",a.marginRight=1-o;break;case Y.Left:a.borderRight="1px solid black",a.borderBottom="1px solid black",a.borderTop="1px solid black",a.borderLeft=o+"px solid #fff020",a.marginLeft=-o}else a.borderRight="1px solid black",a.borderBottom="1px solid black",a.borderLeft="1px solid black",a.borderTop="1px solid black";return void 0!==e.Message&&(t=vt(e.Message)),i.a.createElement("div",{style:a,ref:r},void 0!==t&&t,void 0!==e.MachineInstanceId?i.a.createElement(Gt,{MachineInstanceId:e.MachineInstanceId,CellSize:e.CellSize-2}):"")}));var At,jt=Object(l.b)((function(e){var t=f(e),n=v(e);return{Rows:t.Setup.NumberOfRows,Columns:t.Setup.NumberOfColumns,Style:t.Style,CellSize:n}}))((function(e){for(var t=[],n=0;n<e.Rows;n++){for(var r=[],a=0;a<e.Columns;a++)r.push(i.a.createElement(Tt,{key:a,cellId:{Row:n,Column:a},smallHeigth:0===n||n===e.Rows-1,smallWidth:0===a||a===e.Columns-1}));t.push(i.a.createElement("div",{key:n,style:{display:"flex",flexDirection:"row",opacity:1}},r))}return i.a.createElement("div",{style:{position:"absolute",borderColor:Le(e.Style.BorderColor,.4),borderWidth:.2*e.CellSize,borderStyle:"solid",marginBottom:0}},i.a.createElement("div",{style:{display:"flex",flexDirection:"column",backgroundColor:Le(e.Style.Color,.3)}},t))}));!function(e){e[e.NotChecked=0]="NotChecked",e[e.NotFullfilled=1]="NotFullfilled",e[e.Fullfilled=2]="Fullfilled",e[e.NotMatched=3]="NotMatched"}(At||(At={}));var Rt=function(e){var t={display:"flex",flexFlow:"row",justifyContent:e.Input?"flex-start":"flex-end",marginBottom:1},n={display:"flex",flexFlow:"row"};switch(e.Status){case At.Fullfilled:n.backgroundColor="#d9ffb3",e.Editable&&(n.borderRight="solid green",n.borderBottom="solid green");break;case At.NotFullfilled:break;case At.NotMatched:n.border="solid red",n.backgroundColor="#ffb3b3"}return i.a.createElement("div",{style:t},i.a.createElement("div",{style:n},e.Input&&void 0!==e.Remove&&i.a.createElement("button",{onClick:e.Remove},"-"),e.Input&&(e.Editable&&e.AllowedInputColors.length>1?i.a.createElement("select",{value:e.Message.Channel,style:{backgroundColor:e.Message.Channel},onChange:function(t){void 0!==e.OnMessageChanged&&e.OnMessageChanged({Content:e.Message.Content,Channel:t.target.value})}},e.AllowedInputColors.map((function(e,t){return i.a.createElement("option",{value:e,key:t,style:{backgroundColor:e}})}))):i.a.createElement("div",{style:{backgroundColor:e.Message.Channel,width:10}})),e.Editable?i.a.createElement("input",{value:e.Message.Content,onChange:function(t){void 0!==e.OnMessageChanged&&e.OnMessageChanged({Content:t.target.value,Channel:e.Message.Channel})}}):i.a.createElement("label",null,vt(e.Message.Content)),!e.Input&&i.a.createElement("div",{style:{backgroundColor:e.Message.Channel,width:10}})))},Ft=Object(l.b)(void 0,{RemoveTest:function(e){return{type:"RemoveTestActionType",testId:e}},RemoveInput:function(e,t){return{type:"RemoveInputActionType",testId:e,order:t}},UpdateInput:function(e,t){return{type:"UpdateInputActionType",input:e,testId:t}},AddInput:function(e){return{type:"AddInputActionType",testId:e}}})((function(e){for(var t=Object(a.useState)(void 0),n=Object(d.a)(t,2),o=n[0],s=n[1],l=e.Test.inputs,c=e.Test.expectedOutputs,u=[],p=0,C=function(t){u.push(i.a.createElement("div",{key:p++,style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},i.a.createElement(Rt,{Message:l[t],Input:!0,Status:At.NotChecked,Editable:e.Test.editable,AllowedInputColors:e.MultipleInputsEditable?[r.Green,r.Blue,r.Red,r.Yellow]:[r.Green],Remove:e.MultipleInputsEditable?function(){return e.RemoveInput(e.Test.id,t)}:void 0,OnMessageChanged:function(n){return e.UpdateInput(Object(h.a)(Object(h.a)({},n),{},{Order:t}),e.Test.id)}})));var n=c.filter((function(e){return e.Order===t})),a=void 0;void 0!==e.Test.actualOutputs&&(a=e.Test.actualOutputs.filter((function(e){return e.Order===t})));for(var o=function(e){var t=n[e],r=At.NotChecked;if(void 0!==a){var o=a.findIndex((function(e){return e.Channel===t.Channel&&e.Content===t.Content}));o>-1?(r=At.Fullfilled,a.splice(o,1)):r=At.NotFullfilled}u=u.concat(i.a.createElement(Rt,{Message:n[e],Input:!1,key:p++,Status:r,Editable:!1,AllowedInputColors:[]}))},s=0;s<n.length;s++)o(s);void 0!==a&&(u=u.concat(a.map((function(t){return i.a.createElement(Rt,{Message:t,Input:!1,key:p++,Status:e.IsSandBoxLevel?At.NotFullfilled:At.NotMatched,AllowedInputColors:[],Editable:!1})}))))},v=0;v<l.length;v++)C(v);var m={display:"flex",flexDirection:"row",borderBottom:e.CanPlay?"solid 0.5px":"",marginTop:5};return i.a.createElement("div",{style:m},e.IsSandBoxLevel&&i.a.createElement("button",{onClick:function(){return e.RemoveTest(e.Test.id)}},"-"),e.CanPlay&&i.a.createElement("button",{onClick:function(){s(void 0);var t=f($e());void 0!==t&&new ct(t.Setup,!0).RunComputation(e.Test.id,Qe).catch((function(e){s(e.toString())}))}},"Play"),i.a.createElement("div",{style:{display:"flex",flexDirection:"column",flexGrow:1}},void 0!==o&&i.a.createElement("div",{style:{color:"red"}},i.a.createElement("label",null,o)),u,e.MultipleInputsEditable&&i.a.createElement("button",{style:{alignSelf:"start"},onClick:function(){return e.AddInput(e.Test.id)}},"+")))})),Lt=Object(l.b)((function(e){return{Level:e.activeLevel,Status:C(e).levelData.find((function(t){return t.Id===e.activeLevel.id})).State}}),{AddTest:function(){return{type:"AddTestActionType"}},SwitchScreen:m})((function(e){var t=e.Level.tests.filter((function(e){return e.showing})).map((function(t,n){return i.a.createElement(Ft,{CanPlay:!0,Test:Object(h.a)(Object(h.a)({},t),{},{expectedOutputs:e.Level.getOutputs(t.inputs)}),MultipleInputsEditable:t.editable&&e.Level.allowedMachines.filter((function(e){return B(e)})).length>1,IsSandBoxLevel:"12"===e.Level.id,key:n})}));function n(){return(n=Object(w.a)(y.a.mark((function t(){var n,r,a,i,o;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===(n=f($e()))){t.next=23;break}r=Object(g.a)(e.Level.tests),t.prev=3,r.s();case 5:if((a=r.n()).done){t.next=15;break}return i=a.value,o=new ct(n.Setup,!0),t.next=10,o.RunComputation(i.id,Qe).catch((function(e){return!1}));case 10:if(!1!==t.sent){t.next=13;break}return t.abrupt("break",15);case 13:t.next=5;break;case 15:t.next=20;break;case 17:t.prev=17,t.t0=t.catch(3),r.e(t.t0);case 20:return t.prev=20,r.f(),t.finish(20);case 23:case"end":return t.stop()}}),t,null,[[3,17,20,23]])})))).apply(this,arguments)}return i.a.createElement("div",{style:{height:e.Height,display:"flex",flexDirection:"column"}},i.a.createElement("div",null,i.a.createElement("b",null,e.Level.name),i.a.createElement("br",null),i.a.createElement("i",null,e.Level.description)),i.a.createElement("div",{style:{overflow:"auto"}},t,"12"===e.Level.id&&i.a.createElement(i.a.Fragment,null,i.a.createElement("button",{onClick:e.AddTest},"Add custom test"))),i.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},i.a.createElement("button",{style:{marginTop:5},onClick:function(){return n.apply(this,arguments)}},"Play all tests"),"12"!==e.Level.id&&i.a.createElement("button",{style:{marginTop:5},onClick:e.CompleteLevel},"Complete level")),e.Status===Oe.NonValidMachineUsed&&i.a.createElement("b",{style:{color:"red"}},"Machine used that is not allowed this level"))})),Bt=.33*z.CellSize,Nt=function(e){var t=Me(e.MachineType.Api),n=t.inputChannels,r=t.outputChannels;return i.a.createElement("div",{style:{display:"flex"}},i.a.createElement("div",{style:{height:Bt,width:Bt}},i.a.createElement(Dt,{MachineStyle:e.MachineType.Style,IsDefault:e.IsDefault,BackgroundColor:"White",InputChannels:n,OutputChannels:r,CellSize:Bt})),i.a.createElement("label",null,e.MachineType.Style.Name))};function Pt(){return{type:"AddNewMachineActionType"}}function zt(e){return{type:"ChangeCellSizeActionType",cellSize:e}}var Wt=Object(l.b)((function(e,t){return{status:L(t.machine)?"Valid":C(e).machines.find((function(e){return e.Id===t.machine})).Status,machineType:it.GetStore().GetMachineType(t.machine)}}),{LoadCustomMachine:function(e){return{type:"LoadCustomMachineActionType",machineId:e}},DeleteMachine:function(e){return{type:"DeleteMachineActionType",machineId:e}}})((function(e){var t=Object(c.c)({item:{type:pt,id:e.machine},collect:function(e){return{isDragging:!!e.isDragging()}}}),n=Object(d.a)(t,3),r=n[1],o=n[2],s=Object(a.useState)(!1),l=Object(d.a)(s,2),h=l[0],p=l[1];Object(a.useEffect)((function(){o(Object(u.b)(),{captureDraggingState:!0})}),[o]);var C=L(e.machine),f="Invalid"===e.status?{borderBottom:z.CellSize/18+"px dotted orange",boxSizing:"border-box"}:{};return i.a.createElement("div",{ref:r,title:e.machineType.Style.Description,onClick:function(){return p(!h)}},i.a.createElement("div",{style:f},i.a.createElement(Nt,{MachineType:e.machineType,IsDefault:C})),!C&&h&&i.a.createElement("div",{style:{display:"flex"}},i.a.createElement("button",{onClick:function(t){return e.LoadCustomMachine(e.machine)}},"Edit"),i.a.createElement("button",{onClick:function(t){e.DeleteMachine(e.machine)}},"Delete")))})),Ut=Object(l.b)((function(e){var t,n=it.GetStore().GetAllMachines(),r=[],a=[],i=[],o=Object(g.a)(n);try{var s=function(){var n=t.value;e.activeLevel.allowedMachines.some((function(e){return n===e}))?B(n)?i.push(n):r.push(n):a.push(n)};for(o.s();!(t=o.n()).done;)s()}catch(d){o.e(d)}finally{o.f()}var l=f(e);if(void 0!==l){var c=l.Setup.MachineInstances.filter((function(e){return B(e.MachineId)})),u=i.find((function(e){return!c.some((function(t){return t.MachineId===e}))}));void 0!==u&&(r=[u].concat(Object(q.a)(r)))}var h=C(e).machines.filter((function(e){return!e.DependingOn.some((function(e){return L(e)&&a.some((function(t){return t===e}))}))})).map((function(e){return e.Id}));return{allowedMachines:r=r.concat(h)}}),{AddNewMachine:Pt})((function(e){var t=e.allowedMachines.map((function(e){return i.a.createElement("div",{key:e},i.a.createElement(Wt,{machine:e}))}));return i.a.createElement("div",{style:{overflow:"auto",width:"100%",height:e.height,position:"absolute"}},i.a.createElement("button",{onClick:e.AddNewMachine},"Create new machine"),t)}));function qt(e){e.stopPropagation()}var Vt=Object(l.b)((function(e){return{MachineType:f(e),CellSize:v(e)}}),{ChangeCellSize:zt})((function(e){var t,n,o,s,l=Object(a.useState)(e.CellSize),c=Object(d.a)(l,2),u=c[0],h=c[1],p=Object(a.useState)(Ne()),C=Object(d.a)(p,1)[0],f=Object(a.useState)(Le(Ne(),.3)),v=Object(d.a)(f,1)[0];var m=null!==(t=null===(n=e.MachineType)||void 0===n?void 0:n.Api)&&void 0!==t?t:{OutputChannels:[r.Green],InputChannels:[r.Green]},g=null!==(o=null===(s=e.MachineType)||void 0===s?void 0:s.Style)&&void 0!==o?o:{BorderColor:"red",Color:"green",Name:"Dummy",Description:"dummy"},b=Me(m);return i.a.createElement("div",{style:{margin:10,width:500,borderColor:C,backgroundColor:v,borderWidth:20,borderStyle:"solid",padding:30}},i.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},i.a.createElement("div",{style:{height:e.CellSize,width:e.CellSize,alignSelf:"center"}},i.a.createElement(Dt,{MachineStyle:g,IsDefault:!1,BackgroundColor:v,InputChannels:b.inputChannels,OutputChannels:b.outputChannels,MovingOutput:void 0,CellSize:e.CellSize})),i.a.createElement("input",{type:"range",min:"10",max:"200",onChange:function(t){return n=Number(t.currentTarget.value),e.ChangeCellSize(n),void h(n);var n},value:u}),u),i.a.createElement("button",{className:"startMenu",onClick:e.Close},"Close"))})),Yt=Object(l.b)((function(e){return{MachineType:f(e),CellSize:v(e)}}),{SetName:function(e){return{type:"SetNameActionType",name:e}},SetDescription:function(e){return{type:"SetDescriptionActionType",description:e}},SetColor:function(e){return{type:"SetColorActionType",color:e}},SetBorderColor:function(e){return{type:"SetBorderColorActionType",borderColor:e}}})((function(e){var t=Object(a.useState)(e.MachineType.Style.Color),n=Object(d.a)(t,2),r=n[0],o=n[1],s=Object(a.useState)(e.MachineType.Style.BorderColor),l=Object(d.a)(s,2),c=l[0],u=l[1],h=Object(a.useState)(Ne()),p=Object(d.a)(h,1)[0],C=Object(a.useState)(Le(Ne(),.3)),f=Object(d.a)(C,1)[0];var v=Me(e.MachineType.Api);return i.a.createElement("div",{style:{margin:10,width:500,borderColor:p,backgroundColor:f,borderWidth:20,borderStyle:"solid",padding:30}},void 0!==e.MachineType&&i.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},i.a.createElement("div",{style:{height:e.CellSize,width:e.CellSize,alignSelf:"center"}},i.a.createElement(Dt,{MachineStyle:e.MachineType.Style,IsDefault:!1,BackgroundColor:f,InputChannels:v.inputChannels,OutputChannels:v.outputChannels,MovingOutput:void 0,CellSize:z.CellSize})),i.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},i.a.createElement("label",null,"Name"),i.a.createElement("input",{onChange:function(t){return e.SetName(t.target.value)},value:e.MachineType.Style.Name})),i.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},i.a.createElement("label",null,"Color"),i.a.createElement("input",{onChange:function(t){return function(t){o(t),e.SetColor(t)}(t.target.value)},value:r})),i.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},i.a.createElement("label",null,"BorderColor"),i.a.createElement("input",{onChange:function(t){return function(t){u(t),e.SetBorderColor(t)}(t.target.value)},value:c})),i.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},i.a.createElement("label",null,"Description"),i.a.createElement("textarea",{cols:50,rows:5,onChange:function(t){return e.SetDescription(t.target.value)},value:e.MachineType.Style.Description}))),i.a.createElement("button",{className:"startMenu",onClick:e.Close},"Close"))}));var Ht=Object(l.b)((function(e){return{hasActiveMachine:void 0!==f(e)}}),{SwitchScreen:m})((function(e){var t=Object(a.useState)("none"),n=Object(d.a)(t,2),r=n[0],o=n[1],s=Object(a.useState)(Ne()),l=Object(d.a)(s,1)[0],c=Object(a.useState)(Le(Ne(),.3)),u=Object(d.a)(c,1)[0];return i.a.createElement("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},onClick:qt},"none"!==r&&i.a.createElement("div",{style:{width:220}}),i.a.createElement("div",{style:{borderColor:l,backgroundColor:u,borderWidth:20,borderStyle:"solid",padding:30,display:"flex",flexDirection:"column"}},i.a.createElement("button",{className:"startMenu",onClick:function(){return e.SwitchScreen("startMenu")}},"Back to menu"),e.hasActiveMachine&&i.a.createElement("button",{className:"startMenu",onClick:function(){return o("editMachine")}},"Edit machine style"),i.a.createElement("button",{className:"startMenu",onClick:function(){return o("changeCellSize")}},"Change cell size"),i.a.createElement("button",{className:"startMenu",onClick:e.Close},"Continue playing")),"editMachine"===r&&i.a.createElement(Yt,{Close:function(){return o("none")}}),"changeCellSize"===r&&i.a.createElement(Vt,{Close:function(){return o("none")}}))})),Xt=Object(l.b)((function(e){return{cellSize:v(e)}}),{})((function(e){var t=it.GetStore().GetMachineType(e.machineId),n=Me(t.Api),r=n.inputChannels,a=n.outputChannels,o="translate(".concat(e.offset.x-e.cellSize/2,"px, ").concat(e.offset.y-e.cellSize/2,"px)");return i.a.createElement("div",{style:{position:"absolute",transform:o,pointerEvents:"none"}},i.a.createElement(Dt,{InputChannels:r,OutputChannels:a,MachineStyle:t.Style,BackgroundColor:"white",CellSize:e.cellSize,IsDefault:L(e.machineId)}))}));var _t=Object(l.b)((function(e){var t=f(e),n=v(e);return{Rows:t.Setup.NumberOfRows,Columns:t.Setup.NumberOfColumns,Style:t.Style,CellSize:n}}))((function(e){var t=e.CellSize*(e.Rows-.35),n=e.CellSize*(e.Columns-.35),r=Object(a.useState)((e.WindowWidth-n)/2),o=Object(d.a)(r,2),s=o[0],l=o[1],h=Object(a.useState)((e.WindowHeight-t)/2),p=Object(d.a)(h,2),C=p[0],f=p[1],v=Object(a.useState)({x:0,y:0}),m=Object(d.a)(v,2),g=m[0],b=m[1],y=Object(c.c)({item:{type:ft},end:function(e,t){var n=t.getDifferenceFromInitialOffset();null!==n&&b(n)},collect:function(e){return{isDragging:e.isDragging()}}}),w=Object(d.a)(y,3),O=w[0].isDragging,S=w[1],k=w[2];Object(a.useEffect)((function(){l((function(e){return e+g.x})),f((function(e){return e+g.y}))}),[g]);var I=Object(c.d)((function(e){if(e.getItemType()===ft){var t=e.getDifferenceFromInitialOffset();return null!==t?t:void 0}}));Object(a.useEffect)((function(){k(Object(u.b)(),{captureDraggingState:!0})}),[k]);var M=O&&void 0!==I?s+I.x:s,D=O&&void 0!==I?C+I.y:C;return i.a.createElement("div",{ref:S,style:{position:"absolute",top:D,left:M,height:t,width:n}},e.children)})),Jt=function(e){var t=Object(a.useState)(Le(Ne(),.3)),n=Object(d.a)(t,1)[0],r=Object(a.useState)(Ne()),o=Object(d.a)(r,1)[0];return i.a.createElement("div",{style:{borderColor:o,backgroundColor:n,borderWidth:20,borderStyle:"solid",padding:30,display:"flex",flexDirection:"column"}},e.children)};function Kt(e,t){if(e.length!==t.length)return!1;var n,r=Object(g.a)(e);try{var a=function(){var e=n.value;if(1!==t.filter((function(t){return t.Order===e.Order&&t.Channel===e.Channel&&t.Content===e.Content})).length)return{v:!1}};for(r.s();!(n=r.n()).done;){var i=a();if("object"===typeof i)return i.v}}catch(o){r.e(o)}finally{r.f()}return!0}function Zt(){return(Zt=Object(w.a)(y.a.mark((function e(t,n,r){var a,i,o,s,l;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=new ct(t.Setup,!0),i=0;case 2:if(!(i<n.Tests.length+10)){e.next=16;break}return o=i<n.Tests.length?n.Tests[i].inputs:n.GetRandomTestInputs(),e.next=6,a.RunInputs(o);case 6:if(s=e.sent,!Kt(l=n.GetTestExpectedOutputs(o),s)){e.next=12;break}r(i),e.next=13;break;case 12:return e.abrupt("return",Promise.resolve({inputs:o,expectedOutputs:l,actualOutputs:s,showingTest:i<n.Tests.length&&n.Tests[i].showing}));case 13:i++,e.next=2;break;case 16:return e.abrupt("return",Promise.resolve(void 0));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Qt=Object(l.b)((function(e){return{Level:Se.GetStore().GetLevel(e.activeLevel.id)}}),{SetLevelComplete:function(e){return{type:"SetLevelCompleteActionType",levelId:e}},SwitchScreen:m,SetCustomTest:function(e){return{type:"SetCustomTestActionType",inputs:e}}})((function(e){var t=Object(a.useState)("Checking"),n=Object(d.a)(t,2),r=n[0],o=n[1],s=Object(a.useState)(0),l=Object(d.a)(s,2),c=l[0],u=l[1],p=Object(a.useState)(void 0),C=Object(d.a)(p,2),v=C[0],m=C[1];return Object(a.useEffect)((function(){var t=f($e());void 0!==t&&function(e,t,n){return Zt.apply(this,arguments)}(t,e.Level,u).then((function(t){void 0===t?(e.SetLevelComplete(e.Level.Id),o("Passed")):(m(t),o("Failed"))})).catch((function(){e.close()}))}),[u,e]),i.a.createElement("div",{style:{width:266}},"Checking"===r&&i.a.createElement(i.a.Fragment,null,"Checking tests",i.a.createElement("br",null),c,"/",e.Level.Tests.length+10," tests passed"),"Passed"===r&&i.a.createElement(i.a.Fragment,null,"All ",e.Level.Tests.length+10," tests have been passed",i.a.createElement("br",null),i.a.createElement("b",{style:{color:"green"}},"Level completed!"),i.a.createElement("br",null),i.a.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",marginTop:10}},i.a.createElement("button",{onClick:e.close,title:"Continue editing this machine"},"Back"),i.a.createElement("button",{onClick:function(){return e.SwitchScreen("levelSelect")},title:"Go to the level select screen"},"Select next level"))),"Failed"===r&&i.a.createElement(i.a.Fragment,null,"The following test failed:",i.a.createElement("div",{style:{backgroundColor:Fe("white",.7),padding:3}},i.a.createElement(Ft,{CanPlay:!1,Test:Object(h.a)(Object(h.a)({},v),{},{id:0,editable:!1,showing:!0}),MultipleInputsEditable:!1,IsSandBoxLevel:!1})),i.a.createElement("div",{style:{display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",marginTop:10}},i.a.createElement("button",{onClick:e.close,title:"Close this screen"},"Close"),!v.showingTest&&i.a.createElement("button",{onClick:function(){return e.SetCustomTest(v.inputs)},title:"Send input to the custom test"},"Examine"))))})),$t=Object(l.b)((function(e){var t=f(e);return{HasActiveMachine:void 0!==t,MachineName:null===t||void 0===t?void 0:t.Style.Name}}),{AddNewMachine:Pt,ClearMessages:function(){return{type:"SetMessagesActionType",messages:[]}},SetMovingOutput:function(e){return{type:"SetMovingOutput",outputChannel:e}},RemoveMachine:function(e){return{type:"MachineRemovedActionType",machineInstanceId:e}},ChangeCellSize:zt})((function(e){var t=Object(a.useState)("none"),n=Object(d.a)(t,2),o=n[0],s=n[1],l=Object(a.useState)(window.innerHeight-1),u=Object(d.a)(l,2),p=u[0],C=u[1],f=Object(a.useState)(window.innerWidth-1),m=Object(d.a)(f,2),g=m[0],b=m[1];Object(a.useEffect)((function(){return document.addEventListener("keyup",S,!1),window.addEventListener("resize",k),function(){document.removeEventListener("keyup",S,!1),window.removeEventListener("resize",k,!1)}}));var y=Object(c.e)({accept:[dt],drop:function(t,n){if(n.isOver())switch(t.type){case dt:e.RemoveMachine(n.getItem().id)}}}),w=Object(d.a)(y,2)[1],O=Object(c.d)((function(t){switch(t.getItemType()){case Ct:var n=t.getItem(),r=Te(t,n.offsetX,n.offsetY);void 0!==r&&e.SetMovingOutput(Object(h.a)({angle:r},n));break;case pt:if(t.isDragging()){var a=t.getClientOffset();if(null!==a){var o=t.getItem();return i.a.createElement(Xt,{machineId:o.id,offset:a})}}}return null}));function S(t){switch(t.key){case" ":ct.StopComputation(),e.ClearMessages(),t.stopPropagation()}}function k(){C(window.innerHeight-1),b(window.innerWidth-1)}var I=[r.Green],M="rgba(255,255,255,.8)";return i.a.createElement("div",{ref:w,style:{position:"absolute",height:p,width:g,overflow:"hidden"}},i.a.createElement("div",{onWheel:function(t){if(e.HasActiveMachine){var n=v($e());e.ChangeCellSize(n-Math.round(.04*t.deltaY)),t.stopPropagation()}},style:{position:"absolute",height:"100%",width:"100%"}},e.HasActiveMachine?i.a.createElement(_t,{WindowHeight:p,WindowWidth:g},i.a.createElement(jt,null)):i.a.createElement("div",{style:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},i.a.createElement("button",{title:"Add new machine",onClick:e.AddNewMachine},"Create new machine"))),i.a.createElement("div",{style:{position:"absolute",left:g/2-150,padding:10,width:300,backgroundColor:M}},i.a.createElement("h2",{style:{textAlign:"center",margin:0}},e.MachineName)),i.a.createElement("div",{style:{position:"absolute",padding:"10px 0px 10px 10px",right:10,width:180,height:p-20,backgroundColor:M}},i.a.createElement("button",{onClick:function(){return s("options")},title:"Options"},"Options"),i.a.createElement(Ut,{height:p-40})),i.a.createElement("div",{style:{position:"absolute",padding:10,left:10,top:10,width:300,backgroundColor:M}},i.a.createElement(Lt,{AllowedInputs:I,Height:p-40,CompleteLevel:function(){return s("checkLevel")}})),i.a.createElement("div",{style:{position:"absolute",padding:"10px 10px 0px 10px",height:65,width:240,left:g/2-150,top:p-65,backgroundColor:M}},i.a.createElement(ut,null)),"none"!==o&&i.a.createElement("div",{onClick:function(){return s("none")},style:{position:"absolute",height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center",background:z.MenuBackGround}},"options"===o&&i.a.createElement(Ht,{Close:function(){return s("none")}}),"checkLevel"===o&&i.a.createElement(Jt,null,i.a.createElement(Qt,{close:function(){return s("none")}}))),O)})),en=function(e){var t=Object(a.useState)(e.name),n=Object(d.a)(t,2),r=n[0],o=n[1];return i.a.createElement("div",{style:{width:200,margin:10}},i.a.createElement("input",{onChange:function(e){return o(e.target.value)},onKeyUp:function(t){switch(t.key){case"Enter":e.close(r)}},value:r}),i.a.createElement("button",{onClick:function(){return e.close(r)}},"OK"),i.a.createElement("button",{onClick:function(){return e.close("")}},"Cancel"))},tn=Object(l.b)((function(e){return{players:e.players.map((function(e){return{name:e.name,id:e.id}}))}}),{ImportPlayerData:function(e){return{type:"ImportPlayerData",data:e}}})((function(e){var t=Object(a.useState)(""),n=Object(d.a)(t,2),r=n[0],o=n[1],s=Object(a.useState)(),l=Object(d.a)(s,2),c=l[0],u=l[1],h=Object(a.useState)("empty"),p=Object(d.a)(h,2),C=p[0],f=p[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,"Only import data from sources you trust!"),i.a.createElement("input",{onChange:function(e){return o(e.target.value)},value:r}),i.a.createElement("p",null,c),i.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},"empty"===C&&i.a.createElement("button",{onClick:function(){if(-1===r.indexOf("(")){var t;try{t=JSON.parse(r)}catch(a){return void u("Data import failed, something is wrong with the data")}if(void 0!==t.name&&void 0!==t.id){var n=e.players.find((function(e){return e.id===t.id}));void 0===n&&u("Import new player with name '".concat(t.name,"'?")),void 0!==n&&(n.name!==t.name?u("Update player '".concat(n.name,"', which will be renamed to '").concat(t.name,"'?")):u("Update player '".concat(n.name,"'?"))),f("loaded")}else u("Data import failed, missing data")}else u("Data blocked")}},"Preload"),"loaded"===C&&i.a.createElement("button",{onClick:function(){e.ImportPlayerData(JSON.parse(r)),e.close()}},"Confirm"),i.a.createElement("button",{onClick:function(){return e.close()}},"Cancel")))})),nn=Object(l.b)((function(e){return{players:e.players.map((function(t){return{name:t.name,id:t.id,active:e.activePlayerId===t.id}}))}}),{ChangePlayerName:function(e,t){return{type:"ChangePlayerName",id:t,name:e}},DeletePlayer:function(e){return{type:"DeletePlayer",id:e}},SwitchPlayer:function(e){return{type:"SwitchPlayer",id:e}},AddPlayer:function(e){return{type:"AddPlayer",name:e}}})((function(e){var t=Object(a.useState)("none"),n=Object(d.a)(t,2),r=n[0],o=n[1],s=Object(a.useState)(""),l=Object(d.a)(s,2),c=l[0],u=l[1],h=Object(a.useState)(""),p=Object(d.a)(h,2),C=p[0],f=p[1],v=Object(a.useState)(""),m=Object(d.a)(v,2),g=m[0],b=m[1],y=Object(a.useState)(""),w=Object(d.a)(y,2),O=w[0],S=w[1];return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{style:{display:"flex",flexDirection:"column",opacity:"none"===r?1:.5}},e.players.map((function(t){return i.a.createElement("div",{style:{display:"flex",flexDirection:"row",border:t.active?"4px solid lime":"4px",padding:t.active?5:9}},i.a.createElement("input",{disabled:"none"!==r,onChange:function(n){return e.ChangePlayerName(n.target.value,t.id)},value:t.name}),i.a.createElement("button",{disabled:t.active||"none"!==r,onClick:function(){return e.SwitchPlayer(t.id)}},"Activate"),i.a.createElement("button",{disabled:"none"!==r,onClick:function(){return e=t.name,n=t.id,o("deletePlayer"),u(e),void f(n);var e,n}},"Delete"),i.a.createElement("button",{disabled:"none"!==r,onClick:function(){return function(e,t){var n=$e().players.find((function(e){return e.id===t}));if(void 0!==n){var r=JSON.stringify(n);-1!==r.indexOf("(")?S("Cannot export data of '".concat(e,"', it contains a '('")):(S("Exporting data of '".concat(e,"', copy data below")),b(r)),o("exportPlayer")}}(t.name,t.id)}},"Export"))})),"none"===r&&i.a.createElement("div",{style:{padding:9,display:"flex",flexDirection:"row",justifyContent:"space-between"}},i.a.createElement("div",null,i.a.createElement("button",{onClick:function(){return o("addPlayer")}},"Add player"),i.a.createElement("button",{onClick:function(){return o("importPlayer")}},"Import player")),i.a.createElement("div",null,i.a.createElement("button",{onClick:e.close},"Done")))),"addPlayer"===r&&i.a.createElement(en,{name:"",close:function(t){""!==t&&e.AddPlayer(t),o("none")}}),"deletePlayer"===r&&i.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},"Delete '",c,"', are you sure?",i.a.createElement("div",null,i.a.createElement("button",{style:{margin:5},onClick:function(){return t=C,o("none"),void e.DeletePlayer(t);var t}},"Delete"),i.a.createElement("button",{style:{margin:5},onClick:function(){return o("none")}},"Cancel"))),"exportPlayer"===r&&i.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},O,i.a.createElement("input",{style:{margin:5},disabled:!0,value:g}),i.a.createElement("div",null,i.a.createElement("button",{style:{margin:5},onClick:function(){navigator.clipboard.writeText(g),o("none")}},"Copy to clipboard"),i.a.createElement("button",{style:{margin:5},onClick:function(){return o("none")}},"Done"))),"importPlayer"===r&&i.a.createElement(tn,{close:function(){return o("none")}}))})),rn=Object(l.b)((function(e){var t=C(e),n=void 0;if(void 0!==(null===t||void 0===t?void 0:t.activeLevel)){var r=t.levelData.find((function(e){return e.Id===t.activeLevel}));(null===r||void 0===r?void 0:r.State)!==Oe.InProgress&&(null===r||void 0===r?void 0:r.State)!==Oe.NonValidMachineUsed||(n=Se.GetStore().GetLevel(t.activeLevel))}return{playerName:null===t||void 0===t?void 0:t.name,continueLevel:n}}),{SwitchScreen:m,LoadLevel:ot})((function(e){var t=Object(a.useState)("none"),n=Object(d.a)(t,2),r=n[0],o=n[1];return i.a.createElement("div",{style:{height:"100%",width:"100%",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"}},i.a.createElement("h1",null,"Contexion"),"none"===r&&i.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"}},i.a.createElement(Jt,null,void 0!==e.continueLevel&&i.a.createElement("button",{className:"startMenu",onClick:function(){return e.LoadLevel(e.continueLevel.Id)}},"Continue with ",e.continueLevel.Name),void 0!==e.playerName&&i.a.createElement(i.a.Fragment,null,i.a.createElement("button",{className:"startMenu",onClick:function(){return e.SwitchScreen("levelSelect")}},"Select level"),i.a.createElement("button",{className:"startMenu",onClick:function(){return e.LoadLevel("12")}},"Sandbox")),i.a.createElement("button",{className:"startMenu",onClick:function(){return o("editPlayers")}},"Manage players")),void 0===e.playerName?i.a.createElement("h4",null,"No player profile, make one to play!"):i.a.createElement("h4",null," Playing as ",e.playerName)),"editPlayers"===r&&i.a.createElement(Jt,null,i.a.createElement(nn,{close:function(){o("none")}})))})),an=Object(l.b)(void 0,{LoadLevel:ot})((function(e){var t,n,r,o,s=Object(a.useState)(void 0!==(null===(t=e.Data)||void 0===t?void 0:t.LastUsedMachineId)||0!==e.Level.Inputs.length),l=Object(d.a)(s,2),c=l[0],u=l[1],h=[];if(void 0===(null===(n=e.Data)||void 0===n?void 0:n.LastUsedMachineId))r="rgb(200,200,200)",o="rgb(160,160,160)";else{var p=it.GetStore().GetMachineType(e.Data.LastUsedMachineId);switch(e.Data.State){case Oe.Completed:r=p.Style.Color,o=p.Style.BorderColor,h=e.Level.OutputChannels.map((function(e){return[e]}));break;case Oe.InProgress:case Oe.NonValidMachineUsed:r=Le(Be(p.Style.Color,.4),.5),o=Le(Be(p.Style.BorderColor,.4),.5);break;case Oe.NoMachineLinked:throw Error("State is not linked, but there is a machine linked")}}var C={Color:r,BorderColor:o};return i.a.createElement("div",{onMouseOver:function(){var t;void 0===(null===(t=e.Data)||void 0===t?void 0:t.LastUsedMachineId)&&0===e.Level.Inputs.length&&u(!0)},onMouseOut:function(){var t;void 0===(null===(t=e.Data)||void 0===t?void 0:t.LastUsedMachineId)&&0===e.Level.Inputs.length&&u(!1)},style:{position:"absolute",marginLeft:140*e.Level.Cell.Column+50,marginTop:115*e.Level.Cell.Row+20}},i.a.createElement("div",{onClick:function(){return e.LoadLevel(e.Level.Id)},title:e.Level.LevelDescription,style:{height:z.CellSize-2,width:z.CellSize-2}},i.a.createElement(Dt,{IsDefault:!1,MachineStyle:C,BackgroundColor:"white",InputChannels:e.Level.Inputs,OutputChannels:h,CellSize:z.CellSize}),c&&i.a.createElement("div",{style:{display:"flex",position:"absolute",height:"20%",width:"100%",justifyContent:"center",alignItems:"center",pointerEvents:"none"}},i.a.createElement("label",{style:{fontFamily:"Comic Sans MS",background:Fe("White",.7)}},e.Level.Name))))})),on=Object(l.b)((function(e){return{levels:C(e).levelData}}),{SwitchScreen:m})((function(e){var t=Object(a.useState)([]),n=Object(d.a)(t,2),o=n[0],s=n[1];return Object(a.useEffect)((function(){var t,n=Se.GetStore().GetAllLevels(),a=n.filter((function(e){return e.Cell.Row>=0})).map((function(t){var n=e.levels.find((function(e){return e.Id===t.Id}));return{model:Object(h.a)(Object(h.a)({},t),{},{Inputs:Object(q.a)(t.InputChannels)}),data:n}})),i=Math.max.apply(Math,Object(q.a)(n.map((function(e){return e.Cell.Column})))),o={NumberOfRows:Math.max.apply(Math,Object(q.a)(n.map((function(e){return e.Cell.Column})))),NumberOfColumns:i},l=a.filter((function(e){var t;return(null===(t=e.data)||void 0===t?void 0:t.State)===Oe.Completed})).map((function(e){return e.model})),c=Object(g.a)(l);try{for(c.s();!(t=c.n()).done;){var u,d=t.value,p=Object(g.a)(d.OutputChannels.map((function(e){return e.Direction})));try{var C=function(){for(var e=u.value,t=Ue(o,d.Cell,e);void 0!==t;){var n=a.find((function(e){return De(e.model.Cell,t)}));if(void 0!==n){n.model.Inputs.push({Channel:r.Green,Direction:e,Status:"Exists",UseMachineColor:!0});break}t=Ue(o,t,e)}};for(p.s();!(u=p.n()).done;)C()}catch(f){p.e(f)}finally{p.f()}}}catch(f){c.e(f)}finally{c.f()}s(a)}),[e.levels]),i.a.createElement("div",{style:{position:"absolute",width:"100%"}},i.a.createElement("button",{style:{position:"fixed",top:10,right:10},onClick:function(){return e.SwitchScreen("startMenu")}},"Back"),o.map((function(e){return i.a.createElement(an,{Level:e.model,Data:e.data,key:e.model.Id})})))})),sn=Object(l.b)((function(e){return{screen:e.screen}}))((function(e){return i.a.createElement(c.b,{backend:u.a},"startMenu"===e.screen&&i.a.createElement(rn,null),"levelSelect"===e.screen&&i.a.createElement(on,null),"playing"===e.screen&&i.a.createElement($t,null))}));n(43);s.a.render(i.a.createElement(l.a,{store:Qe},i.a.createElement(sn,null)),document.getElementById("root"))}},[[44,1,2]]]);
//# sourceMappingURL=main.44594006.chunk.js.map