(window.webpackJsonpdseoefen=window.webpackJsonpdseoefen||[]).push([[0],{22:function(e,t,n){e.exports=n(32)},31:function(e,t,n){},32:function(e,t,n){"use strict";n.r(t);var a,i=n(0),r=n.n(i),o=n(17),l=n.n(o),s=n(10),u=n(20),c=n(9),h=n(2),p=n(3),d=n(7),C=n(5),f=n(4),m=n(6),v=function(e,t){if(-1!==t)for(var n="<"+t+">",a=n.length,i=0,r=e.indexOf(n),o=e.indexOf("*");-1!==r||-1!==o;)-1!==r&&(-1===o||r<o)?(e=e.substring(0,r)+"*"+e.substring(r+a),i=r+1):(e=e.substring(0,o)+n+e.substring(o+1),i=o+a),r=e.indexOf(n,i),o=e.indexOf("*",i);return e};!function(e){e.Green="green",e.Red="red",e.Blue="blue",e.Yellow="yellow"}(a||(a={}));var g,b=function(){function e(){Object(h.a)(this,e),this.actor={Act:function(e){var t=[],n="*"+e.Content;return t.push({Content:n,Channel:a.Green}),t}},this.Id={Id:10,Type:"Default"}}return Object(p.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{BorderColor:"blue",Color:"grey",Name:"Add *",InputChannels:[],OutputChannels:[a.Green],Description:"Puts a star in front of the string. There is guaranteed not to be a star in the input"}}}]),e}(),y=function(){function e(){Object(h.a)(this,e),this.actor={Act:function(e){var t=[],n="0"+e.Content;return t.push({Content:n,Channel:a.Green}),t}},this.Id={Id:11,Type:"Default"}}return Object(p.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{BorderColor:"yellow",Color:"darkorange",Name:"Add 0",InputChannels:[],OutputChannels:[a.Green],Description:"Puts a zero in front of the string"}}}]),e}(),S=function(){function e(){Object(h.a)(this,e),this.actor={Act:function(e){var t=[],n=a.Green;if(e.Content.length<2)n=a.Red;else if("<"!==e.Content[0])e.Content[0]!==e.Content[1]&&(n=a.Red);else{var i=e.Content.indexOf(">"),r=e.Content.substring(0,i+1);if(e.Content.length<2*r.length)n=a.Red;else e.Content.substring(i+1,i+r.length+1)!==r&&(n=a.Red)}return t.push({Content:e.Content,Channel:n}),t}},this.Id={Id:9,Type:"Default"}}return Object(p.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{BorderColor:"red",Color:"green",Name:"Compare",InputChannels:[],OutputChannels:[a.Green,a.Red],Description:"Compares the first two characters in the string. If they are the same, exits green. If they are different exits red"}}}]),e}(),O=function(){function e(){Object(h.a)(this,e),this.actor={Act:function(e){var t,n=[];if(e.Content.length<1)t="";else if("<"!==e.Content[0])t=e.Content[0]+e.Content;else{var i=e.Content.indexOf(">");t=e.Content.substring(0,i+1)+e.Content}return n.push({Content:t,Channel:a.Green}),n}},this.Id={Id:6,Type:"Default"}}return Object(p.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{BorderColor:"green",Color:"yellow",Name:"Copy",InputChannels:[],OutputChannels:[a.Green],Description:"Copies the first character of the string and puts it in front of the string"}}}]),e}(),w=function(){function e(){Object(h.a)(this,e),this.actor={Act:function(e){var t,n=[];if(e.Content.length<1)t="";else if("<"!==e.Content[0])t=e.Content.substring(1);else{var i=e.Content.indexOf(">");t=e.Content.substring(i+1)}return n.push({Content:t,Channel:a.Green}),n}},this.Id={Id:7,Type:"Default"}}return Object(p.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{BorderColor:"red",Color:"red",Name:"Delete",InputChannels:[],OutputChannels:[a.Green],Description:"Deletes the first character of the string"}}}]),e}(),I=function(){function e(){Object(h.a)(this,e),this.actor={Act:function(e){var t=[];return t.push({Content:e.Content,Channel:a.Green}),t}},this.Id={Id:0,Type:"Default"}}return Object(p.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Color:"white",BorderColor:"green",OutputChannels:[a.Green],InputChannels:[],Name:"Start",Description:"Starting point of the computation. Acts as a move machine for all other purposes"}}}]),e}(),G=function(){function e(){Object(h.a)(this,e),this.actor={Act:function(e){var t=[],n="";if(e.Content.length>0){var i=e.Content[0];n=i>="0"&&i<="8"||i>="a"&&i<"z"||i>="A"&&i<"Z"?String.fromCharCode(i.charCodeAt(0)+1)+e.Content.slice(1):"9"===i?"0"+e.Content.slice(1):"z"===i?"a"+e.Content.slice(1):"Z"===i?"A"+e.Content.slice(1):e.Content}return t.push({Content:n,Channel:a.Green}),t}},this.Id={Id:12,Type:"Default"}}return Object(p.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{BorderColor:"DodgerBlue",Color:"MediumVioletRed",Name:"Increment",InputChannels:[],OutputChannels:[a.Green],Description:"Increases a number in front of the string by 1, makes as letter the next letter in the alphabet. 9 becomes 0, z becomes a. All other starting characters are not changed"}}}]),e}(),k=function(){function e(){Object(h.a)(this,e),this.actor={Act:function(e){var t=[];return t.push({Content:e.Content,Channel:a.Green}),t}},this.Id={Id:5,Type:"Default"}}return Object(p.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Color:"green",BorderColor:"lightgreen",OutputChannels:[a.Green],InputChannels:[],Name:"Move",Description:"Does nothing with the string, only used to get the message to the right place"}}}]),e}(),M=function(){function e(){Object(h.a)(this,e),this.actor={Act:function(e){var t=[];return t.push({Content:e.Content,Channel:a.Green}),t}},this.Id={Id:1,Type:"Default"}}return Object(p.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Color:"white",BorderColor:"red",OutputChannels:[a.Green],InputChannels:[],Name:"Start",Description:"Starting point of the computation. Acts as a move machine for all other purposes"}}}]),e}(),E=function(){function e(){Object(h.a)(this,e),this.actor={Act:function(e){var t,n=[];if(e.Content.length<2)t=e.Content;else if("<"!==e.Content[0])t=e.Content.substring(1)+e.Content.substring(0,1);else{var i=e.Content.indexOf(">");t=e.Content.substring(i+1)+e.Content.substring(0,i+1)}return n.push({Content:t,Channel:a.Green}),n}},this.Id={Id:8,Type:"Default"}}return Object(p.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{BorderColor:"blue",Color:"cyan",Name:"Rotate",InputChannels:[],OutputChannels:[a.Green],Description:"Removes the first character of the string, and adds it to the end of the string"}}}]),e}(),x=function(){function e(){Object(h.a)(this,e),this.machines=void 0,this.customId=0,this.machines=[],this.init()}return Object(p.a)(e,[{key:"init",value:function(){this.machines=[],this.machines.push(new I),this.machines.push(new M),this.machines.push(new k),this.machines.push(new O),this.machines.push(new w),this.machines.push(new E),this.machines.push(new S),this.machines.push(new b),this.machines.push(new y),this.machines.push(new G)}},{key:"FindMachine",value:function(e){var t=this.machines.find(function(t){return t.Id.Id===e.Id&&t.Id.Type===e.Type});if(void 0===t)throw new Error("No machine found with id "+e.Id+" and type "+e.Type);return t}},{key:"AddCustomMachine",value:function(e){var t=this;void 0===e.Id?e.Id=this.customId++:e.Id>=this.customId&&(this.customId=e.Id+1),e.Id=void 0!==e.Id?e.Id:this.customId++;var n=JSON.parse(JSON.stringify(e)),a={Id:{Id:n.Id,Type:"Custom"},GetType:function(){return n.MachineType},GetActor:function(){return t.CreateCustomActor(n.Setup)}};return this.machines.push(a),n}},{key:"ReloadCustomMachines",value:function(e){this.machines=this.machines.filter(function(e){return"Default"===e.Id.Type});var t=!0,n=!1,a=void 0;try{for(var i,r=e[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var o=i.value;this.AddCustomMachine(o)}}catch(l){n=!0,a=l}finally{try{t||null==r.return||r.return()}finally{if(n)throw a}}}},{key:"GetActor",value:function(e){return this.FindMachine(e).GetActor()}},{key:"GetMachineType",value:function(e){return this.FindMachine(e).GetType()}},{key:"GetAllMachine",value:function(){return this.machines}},{key:"CreateCustomActor",value:function(e){return{Act:function(t){var n=function(e){var t=e.indexOf("*");if(-1!==t){var n=function(){for(var n=[],a=0;-1!==(a=e.indexOf("<",a));){var i=e.indexOf(">",a),r=e.substring(a+1,i-a-1);n.push(parseInt(r,10)),a=i}for(var o=0;n.some(function(e){return e===o});)o++;var l=e;do{l=l.substring(0,t)+"<"+o+">"+l.substring(t+1),t=l.indexOf("*")}while(-1!==t);return{v:[l,o]}}();if("object"===typeof n)return n.v}return[e,-1]}(t.Content),a=Object(c.a)(n,2),i=a[0],r=a[1],o={Content:i,Channel:t.Channel};return new j(e).RunSetup(o).map(function(e){return{Channel:e.Channel,Content:v(e.Content,r)}})}}}}],[{key:"GetStore",value:function(){return void 0===e.machineStore&&(e.machineStore=new e),e.machineStore}}]),e}();x.machineStore=void 0,function(e){e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Left=2]="Left",e[e.Right=3]="Right"}(g||(g={}));var D,j=function(){function e(t){Object(h.a)(this,e),this.setup=void 0,this.machines=[],this.store=void 0,this.setup=t,this.store=x.GetStore(),this.RunSetup=this.RunSetup.bind(this)}return Object(p.a)(e,[{key:"NewSetup",value:function(e){this.setup=e,this.GetMachines()}},{key:"GetMachines",value:function(){var e=this;this.machines=this.setup.MachineInstances.map(function(t){return{id:t.Id,actor:e.store.GetActor(t.MachineId)}})}},{key:"GetStartMachines",value:function(){var e=[],t=!0,n=!1,a=void 0;try{for(var i,r=this.setup.MachineInstances[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var o=i.value;o.MachineId.Id<4&&"Default"===o.MachineId.Type&&e.push(o)}}catch(l){n=!0,a=l}finally{try{t||null==r.return||r.return()}finally{if(n)throw a}}return e}},{key:"GetStartMachine",value:function(e){var t=0;switch(e){case a.Green:t=0;break;case a.Red:t=1;break;case a.Blue:t=2;break;case a.Yellow:t=3}return this.setup.MachineInstances.find(function(e){return e.MachineId.Id===t&&"Default"===e.MachineId.Type})}},{key:"CalculateExits",value:function(){var e=this,t=[],n=[],a=this.GetStartMachines();n=n.concat(a.map(function(e){return{Cell:e.Cell,Direction:e.Channels[0].Direction}}));for(var i=function(a){for(var i={Direction:n[a].Direction,Cell:{Column:n[a].Cell.Column,Row:n[a].Cell.Row}},r=void 0,o=void 0;void 0===r&&void 0!==(o=e.Move(i.Cell,i.Direction));)i.Cell=o,r=e.setup.MachineInstances.find(function(e){return e.Cell.Column===i.Cell.Column&&e.Cell.Row===i.Cell.Row});if(void 0===o)return t.push(i),"continue";n.some(function(e){return e.Cell.Column===i.Cell.Column&&e.Cell.Row===i.Cell.Row})||(n=n.concat(r.Channels.map(function(e){return{Cell:i.Cell,Direction:e.Direction}})))},r=0;r<n.length;r++)i(r);return t}},{key:"StartComputation",value:function(e){this.GetMachines();var t=[],n=this.GetStartMachine(e.Channel);if(void 0===n)return[];var a=n.Channels[0].Direction,i={Content:e.Content,Direction:a,Cell:n.Cell};return t.push(i),t}},{key:"GetNextMessages",value:function(e){var t=this,n=[],i=!0,r=!1,o=void 0;try{for(var l,s=function(){for(var e=l.value,i=void 0,r=e.Cell;void 0===i&&void 0!==(r=t.Move(r,e.Direction));)i=t.setup.MachineInstances.find(function(e){return e.Cell.Column===r.Column&&e.Cell.Row===r.Row});if(void 0===r)return n.push({Cell:void 0,Direction:e.Direction,Content:e.Content}),"continue";var o=a.Green,s=t.machines.find(function(e){return e.id===i.Id}).actor.Act({Content:e.Content,Channel:o}),u=!0,c=!1,h=void 0;try{for(var p,d=function(){var e=p.value,t=i.Channels.find(function(t){return t.Channel===e.Channel});if(void 0===t)throw Error("Channelmap "+e.Channel+"undefined");var a={Cell:i.Cell,Content:e.Content,Direction:t.Direction};n.push(a)},C=s[Symbol.iterator]();!(u=(p=C.next()).done);u=!0)d()}catch(f){c=!0,h=f}finally{try{u||null==C.return||C.return()}finally{if(c)throw h}}},u=e[Symbol.iterator]();!(i=(l=u.next()).done);i=!0)s()}catch(b){r=!0,o=b}finally{try{i||null==u.return||u.return()}finally{if(r)throw o}}var c=n.filter(function(e){return void 0===e.Cell}),h=[],p=!0,d=!1,C=void 0;try{for(var f,m=c[Symbol.iterator]();!(p=(f=m.next()).done);p=!0){var v=f.value;switch(v.Direction){case g.Up:h.push({Content:v.Content,Channel:a.Green});break;case g.Down:h.push({Content:v.Content,Channel:a.Red});break;case g.Right:h.push({Content:v.Content,Channel:a.Blue});break;case g.Left:h.push({Content:v.Content,Channel:a.Yellow})}}}catch(b){d=!0,C=b}finally{try{p||null==m.return||m.return()}finally{if(d)throw C}}return[n.filter(function(e){return void 0!==e.Cell}),h]}},{key:"RunSetup",value:function(e){for(var t=[],n=this.StartComputation(e);0!==n.length;){var a=this.GetNextMessages(n),i=Object(c.a)(a,2),r=i[0],o=i[1];t=t.concat(o),n=r}return t}},{key:"Move",value:function(e,t){switch(t){case g.Down:if(e.Row===this.setup.NumberOfRows-1)return;return{Column:e.Column,Row:e.Row+1};case g.Up:if(0===e.Row)return;return{Column:e.Column,Row:e.Row-1};case g.Right:if(e.Column===this.setup.NumberOfColumns-1)return;return{Column:e.Column+1,Row:e.Row};case g.Left:if(0===e.Column)return;return{Column:e.Column-1,Row:e.Row}}}}]),e}(),T=function(){return void 0===D&&(D=A()),D},A=function(){return{ActiveSetup:{NumberOfColumns:6,NumberOfRows:5,MachineInstances:[{Cell:{Row:2,Column:0},MachineId:{Id:0,Type:"Default"},Channels:[{Direction:g.Right,Channel:a.Green}],InputChannels:[],Id:1}]},SavedMachines:[]}},N={AllowedMachines:[],Description:"Sandbox level, no specific goals",Name:"Sandbox",Tests:[]},R=function(e){var t={marginLeft:5,marginRight:5};return r.a.createElement("div",null,r.a.createElement("button",{style:t,onClick:function(){e.valueChanged(e.value-1)}},"-"),r.a.createElement("label",null,e.value),r.a.createElement("button",{style:t,onClick:function(){e.valueChanged(e.value+1)}},"+"))},L=function(e){return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("label",{title:"Show animations, will calculate as fast as possible when turned of"},"Show animations"),r.a.createElement("button",{onClick:function(){e.OnShowAnimationsChanged(!e.ShowAnimations)}},e.ShowAnimations?"On":"Off")),e.ShowAnimations&&r.a.createElement("div",null,r.a.createElement("label",{title:"Step time in tenths of seconds, lower for faster animations"},"Step Time"),r.a.createElement(R,{value:e.StepTime,valueChanged:e.OnStepTimeChanged})))},B=n(21),P=function e(){Object(h.a)(this,e)};P.CellSize=100;var z,F="MachineInstance",U="NewMachine",J=function(e){var t;if(""===e)t="<Empty>";else{t=e;for(var n=0;-1!==(n=t.indexOf("<",n));){var a=t.indexOf(">",n);t=t.substring(0,n)+"?"+t.substring(a+1)}}return t},K=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(d.a)(this,Object(C.a)(t).call(this,e))).onClicked=n.onClicked.bind(Object(f.a)(n)),n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=P.CellSize-2,t={position:"absolute",height:e/50*4,width:e/50*19,marginLeft:e/50*27.5,marginTop:e/50*22.5,backgroundColor:this.props.ChannelMap.Channel,borderStyle:"solid",borderWidth:"1px",pointerEvents:"visible"},n="";switch(this.props.ChannelMap.Direction){case g.Down:n="rotate(90deg)";break;case g.Left:n="rotate(180deg)";break;case g.Up:n="rotate(270deg)";break;case g.Right:n="rotate(0deg)"}var a={transform:n,height:e,width:e,position:"absolute",pointerEvents:"none"};return r.a.createElement("div",{style:a},r.a.createElement("div",{style:t,onClick:this.onClicked}))}},{key:"onClicked",value:function(e){if(void 0!==this.props.OnChanged){var t=g.Left;switch(this.props.ChannelMap.Direction){case g.Down:t=g.Left;break;case g.Left:t=g.Up;break;case g.Up:t=g.Right;break;case g.Right:t=g.Down}this.props.OnChanged({Direction:t,Channel:this.props.ChannelMap.Channel})}}}]),t}(r.a.Component),Y=function(e){function t(){return Object(h.a)(this,t),Object(d.a)(this,Object(C.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=P.CellSize/5*3,t=e/10,n={height:this.props.IsDefault?e:.9*e,width:this.props.IsDefault?e:.9*e,backgroundColor:this.props.Machine.Color,borderStyle:"solid",borderColor:this.props.Machine.BorderColor,borderWidth:t,borderRadius:this.props.IsDefault?"50%":"0%"};return r.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:P.CellSize-2,width:P.CellSize-2}},r.a.createElement("div",{style:n}))}}]),t}(r.a.Component),W=function(e){var t=Object(s.c)({item:{type:F,id:e.MachineInstance.Id},end:function(t,n){n.didDrop()||e.OnRemoved(e.MachineInstance.Id)},collect:function(e){return{isDragging:!!e.isDragging()}}}),n=Object(c.a)(t,2)[1],a=e.MachineInstance.Channels.map(function(t,n){return r.a.createElement("div",{key:n},r.a.createElement(K,{OnChanged:function(t){return function(t,n){var a={Cell:e.MachineInstance.Cell,MachineId:e.MachineInstance.MachineId,Channels:e.MachineInstance.Channels.map(function(e,a){return a===n?t:e}),InputChannels:e.MachineInstance.InputChannels,Id:e.MachineInstance.Id};e.OnChanged(a)}(t,n)},ChannelMap:t}))}),i={height:P.CellSize-2,width:P.CellSize-2,margin:1},o=x.GetStore().GetMachineType(e.MachineInstance.MachineId);return r.a.createElement("div",{ref:n,style:i},r.a.createElement("div",{style:{position:"absolute"}},r.a.createElement(Y,{Machine:o,IsDefault:"Default"===e.MachineInstance.MachineId.Type})),a)},H=function(e){var t,n=Object(s.d)({accept:[F,U],drop:function(t,n){switch(t.type){case F:e.OnMovedMachine(n.getItem().id,e.location);break;case U:var a=n.getItem();e.OnNewMachine(a.id,e.location)}}}),a=Object(c.a)(n,2)[1],i={height:P.CellSize,width:P.CellSize,border:"1px solid #999",float:"left",marginTop:-1,marginLeft:-1,position:"relative"};if(void 0!==e.exitCell)switch(e.exitCell.Direction){case g.Up:i.borderRight="1px solid black",i.borderBottom="1px solid black",i.borderLeft="1px solid black",i.borderTop="8px solid green",i.marginTop=-8;break;case g.Down:i.borderRight="1px solid black",i.borderTop="1px solid black",i.borderLeft="1px solid black",i.borderBottom="8px solid red",i.marginBottom=-7;break;case g.Right:i.borderTop="1px solid black",i.borderBottom="1px solid black",i.borderLeft="1px solid black",i.borderRight="8px solid blue",i.marginRight=-7;break;case g.Left:i.borderRight="1px solid black",i.borderBottom="1px solid black",i.borderTop="1px solid black",i.borderLeft="8px solid yellow",i.marginLeft=-8}else i.borderRight="1px solid black",i.borderBottom="1px solid black",i.borderLeft="1px solid black",i.borderTop="1px solid black";return void 0!==e.message&&(t=J(e.message.Content)),r.a.createElement("div",{style:i,ref:a},void 0!==t&&t,void 0!==e.machineInstance?r.a.createElement(W,{MachineInstance:e.machineInstance,OnChanged:e.OnChanged,OnRemoved:e.OnMachineRemoved}):"")},Z=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(d.a)(this,Object(C.a)(t).call(this,e))).store=void 0,n.ChannelChanged=n.ChannelChanged.bind(Object(f.a)(n)),n.MachineMoved=n.MachineMoved.bind(Object(f.a)(n)),n.MachineAdded=n.MachineAdded.bind(Object(f.a)(n)),n.MachineRemoved=n.MachineRemoved.bind(Object(f.a)(n)),n.store=x.GetStore(),n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){for(var e=[],t=0;t<this.props.GridSetup.NumberOfRows;t++){for(var n=[],a=0;a<this.props.GridSetup.NumberOfColumns;a++){var i=void 0,o=void 0,l=void 0,s=!0,u=!1,c=void 0;try{for(var h,p=this.props.GridSetup.MachineInstances[Symbol.iterator]();!(s=(h=p.next()).done);s=!0){var d=h.value;d.Cell.Column===a&&d.Cell.Row===t&&(i=d)}}catch(k){u=!0,c=k}finally{try{s||null==p.return||p.return()}finally{if(u)throw c}}var C=!0,f=!1,m=void 0;try{for(var v,g=this.props.Messages[Symbol.iterator]();!(C=(v=g.next()).done);C=!0){var b=v.value;b.Cell.Column===a&&b.Cell.Row===t&&(o=b)}}catch(k){f=!0,m=k}finally{try{C||null==g.return||g.return()}finally{if(f)throw m}}var y=!0,S=!1,O=void 0;try{for(var w,I=this.props.ExitCells[Symbol.iterator]();!(y=(w=I.next()).done);y=!0){var G=w.value;G.Cell.Column===a&&G.Cell.Row===t&&(l=G)}}catch(k){S=!0,O=k}finally{try{y||null==I.return||I.return()}finally{if(S)throw O}}n.push(r.a.createElement(H,{key:a,machineInstance:i,message:o,OnChanged:this.ChannelChanged,OnMovedMachine:this.MachineMoved,OnNewMachine:this.MachineAdded,OnMachineRemoved:this.MachineRemoved,location:{Row:t,Column:a},exitCell:l}))}e.push(r.a.createElement("div",{key:t,style:{display:"flex",flexDirection:"row"}},n))}return r.a.createElement("div",{style:{display:"flex",flexDirection:"column",marginBottom:8}},e)}},{key:"ChannelChanged",value:function(e){var t={NumberOfColumns:this.props.GridSetup.NumberOfColumns,NumberOfRows:this.props.GridSetup.NumberOfRows,MachineInstances:this.props.GridSetup.MachineInstances.map(function(t){return t.Cell.Column===e.Cell.Column&&t.Cell.Row===e.Cell.Row?e:t})};this.props.OnChanged(t)}},{key:"MachineMoved",value:function(e,t){var n=this.props.GridSetup.MachineInstances.findIndex(function(t){return t.Id===e});this.props.GridSetup.MachineInstances[n].Cell=t,this.props.OnChanged(this.props.GridSetup)}},{key:"MachineRemoved",value:function(e){this.props.GridSetup.MachineInstances=this.props.GridSetup.MachineInstances.filter(function(t){return t.Id!==e}),this.props.OnChanged(this.props.GridSetup)}},{key:"MachineAdded",value:function(e,t){var n=this.store.GetMachineType(e),a=[],i=g.Up,r=!0,o=!1,l=void 0;try{for(var s,u=n.OutputChannels[Symbol.iterator]();!(r=(s=u.next()).done);r=!0){var c=s.value;a.push({Channel:c,Direction:i}),i++}}catch(p){o=!0,l=p}finally{try{r||null==u.return||u.return()}finally{if(o)throw l}}var h={Cell:t,MachineId:e,Channels:a,InputChannels:[],Id:(0===this.props.GridSetup.MachineInstances.length?0:Math.max.apply(Math,Object(B.a)(this.props.GridSetup.MachineInstances.map(function(e){return e.Id}))))+1};this.props.GridSetup.MachineInstances.push(h),this.props.OnChanged(this.props.GridSetup)}}]),t}(r.a.Component);!function(e){e[e.NotChecked=0]="NotChecked",e[e.NotFullfilled=1]="NotFullfilled",e[e.Fullfilled=2]="Fullfilled",e[e.NotMatched=3]="NotMatched"}(z||(z={}));var V=function(e){var t={display:"flex",flexFlow:"row",justifyContent:e.Input?"flex-start":"flex-end",marginBottom:1},n={backgroundColor:e.Message.Channel,width:8,marginLeft:5,marginRight:5},a={display:"flex",flexFlow:"row"};switch(e.Status){case z.Fullfilled:a.backgroundColor="#d9ffb3";break;case z.NotMatched:a.border="solid red",a.backgroundColor="#ffb3b3"}return r.a.createElement("div",{style:t},r.a.createElement("div",{style:a},e.Input&&r.a.createElement("div",{style:n}),r.a.createElement("label",null,J(e.Message.Content)),!e.Input&&r.a.createElement("div",{style:n})))},q=function(e){return r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},e.AllowedInputColors.length>1?r.a.createElement("select",{value:e.Message.Channel,style:{backgroundColor:e.Message.Channel},onChange:function(t){e.MessageChanged({Content:e.Message.Content,Channel:t.target.value})}},e.AllowedInputColors.map(function(e,t){return r.a.createElement("option",{value:e,key:t,style:{backgroundColor:e}})})):r.a.createElement("div",{style:{backgroundColor:e.Message.Channel,width:10}}),r.a.createElement("input",{value:e.Message.Content,onChange:function(t){e.MessageChanged({Content:t.target.value,Channel:e.Message.Channel})}}))},Q=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(d.a)(this,Object(C.a)(t).call(this,e))).InputChanged=n.InputChanged.bind(Object(f.a)(n)),n.AddInput=n.AddInput.bind(Object(f.a)(n)),n.DeleteInput=n.DeleteInput.bind(Object(f.a)(n)),n.Play=n.Play.bind(Object(f.a)(n)),n.state={Inputs:[{Content:"",Channel:a.Green}],Outputs:[]},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"InputChanged",value:function(e,t){var n=this.state.Inputs;n[e]=t,this.setState({Inputs:n})}},{key:"AddInput",value:function(){var e={Channel:a.Green,Content:""},t=this.state.Inputs;t.push(e),this.setState({Inputs:t})}},{key:"DeleteInput",value:function(e){var t=this.state.Inputs;t.splice(e,1),this.setState({Inputs:t})}},{key:"Play",value:function(){var e=this;this.props.PlayTest(this.state.Inputs).then(function(t){e.setState({Outputs:t})}).catch(function(){e.setState({Outputs:[]})})}},{key:"render",value:function(){for(var e=this,t=[],n=0,a=function(a){t.push(r.a.createElement("div",{key:n++},r.a.createElement(q,{Message:e.state.Inputs[a],AllowedInputColors:e.props.AllowedInputColors,MessageChanged:function(t){return e.InputChanged(a,t)}}),e.state.Inputs.length>1&&r.a.createElement("button",{onClick:function(){return e.DeleteInput(a)}},"Delete")));var i;i=e.state.Outputs.filter(function(e){return e.Order===a}).map(function(e,t){return r.a.createElement(V,{Message:e,Input:!1,key:n++,Status:z.NotChecked})}),t=t.concat(i)},i=0;i<this.state.Inputs.length;i++)a(i);return r.a.createElement("div",null,r.a.createElement("button",{onClick:this.Play},"Play"),r.a.createElement("div",null,t,this.props.MultipleInputs&&r.a.createElement("button",{onClick:this.AddInput},"Add input")))}}]),t}(r.a.Component),X=function(e){for(var t=e.Test.inputs,n=e.Test.outputs,a=[],i=0,o=function(o){a.push(r.a.createElement(V,{Message:t[o],Input:!0,key:i++,Status:z.NotChecked}));var l=n.filter(function(e){return e.Order===o}),s=void 0;void 0!==e.ActualOutputs&&(s=e.ActualOutputs.filter(function(e){return e.Order===o}));for(var u=function(e){var t=l[e],n=z.NotChecked;if(void 0!==s){var o=s.findIndex(function(e){return e.Channel===t.Channel&&e.Content===t.Content});o>-1?(n=z.Fullfilled,s.splice(o,1)):n=z.NotFullfilled}a=a.concat(r.a.createElement(V,{Message:l[e],Input:!1,key:i++,Status:n}))},c=0;c<l.length;c++)u(c);void 0!==s&&(a=a.concat(s.map(function(e){return r.a.createElement(V,{Message:e,Input:!1,key:i++,Status:z.NotMatched})})))},l=0;l<t.length;l++)o(l);return r.a.createElement("div",{style:{display:"flex",flexDirection:"row",padding:0,borderBottom:"solid 0.5px",margin:5}},r.a.createElement("button",{onClick:function(){e.OnPlay(e.Test)}},"Play"),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",flexGrow:1}},a))},$=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(d.a)(this,Object(C.a)(t).call(this,e))).testStarted=n.testStarted.bind(Object(f.a)(n)),n.state={ActualOutputs:[]},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"testStarted",value:function(e,t){var n=this;this.props.PlayTest(e.inputs).then(function(e){var a=n.state.ActualOutputs;a[t]=e,n.setState({ActualOutputs:a})}).catch(function(){n.setState({ActualOutputs:[]})})}},{key:"render",value:function(){var e=this,t=this.props.Level.Tests.map(function(t,n){return r.a.createElement(X,{Test:t,OnPlay:function(t){return e.testStarted(t,n)},key:n,ActualOutputs:e.state.ActualOutputs[n]})});return r.a.createElement("div",{style:{padding:10}},r.a.createElement("b",null,this.props.Level.Name),r.a.createElement("br",null),r.a.createElement("i",null,this.props.Level.Description),0===this.props.Level.Tests.length&&r.a.createElement(Q,{PlayTest:this.props.PlayTest,AllowedInputColors:this.props.AllowedInputs,MultipleInputs:this.props.MultipleInputsAllowed}),t)}}]),t}(r.a.Component),_=function(e){return r.a.createElement("div",{onClick:function(){return e.LevelClicked(e.Level)}},r.a.createElement("label",{title:e.Level.Description},e.Level.Name))},ee={AllowedMachines:[1,5,6,7,8,9,10,11,12],Description:"The machine should append the length of the input string to the string",Name:"AppendLength",Tests:[{inputs:[{Channel:a.Green,Content:"four"}],outputs:[{Order:0,Channel:a.Green,Content:"four4"}]},{inputs:[{Channel:a.Green,Content:"aabccd"}],outputs:[{Order:0,Channel:a.Green,Content:"aabccd6"}]},{inputs:[{Channel:a.Green,Content:"1"}],outputs:[{Order:0,Channel:a.Green,Content:"11"}]},{inputs:[{Channel:a.Green,Content:""}],outputs:[{Order:0,Channel:a.Green,Content:"0"}]},{inputs:[{Channel:a.Green,Content:"This is hard"}],outputs:[{Order:0,Channel:a.Green,Content:"This is hard12"}]},{inputs:[{Channel:a.Green,Content:"This might even be harder"}],outputs:[{Order:0,Channel:a.Green,Content:"This might even be harder25"}]}]},te={AllowedMachines:[1,5,6,7,8,9,10,11,12],Description:"The machine should return the length of the input string",Name:"GetLength",Tests:[{inputs:[{Channel:a.Green,Content:"four"}],outputs:[{Order:0,Channel:a.Green,Content:"4"}]},{inputs:[{Channel:a.Green,Content:"aabccd"}],outputs:[{Order:0,Channel:a.Green,Content:"6"}]},{inputs:[{Channel:a.Green,Content:"1"}],outputs:[{Order:0,Channel:a.Green,Content:"1"}]},{inputs:[{Channel:a.Green,Content:""}],outputs:[{Order:0,Channel:a.Green,Content:"0"}]},{inputs:[{Channel:a.Green,Content:"This is hard"}],outputs:[{Order:0,Channel:a.Green,Content:"12"}]},{inputs:[{Channel:a.Green,Content:"This might even be harder"}],outputs:[{Order:0,Channel:a.Green,Content:"25"}]}]},ne={AllowedMachines:[1,5,6,7,8,9,10,11,12],Description:"The machine should exit green is the first character is a number, exit red if it is a letter and exit blue otherwise",Name:"GetType",Tests:[{inputs:[{Channel:a.Green,Content:"42"}],outputs:[{Order:0,Channel:a.Green,Content:"42"}]},{inputs:[{Channel:a.Green,Content:"this starts with a letter"}],outputs:[{Order:0,Channel:a.Red,Content:"this starts with a letter"}]},{inputs:[{Channel:a.Green,Content:",#@%!"}],outputs:[{Order:0,Channel:a.Blue,Content:",#@%!"}]},{inputs:[{Channel:a.Green,Content:""}],outputs:[{Order:0,Channel:a.Blue,Content:""}]}]},ae={AllowedMachines:[1,5,6,7,8,9,10],Description:"The machine should exit green if the message is empty, otherwise exit red",Name:"IsEmpty",Tests:[{inputs:[{Channel:a.Green,Content:""}],outputs:[{Order:0,Channel:a.Green,Content:""}]},{inputs:[{Channel:a.Green,Content:"abc"}],outputs:[{Order:0,Channel:a.Red,Content:"abc"}]}]},ie={AllowedMachines:[1,5,6,7,8,9,10,11,12],Description:"The machine should keep all numbers in the input string, and remove all other characters",Name:"KeepNumbers",Tests:[{inputs:[{Channel:a.Green,Content:"42"}],outputs:[{Order:0,Channel:a.Green,Content:"42"}]},{inputs:[{Channel:a.Green,Content:"fortytwo"}],outputs:[{Order:0,Channel:a.Green,Content:""}]},{inputs:[{Channel:a.Green,Content:""}],outputs:[{Order:0,Channel:a.Green,Content:""}]},{inputs:[{Channel:a.Green,Content:"1 and 1 is"}],outputs:[{Order:0,Channel:a.Green,Content:"11"}]}]},re={AllowedMachines:[1,5,6,7,8,9,10,11,12],Description:"The machine should increase the input number by 1. Input only contains digits",Name:"PlusOne",Tests:[{inputs:[{Channel:a.Green,Content:"4"}],outputs:[{Order:0,Channel:a.Green,Content:"5"}]},{inputs:[{Channel:a.Green,Content:"0"}],outputs:[{Order:0,Channel:a.Green,Content:"1"}]},{inputs:[{Channel:a.Green,Content:"42"}],outputs:[{Order:0,Channel:a.Green,Content:"43"}]},{inputs:[{Channel:a.Green,Content:"9"}],outputs:[{Order:0,Channel:a.Green,Content:"10"}]},{inputs:[{Channel:a.Green,Content:"39"}],outputs:[{Order:0,Channel:a.Green,Content:"40"}]},{inputs:[{Channel:a.Green,Content:"23999999"}],outputs:[{Order:0,Channel:a.Green,Content:"24000000"}]}]},oe={AllowedMachines:[1,5,6,7,8,9,10],Description:"The machine should remove all repeating characters from the input string",Name:"RemoveAllRepeats",Tests:[{inputs:[{Channel:a.Green,Content:"aabc"}],outputs:[{Order:0,Channel:a.Green,Content:"abc"}]},{inputs:[{Channel:a.Green,Content:"aaaabccc"}],outputs:[{Order:0,Channel:a.Green,Content:"abc"}]},{inputs:[{Channel:a.Green,Content:""}],outputs:[{Order:0,Channel:a.Green,Content:""}]},{inputs:[{Channel:a.Green,Content:"a"}],outputs:[{Order:0,Channel:a.Green,Content:"a"}]},{inputs:[{Channel:a.Green,Content:"hhhhhhhhhiiiii wwwworllllldddddddd"}],outputs:[{Order:0,Channel:a.Green,Content:"hi world"}]}]},le={AllowedMachines:[1,5,6,7,8,9,10,11,12],Description:"The machine should put the last character in front of the string",Name:"RotateBackwards",Tests:[{inputs:[{Channel:a.Green,Content:"abc"}],outputs:[{Order:0,Channel:a.Green,Content:"cab"}]},{inputs:[{Channel:a.Green,Content:"otater"}],outputs:[{Order:0,Channel:a.Green,Content:"rotate"}]},{inputs:[{Channel:a.Green,Content:"a"}],outputs:[{Order:0,Channel:a.Green,Content:"a"}]},{inputs:[{Channel:a.Green,Content:""}],outputs:[{Order:0,Channel:a.Green,Content:""}]},{inputs:[{Channel:a.Green,Content:"ello world!H"}],outputs:[{Order:0,Channel:a.Green,Content:"Hello world!"}]}]},se=function(){function e(){Object(h.a)(this,e),this.levels=void 0,this.levels=[],this.init()}return Object(p.a)(e,[{key:"init",value:function(){this.levels.push(N),this.levels.push(ae),this.levels.push(oe),this.levels.push(ne),this.levels.push(ie),this.levels.push(te),this.levels.push(ee),this.levels.push(le),this.levels.push(re)}},{key:"GetAllLevels",value:function(){return this.levels}}],[{key:"GetStore",value:function(){return void 0===e.levelStore&&(e.levelStore=new e),e.levelStore}}]),e}();se.levelStore=void 0;var ue=function(e){var t=se.GetStore().GetAllLevels().map(function(t,n){return r.a.createElement(_,{Level:t,LevelClicked:e.OnLevelClicked,key:n})});return r.a.createElement("div",null,r.a.createElement("b",null,"Challenges:"),t)},ce=function(e){var t=[],n=g.Up,a=!0,i=!1,o=void 0;try{for(var l,s=e.machineType.OutputChannels[Symbol.iterator]();!(a=(l=s.next()).done);a=!0){var u=l.value;t.push({Channel:u,Direction:n}),n++}}catch(d){i=!0,o=d}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}var c=t.map(function(e,t){return r.a.createElement(K,{key:t,ChannelMap:e})}),h={position:"absolute",left:P.CellSize/3},p={height:P.CellSize,width:P.CellSize,position:"relative"};return r.a.createElement("div",{style:p},r.a.createElement("div",{style:h},r.a.createElement(Y,{Machine:e.machineType,IsDefault:e.IsDefault})),r.a.createElement("div",{style:h},c),r.a.createElement("label",{style:{position:"absolute"}},e.machineType.Name))},he=function(e){var t=Object(s.c)({item:{type:U,id:e.machine.Id},collect:function(e){return{isDragging:!!e.isDragging()}}}),n=Object(c.a)(t,2)[1],a=e.machine.GetType(),i=[],o=g.Up,l=!0,u=!1,h=void 0;try{for(var p,d=a.OutputChannels[Symbol.iterator]();!(l=(p=d.next()).done);l=!0){var C=p.value;i.push({Channel:C,Direction:o}),o++}}catch(f){u=!0,h=f}finally{try{l||null==d.return||d.return()}finally{if(u)throw h}}return r.a.createElement("div",{ref:n,title:a.Description},r.a.createElement(ce,{machineType:a,IsDefault:"Default"===e.machine.Id.Type}))},pe=function(e){var t={position:"relative",height:P.CellSize,width:P.CellSize},n=e.allowedMachines.map(function(e,n){return r.a.createElement("div",{style:t,key:n},r.a.createElement(he,{machine:e}))});return r.a.createElement("div",{style:{display:"flex",flexFlow:"column wrap",height:8*P.CellSize}},n)},de=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(d.a)(this,Object(C.a)(t).call(this,e))).onSaveClicked=n.onSaveClicked.bind(Object(f.a)(n)),n.nameChanged=n.nameChanged.bind(Object(f.a)(n)),n.descriptionChanged=n.descriptionChanged.bind(Object(f.a)(n)),n.colorChanged=n.colorChanged.bind(Object(f.a)(n)),n.borderColorChanged=n.borderColorChanged.bind(Object(f.a)(n)),n.confirm=n.confirm.bind(Object(f.a)(n)),n.state={Saving:!1,Name:"",Description:"",Color:"Yellow",BorderColor:"Blue"},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"onSaveClicked",value:function(){this.setState({Saving:!this.state.Saving})}},{key:"nameChanged",value:function(e){this.setState({Name:e.target.value})}},{key:"descriptionChanged",value:function(e){this.setState({Description:e.target.value})}},{key:"colorChanged",value:function(e){this.setState({Color:e.target.value})}},{key:"borderColorChanged",value:function(e){this.setState({BorderColor:e.target.value})}},{key:"confirm",value:function(){var e=this.getMachineType();this.props.SaveCustomMachine(e),this.setState({Saving:!1})}},{key:"getMachineType",value:function(){var e=[];return this.props.ExitCells.some(function(e){return e.Direction===g.Up})&&e.push(a.Green),this.props.ExitCells.some(function(e){return e.Direction===g.Down})&&e.push(a.Red),this.props.ExitCells.some(function(e){return e.Direction===g.Right})&&e.push(a.Blue),this.props.ExitCells.some(function(e){return e.Direction===g.Left})&&e.push(a.Yellow),{Name:this.state.Name,Description:this.state.Description,Color:this.state.Color,BorderColor:this.state.BorderColor,OutputChannels:e,InputChannels:[]}}},{key:"render",value:function(){var e;return this.state.Saving&&(e=this.getMachineType()),r.a.createElement("div",null,r.a.createElement("button",{onClick:this.onSaveClicked},this.state.Saving?"Cancel":"Save Machine"),this.state.Saving&&r.a.createElement("div",null,r.a.createElement("label",null,"Name"),r.a.createElement("input",{onChange:this.nameChanged,value:this.state.Name}),r.a.createElement("label",null,"Description"),r.a.createElement("input",{onChange:this.descriptionChanged,value:this.state.Description}),r.a.createElement("label",null,"Color"),r.a.createElement("input",{onChange:this.colorChanged,value:this.state.Color}),r.a.createElement("label",null,"BorderColor"),r.a.createElement("input",{onChange:this.borderColorChanged,value:this.state.BorderColor}),r.a.createElement(ce,{machineType:e,IsDefault:!1}),r.a.createElement("button",{onClick:this.confirm},"Confirm")))}}]),t}(r.a.Component),Ce=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(d.a)(this,Object(C.a)(t).call(this,e))).showItem=n.showItem.bind(Object(f.a)(n)),n.state={Showing:!1},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"showItem",value:function(){this.setState({Showing:!this.state.Showing})}},{key:"render",value:function(){return r.a.createElement("div",{style:{marginLeft:10}},r.a.createElement("button",{onClick:this.showItem},this.state.Showing?"Hide "+this.props.ItemName:"Show "+this.props.ItemName),this.state.Showing&&r.a.createElement("div",{style:{borderLeft:"solid 0.5px",marginLeft:10,padding:10}},this.props.children))}}]),t}(r.a.Component),fe=function(e){return r.a.createElement("div",null,r.a.createElement("label",null,"Rows:"),r.a.createElement(R,{value:e.Setup.NumberOfRows,valueChanged:function(t){var n={NumberOfColumns:e.Setup.NumberOfColumns,NumberOfRows:t,MachineInstances:e.Setup.MachineInstances};e.OnSetupChanged(n)}}),r.a.createElement("label",null,"Columns:"),r.a.createElement(R,{value:e.Setup.NumberOfColumns,valueChanged:function(t){var n={NumberOfColumns:t,NumberOfRows:e.Setup.NumberOfRows,MachineInstances:e.Setup.MachineInstances};e.OnSetupChanged(n)}}))},me=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(d.a)(this,Object(C.a)(t).call(this,e))).ShowSetupString=n.ShowSetupString.bind(Object(f.a)(n)),n.LoadSetup=n.LoadSetup.bind(Object(f.a)(n)),n.SetupStringChanged=n.SetupStringChanged.bind(Object(f.a)(n)),n.state={SetupString:"",NewSetupString:""},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e={display:"flex",flexDirection:"column"};return r.a.createElement("div",{style:{display:"flex",flexFlow:"column wrap"}},r.a.createElement("div",{style:e},r.a.createElement("button",{title:"Show setup string, copy it so you can later restore your setup",onClick:this.ShowSetupString},"Show setup string"),this.props.ShowSetup&&r.a.createElement("input",{value:this.state.SetupString,readOnly:!0})),r.a.createElement("div",{style:e},r.a.createElement("label",null,"Load Setup"),r.a.createElement("input",{value:this.state.NewSetupString,onChange:this.SetupStringChanged}),""!==this.state.NewSetupString&&r.a.createElement("button",{title:"Load Setup, after having pasted a setup above, click to load this setup",onClick:this.LoadSetup},"Load setup")))}},{key:"SetupStringChanged",value:function(e){this.setState({NewSetupString:e.target.value})}},{key:"ShowSetupString",value:function(){this.setState({SetupString:JSON.stringify(this.props.Setup)}),this.props.OnShowingSetup()}},{key:"LoadSetup",value:function(){var e=JSON.parse(this.state.NewSetupString);void 0!==e&&(this.props.OnDataChanged(e),this.setState({NewSetupString:""}))}}]),t}(r.a.Component),ve=function(e){function t(){return Object(h.a)(this,t),Object(d.a)(this,Object(C.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(me,{Setup:this.props.Setup,OnDataChanged:this.props.OnDataChanged,OnShowingSetup:this.props.OnShowingSetup,ShowSetup:this.props.ShowSetup}),r.a.createElement(fe,{Setup:this.props.Setup.ActiveSetup,OnSetupChanged:this.props.OnSetupChanged})))}}]),t}(r.a.Component),ge=function(e){function t(e){var n;Object(h.a)(this,t),(n=Object(d.a)(this,Object(C.a)(t).call(this,e))).computer=void 0,n.inputs=[],n.outputs=[],n.gameData=void 0,n.cancelComputation=void 0,n.machineStore=void 0,n.inputChanged=n.inputChanged.bind(Object(f.a)(n)),n.startComputation=n.startComputation.bind(Object(f.a)(n)),n.CalculateNextMessages=n.CalculateNextMessages.bind(Object(f.a)(n)),n.GridSetupChanged=n.GridSetupChanged.bind(Object(f.a)(n)),n.NewGameDataLoaded=n.NewGameDataLoaded.bind(Object(f.a)(n)),n.StepTimeChanged=n.StepTimeChanged.bind(Object(f.a)(n)),n.OnShowingSetup=n.OnShowingSetup.bind(Object(f.a)(n)),n.stopComputation=n.stopComputation.bind(Object(f.a)(n)),n.handleKeyPress=n.handleKeyPress.bind(Object(f.a)(n)),n.LevelSelected=n.LevelSelected.bind(Object(f.a)(n)),n.PlayTest=n.PlayTest.bind(Object(f.a)(n)),n.SaveCustomMachine=n.SaveCustomMachine.bind(Object(f.a)(n)),n.gameData=T();var a=n.gameData.ActiveSetup;return n.computer=new j(a),n.machineStore=x.GetStore(),n.state={Computing:!1,Messages:[],GridSetup:a,CustomInput:"",StepTime:6,ShowingSetup:!1,SelectedLevel:N,ExitCells:[{Cell:{Column:5,Row:2},Direction:g.Right}],Machines:n.machineStore.GetAllMachine(),ShowAnimations:!0},n}return Object(m.a)(t,e),Object(p.a)(t,[{key:"inputChanged",value:function(e){var t=e.target.value;t=(t=(t=t.replace("*","")).replace("<","")).replace(">",""),this.setState({CustomInput:t})}},{key:"startComputation",value:function(){var e=this;return new Promise(function(t,n){e.stopComputation().then(function(){return e.outputs=[],e.handleNextInput(0).then(t).catch(n)})})}},{key:"handleNextInput",value:function(e){var t=this;if(this.inputs.length<=e)return this.setState({Computing:!1}),new Promise(function(e){e(t.outputs),t.cancelComputation=void 0});if(this.state.ShowAnimations){var n=this.computer.StartComputation(this.inputs[e]);return this.setState({Computing:!0,Messages:n}),this.SetDelay(this.CalculateNextMessages,e)}var a=this.computer.RunSetup(this.inputs[e]);if(a.length>0){var i=a.map(function(t){return{Content:t.Content,Channel:t.Channel,Order:e}});this.outputs=this.outputs.concat(i)}return this.handleNextInput(e+1)}},{key:"SetDelay",value:function(e,t){var n=this;return new Promise(function(a,i){var r=window.setTimeout(function(){return e(t).then(a).catch(i)},100*n.state.StepTime);n.cancelComputation=function(){window.clearTimeout(r),i("Cancelled")}})}},{key:"stopComputation",value:function(){var e=this;return new Promise(function(t){e.cancelComputation&&(e.cancelComputation(),e.cancelComputation=void 0),e.setState({Messages:[],Computing:!1},function(){return t()})})}},{key:"CalculateNextMessages",value:function(e){var t=this.computer.GetNextMessages(this.state.Messages),n=Object(c.a)(t,2),a=n[0],i=n[1];if(i.length>0){var r=i.map(function(t){return{Content:t.Content,Channel:t.Channel,Order:e}});this.outputs=this.outputs.concat(r)}return this.setState({Messages:a}),a.length>0?this.SetDelay(this.CalculateNextMessages,e):this.handleNextInput(e+1)}},{key:"componentDidMount",value:function(){var e=this;document.addEventListener("keyup",function(t){return e.handleKeyPress(t)},!1)}},{key:"componentWillUnmount",value:function(){var e=this;document.removeEventListener("keyup",function(t){return e.handleKeyPress(t)},!1)}},{key:"PlayTest",value:function(e){return this.inputs=e,this.startComputation()}},{key:"GridSetupChanged",value:function(e){this.gameData.ActiveSetup=e,this.computer.NewSetup(e);var t=this.computer.CalculateExits();this.setState({GridSetup:e,ShowingSetup:!1,ExitCells:t})}},{key:"NewGameDataLoaded",value:function(e){this.gameData=e,this.machineStore.ReloadCustomMachines(e.SavedMachines),this.computer.NewSetup(e.ActiveSetup);var t=this.computer.CalculateExits(),n=this.machineStore.GetAllMachine();this.setState({GridSetup:e.ActiveSetup,ShowingSetup:!1,ExitCells:t,Machines:n})}},{key:"SaveCustomMachine",value:function(e){var t={MachineType:e,Setup:this.state.GridSetup},n=this.machineStore.AddCustomMachine(t);this.gameData.SavedMachines.push(n);var a=this.machineStore.GetAllMachine();this.setState({Machines:a})}},{key:"StepTimeChanged",value:function(e){this.setState({StepTime:e})}},{key:"OnShowingSetup",value:function(){this.setState({ShowingSetup:!0})}},{key:"LevelSelected",value:function(e){this.setState({SelectedLevel:e})}},{key:"handleKeyPress",value:function(e){switch(e.key){case"Enter":this.startComputation();break;case" ":this.stopComputation()}}},{key:"render",value:function(){var e=this,t=this.computer.GetStartMachines().map(function(e){return e.MachineId});t.push({Id:1,Type:"Default"});var n=this.state.Machines.filter(function(e){return!t.some(function(t){return t.Id===e.Id.Id&&t.Type===e.Id.Type})}),i=[a.Green];return r.a.createElement("div",{style:{display:"flex",flexFlow:"column wrap"}},r.a.createElement("div",null,r.a.createElement("h2",{style:{textAlign:"center"}},"LogicBoxes")),r.a.createElement("div",{style:{display:"flex",flexFlow:"row wrap"}},r.a.createElement("div",{style:{flex:"1 1 200px"}},r.a.createElement(Ce,{ItemName:"Settings"},r.a.createElement(ve,{Setup:this.gameData,OnSetupChanged:this.GridSetupChanged,OnDataChanged:this.NewGameDataLoaded,ShowSetup:this.state.ShowingSetup,OnShowingSetup:this.OnShowingSetup})),r.a.createElement(Ce,{ItemName:"Challenges"},r.a.createElement(ue,{OnLevelClicked:this.LevelSelected})),r.a.createElement($,{Level:this.state.SelectedLevel,PlayTest:this.PlayTest,MultipleInputsAllowed:!1,AllowedInputs:i})),r.a.createElement("div",{style:{display:"flex",flex:"4 1 400px",flexFlow:"column",alignItems:"center"}},r.a.createElement("div",null,r.a.createElement(Z,{GridSetup:this.state.GridSetup,Computing:this.state.Computing,Messages:this.state.Messages,OnChanged:this.GridSetupChanged,ExitCells:this.state.ExitCells})),r.a.createElement("div",null,r.a.createElement(L,{StepTime:this.state.StepTime,OnStepTimeChanged:this.StepTimeChanged,ShowAnimations:this.state.ShowAnimations,OnShowAnimationsChanged:function(t){return e.setState({ShowAnimations:t})}}))),r.a.createElement("div",{style:{display:"flex",flexDirection:"column",flexWrap:"wrap",flex:"1 1 200px",marginLeft:30}},r.a.createElement(de,{SaveCustomMachine:this.SaveCustomMachine,InputChannels:[],ExitCells:this.state.ExitCells}),r.a.createElement(pe,{allowedMachines:n}))))}}]),t}(r.a.Component),be=function(){return r.a.createElement(s.b,{backend:u.a},r.a.createElement(ge,null))};n(31);l.a.render(r.a.createElement(be,null),document.getElementById("root"))}},[[22,1,2]]]);
//# sourceMappingURL=main.f748cd5d.chunk.js.map