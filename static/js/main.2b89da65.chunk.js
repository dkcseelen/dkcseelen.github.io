(window.webpackJsonpdseoefen=window.webpackJsonpdseoefen||[]).push([[0],{13:function(e,t,n){},23:function(e,t,n){e.exports=n(33)},28:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var i,a,r=n(0),o=n.n(r),u=n(18),s=n.n(u),c=(n(28),n(13),n(2)),l=n(3),h=n(8),p=n(6),d=n(4),f=n(7);!function(e){e.Up="UP",e.Down="DOWN",e.Left="LEFT",e.Right="RIGHT"}(i||(i={})),function(e){e.Green="green",e.Red="red",e.Blue="blue",e.Yellow="yellow"}(a||(a={}));var C=function(){function e(){Object(c.a)(this,e),this.GridSetup=void 0,this.LoadSetup()}return Object(l.a)(e,[{key:"LoadGridSetup",value:function(){if(void 0===this.GridSetup)throw new Error("Setup not loaded");return this.GridSetup}},{key:"LoadSetup",value:function(){this.GridSetup={NumberOfRows:5,NumberOfColumns:6,MachineInstances:[{Cell:{Row:0,Column:1},Channels:[{Channel:a.Green,Direction:i.Down}],InputChannels:void 0,MachineId:{Id:1,Type:"Default"},Id:1},{Cell:{Row:1,Column:1},Channels:[{Channel:a.Green,Direction:i.Right}],InputChannels:void 0,MachineId:{Id:5,Type:"Default"},Id:2},{Cell:{Row:1,Column:2},Channels:[{Channel:a.Green,Direction:i.Down}],InputChannels:void 0,MachineId:{Id:5,Type:"Default"},Id:3}]}}}]),e}(),m=n(22),v=n(11),S=function e(){Object(c.a)(this,e)};S.CellSize=100;var g=function(e){function t(){return Object(c.a)(this,t),Object(h.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=S.CellSize/5*3,t=e/10,n={height:e,width:e,backgroundColor:this.props.Machine.Color,borderStyle:"solid",borderColor:this.props.Machine.BorderColor,borderWidth:t,borderRadius:"50%",marginLeft:(S.CellSize-e)/2-t,marginTop:(S.CellSize-e)/2-t};return o.a.createElement("div",{style:n})}}]),t}(o.a.Component),b=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).onClicked=n.onClicked.bind(Object(d.a)(n)),n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e={position:"absolute",height:S.CellSize/50*4,width:S.CellSize/50*19,marginLeft:S.CellSize/50*27.5,marginTop:S.CellSize/50*22.5,backgroundColor:this.props.ChannelMap.Channel,borderStyle:"solid",borderWidth:"1px",pointerEvents:"visible"},t="";switch(this.props.ChannelMap.Direction){case i.Down:t="rotate(90deg)";break;case i.Left:t="rotate(180deg)";break;case i.Up:t="rotate(270deg)";break;case i.Right:t="rotate(0deg)"}var n={transform:t,height:S.CellSize,width:S.CellSize,position:"absolute",pointerEvents:"none"};return o.a.createElement("div",{style:n},o.a.createElement("div",{style:e,onClick:this.onClicked}))}},{key:"onClicked",value:function(e){var t=i.Left;switch(this.props.ChannelMap.Direction){case i.Down:t=i.Left;break;case i.Left:t=i.Up;break;case i.Up:t=i.Right;break;case i.Right:t=i.Down}console.log("Clicked"+this.props.ChannelMap.Channel),this.props.OnChanged({Direction:t,Channel:this.props.ChannelMap.Channel})}}]),t}(o.a.Component),y=n(9),O="MachineInstance",w="NewMachine",M=function(){function e(){Object(c.a)(this,e),this.actor={Act:function(e){var t=[];return t.push({Content:e.Content,Channel:a.Green}),t}},this.Id={Id:5,Type:"Default"}}return Object(l.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Color:"green",BorderColor:"lightgreen",NumberOfOutputs:1,NumberOfInputs:1,Name:"Move"}}}]),e}(),I=function(){function e(){Object(c.a)(this,e),this.actor={Act:function(e){var t=[];return t.push({Content:e.Content,Channel:a.Green}),t}},this.Id={Id:1,Type:"Default"}}return Object(l.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{Color:"white",BorderColor:"red",NumberOfOutputs:1,NumberOfInputs:1,Name:"Start"}}}]),e}(),G=function(){function e(){Object(c.a)(this,e),this.actor={Act:function(e){var t=[],n=e.Content.length>0?e.Content[0]+e.Content:"";return t.push({Content:n,Channel:a.Green}),t}},this.Id={Id:6,Type:"Default"}}return Object(l.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{BorderColor:"green",Color:"yellow",Name:"Copy",NumberOfInputs:1,NumberOfOutputs:1}}}]),e}(),k=function(){function e(){Object(c.a)(this,e),this.actor={Act:function(e){var t=[],n=e.Content.length>0?e.Content.slice(1):"";return t.push({Content:n,Channel:a.Green}),t}},this.Id={Id:7,Type:"Default"}}return Object(l.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{BorderColor:"red",Color:"red",Name:"Delete",NumberOfInputs:1,NumberOfOutputs:1}}}]),e}(),j=function(){function e(){Object(c.a)(this,e),this.actor={Act:function(e){var t,n=[];return t=e.Content.length>1?e.Content.slice(1)+e.Content.slice(0,1):e.Content,n.push({Content:t,Channel:a.Green}),n}},this.Id={Id:8,Type:"Default"}}return Object(l.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{BorderColor:"blue",Color:"cyan",Name:"Rotate",NumberOfInputs:1,NumberOfOutputs:1}}}]),e}(),N=function(){function e(){Object(c.a)(this,e),this.actor={Act:function(e){var t=[],n=e.Content.length>1&&e.Content[0]===e.Content[1]?a.Green:a.Red;return t.push({Content:e.Content,Channel:n}),t}},this.Id={Id:9,Type:"Default"}}return Object(l.a)(e,[{key:"GetActor",value:function(){return this.actor}},{key:"GetType",value:function(){return{BorderColor:"red",Color:"green",Name:"Compare",NumberOfInputs:2,NumberOfOutputs:1}}}]),e}(),E=function(){function e(){Object(c.a)(this,e),this.machines=void 0,this.machines=[],this.init()}return Object(l.a)(e,[{key:"init",value:function(){this.machines=[],this.machines.push(new I),this.machines.push(new M),this.machines.push(new G),this.machines.push(new k),this.machines.push(new j),this.machines.push(new N)}},{key:"FindMachine",value:function(e){var t=this.machines.find(function(t){return t.Id.Id===e.Id&&t.Id.Type===e.Type});if(void 0===t)throw new Error("No machine found with id "+e.Id+" and type "+e.Type);return t}},{key:"GetActor",value:function(e){return this.FindMachine(e).GetActor()}},{key:"GetMachineType",value:function(e){return this.FindMachine(e).GetType()}},{key:"GetAllMachine",value:function(){return this.machines}}],[{key:"GetStore",value:function(){return void 0===e.machineStore&&(e.machineStore=new e),e.machineStore}}]),e}();E.machineStore=void 0;var T=function(e){var t=Object(y.c)({item:{type:O,id:e.MachineInstance.Id},end:function(t,n){n.didDrop()||e.OnRemoved(e.MachineInstance.Id)},collect:function(e){return{isDragging:!!e.isDragging()}}}),n=Object(v.a)(t,2)[1],i=e.MachineInstance.Channels.map(function(t,n){return o.a.createElement("div",{key:n},o.a.createElement(b,{OnChanged:function(t){return function(t,n){var i={Cell:e.MachineInstance.Cell,MachineId:e.MachineInstance.MachineId,Channels:e.MachineInstance.Channels.map(function(e,i){return i===n?t:e}),InputChannels:e.MachineInstance.InputChannels,Id:e.MachineInstance.Id};e.OnChanged(i)}(t,n)},ChannelMap:t}))}),a=E.GetStore().GetMachineType(e.MachineInstance.MachineId);return o.a.createElement("div",{ref:n},o.a.createElement("div",{style:{position:"absolute"}},o.a.createElement(g,{Machine:a})),i)},R=function(e){var t=Object(y.d)({accept:[O,w],drop:function(t,n){switch(t.type){case O:e.OnMovedMachine(n.getItem().id,e.location);break;case w:var i=n.getItem();e.OnNewMachine(i.id,e.location)}}}),n=Object(v.a)(t,2)[1],i={height:S.CellSize,width:S.CellSize,border:"1px solid #999",float:"left",marginTop:-1,marginRight:-1,position:"relative"};return o.a.createElement("div",{style:i,ref:n},void 0!==e.message?e.message.Message:"",void 0!==e.machineInstance?o.a.createElement(T,{MachineInstance:e.machineInstance,OnChanged:e.OnChanged,OnRemoved:e.OnMachineRemoved}):"")},D=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).store=void 0,n.ChannelChanged=n.ChannelChanged.bind(Object(d.a)(n)),n.MachineMoved=n.MachineMoved.bind(Object(d.a)(n)),n.MachineAdded=n.MachineAdded.bind(Object(d.a)(n)),n.MachineRemoved=n.MachineRemoved.bind(Object(d.a)(n)),n.store=E.GetStore(),n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){for(var e=[],t=0;t<this.props.GridSetup.NumberOfRows;t++){for(var n=[],i=0;i<this.props.GridSetup.NumberOfColumns;i++){var a=void 0,r=void 0,u=!0,s=!1,c=void 0;try{for(var l,h=this.props.GridSetup.MachineInstances[Symbol.iterator]();!(u=(l=h.next()).done);u=!0){var p=l.value;p.Cell.Column===i&&p.Cell.Row===t&&(a=p)}}catch(g){s=!0,c=g}finally{try{u||null==h.return||h.return()}finally{if(s)throw c}}var d=!0,f=!1,C=void 0;try{for(var m,v=this.props.Messages[Symbol.iterator]();!(d=(m=v.next()).done);d=!0){var S=m.value;S.Cell.Column===i&&S.Cell.Row===t&&(r=S)}}catch(g){f=!0,C=g}finally{try{d||null==v.return||v.return()}finally{if(f)throw C}}n.push(o.a.createElement(R,{key:i,machineInstance:a,message:r,OnChanged:this.ChannelChanged,OnMovedMachine:this.MachineMoved,OnNewMachine:this.MachineAdded,OnMachineRemoved:this.MachineRemoved,location:{Row:t,Column:i}}))}e.push(o.a.createElement("div",{key:t},n))}return o.a.createElement("div",null,e)}},{key:"ChannelChanged",value:function(e){var t={NumberOfColumns:this.props.GridSetup.NumberOfColumns,NumberOfRows:this.props.GridSetup.NumberOfRows,MachineInstances:this.props.GridSetup.MachineInstances.map(function(t){return t.Cell.Column===e.Cell.Column&&t.Cell.Row===e.Cell.Row?e:t})};this.props.OnChanged(t)}},{key:"MachineMoved",value:function(e,t){var n=this.props.GridSetup.MachineInstances.findIndex(function(t){return t.Id===e});this.props.GridSetup.MachineInstances[n].Cell=t,this.props.OnChanged(this.props.GridSetup)}},{key:"MachineRemoved",value:function(e){this.props.GridSetup.MachineInstances=this.props.GridSetup.MachineInstances.filter(function(t){return t.Id!==e}),this.props.OnChanged(this.props.GridSetup)}},{key:"MachineAdded",value:function(e,t){var n=this.store.GetMachineType(e),r=[];n.NumberOfInputs>0&&r.push({Channel:a.Green,Direction:i.Up}),n.NumberOfInputs>1&&r.push({Channel:a.Red,Direction:i.Down}),n.NumberOfInputs>2&&r.push({Channel:a.Blue,Direction:i.Right}),n.NumberOfInputs>3&&r.push({Channel:a.Yellow,Direction:i.Left});var o={Cell:t,MachineId:e,Channels:r,InputChannels:[],Id:(0===this.props.GridSetup.MachineInstances.length?0:Math.max.apply(Math,Object(m.a)(this.props.GridSetup.MachineInstances.map(function(e){return e.Id}))))+1};this.props.GridSetup.MachineInstances.push(o),this.props.OnChanged(this.props.GridSetup)}}]),t}(o.a.Component),x=function(e){var t=Object(y.c)({item:{type:w,id:e.machine.Id},collect:function(e){return{isDragging:!!e.isDragging()}}}),n=Object(v.a)(t,2)[1],r=e.machine.GetType(),u=[];r.NumberOfInputs>0&&u.push({Channel:a.Green,Direction:i.Up}),r.NumberOfInputs>1&&u.push({Channel:a.Red,Direction:i.Down}),r.NumberOfInputs>2&&u.push({Channel:a.Blue,Direction:i.Right}),r.NumberOfInputs>3&&u.push({Channel:a.Yellow,Direction:i.Left});var s=u.map(function(e,t){return o.a.createElement(b,{key:t,ChannelMap:e,OnChanged:function(e){}})}),c={position:"absolute"};return o.a.createElement("div",{ref:n},o.a.createElement("div",{style:c},o.a.createElement(g,{Machine:e.machine.GetType()})),o.a.createElement("div",{style:c},s),o.a.createElement("label",null,r.Name))},L=function(e){var t=E.GetStore().GetAllMachine(),n={position:"relative",height:S.CellSize,width:S.CellSize},i=t.filter(function(t){return!e.disallowedMachines.some(function(e){return e.Id===t.Id.Id&&e.Type===t.Id.Type})}).map(function(e,t){return o.a.createElement("div",{style:n,key:t},o.a.createElement(x,{machine:e}))});return o.a.createElement("div",null,i)},A=function(){function e(t){Object(c.a)(this,e),this.setup=void 0,this.machines=[],this.store=void 0,this.setup=t,this.store=E.GetStore(),this.GetMachines()}return Object(l.a)(e,[{key:"NewSetup",value:function(e){this.setup=e,this.GetMachines()}},{key:"GetMachines",value:function(){var e=this;this.machines=this.setup.MachineInstances.map(function(t){return{id:t.Id,actor:e.store.GetActor(t.MachineId)}})}},{key:"GetStartMachines",value:function(){var e=[],t=!0,n=!1,i=void 0;try{for(var a,r=this.setup.MachineInstances[Symbol.iterator]();!(t=(a=r.next()).done);t=!0){var o=a.value;o.MachineId.Id<4&&"Default"===o.MachineId.Type&&e.push(o)}}catch(u){n=!0,i=u}finally{try{t||null==r.return||r.return()}finally{if(n)throw i}}return e}},{key:"StartComputation",value:function(e){var t=[],n=!0,i=!1,a=void 0;try{for(var r,o=this.GetStartMachines()[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){var u=r.value,s={Message:e,Direction:u.Channels[0].Direction,Cell:u.Cell};t.push(s)}}catch(c){i=!0,a=c}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}return t}},{key:"GetNextMessages",value:function(e){var t=this,n=[],i=!0,r=!1,o=void 0;try{for(var u,s=function(){for(var e=u.value,i=void 0,r=e.Cell;void 0===i&&void 0!==(r=t.Move(r,e.Direction));)i=t.setup.MachineInstances.find(function(e){return e.Cell.Column===r.Column&&e.Cell.Row===r.Row});if(void 0===r)return n.push({Cell:r,Direction:e.Direction,Message:e.Message}),"break";var o=a.Green,s=t.machines.find(function(e){return e.id===i.Id}).actor.Act({Content:e.Message,Channel:o}),c=!0,l=!1,h=void 0;try{for(var p,d=function(){var e=p.value,t=i.Channels.find(function(t){return t.Channel===e.Channel});if(void 0===t)throw Error("Channelmap "+e.Channel+"undefined");var a={Cell:i.Cell,Message:e.Content,Direction:t.Direction};n.push(a)},f=s[Symbol.iterator]();!(c=(p=f.next()).done);c=!0)d()}catch(C){l=!0,h=C}finally{try{c||null==f.return||f.return()}finally{if(l)throw h}}},c=e[Symbol.iterator]();!(i=(u=c.next()).done);i=!0){if("break"===s())break}}catch(l){r=!0,o=l}finally{try{i||null==c.return||c.return()}finally{if(r)throw o}}return n}},{key:"Move",value:function(e,t){switch(t){case i.Down:if(e.Row===this.setup.NumberOfRows-1)return;return{Column:e.Column,Row:e.Row+1};case i.Up:if(0===e.Row)return;return{Column:e.Column,Row:e.Row-1};case i.Right:if(e.Column===this.setup.NumberOfColumns-1)return;return{Column:e.Column+1,Row:e.Row};case i.Left:if(0===e.Row)return;return{Column:e.Column-1,Row:e.Row}}}}]),e}(),z=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).StepTimeChanged=n.StepTimeChanged.bind(Object(d.a)(n)),n.ShowSetupString=n.ShowSetupString.bind(Object(d.a)(n)),n.LoadSetup=n.LoadSetup.bind(Object(d.a)(n)),n.SetupStringChanged=n.SetupStringChanged.bind(Object(d.a)(n)),n.state={SetupString:""},n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.ShowSetup?this.state.SetupString:"";return o.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",flexDirection:"column",justifyContent:"center",alignItems:"center"}},o.a.createElement("label",null,"Step Time"),o.a.createElement("input",{value:this.props.StepTime,title:"Step time",onChange:this.StepTimeChanged}),o.a.createElement("button",{title:"Show setup string",onClick:this.ShowSetupString},"Show setup string"),o.a.createElement("input",{value:e,onChange:this.SetupStringChanged}),o.a.createElement("button",{title:"Load Setup",onClick:this.LoadSetup},"Load setup"))}},{key:"SetupStringChanged",value:function(e){this.setState({SetupString:e.target.value})}},{key:"StepTimeChanged",value:function(e){var t=e.target.value,n=Number(t);this.props.OnStepTimeChanged(n)}},{key:"ShowSetupString",value:function(){this.setState({SetupString:JSON.stringify(this.props.Setup)}),this.props.OnShowingSetup()}},{key:"LoadSetup",value:function(){var e=JSON.parse(this.state.SetupString);void 0!==e&&this.props.OnSetupChanged(e)}}]),t}(o.a.Component),B=function(e){function t(e){var n;Object(c.a)(this,t),(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).computer=void 0,n.runningComputation=void 0,n.startMachines=void 0,n.inputChanged=n.inputChanged.bind(Object(d.a)(n)),n.startComputation=n.startComputation.bind(Object(d.a)(n)),n.CalculateNextMessages=n.CalculateNextMessages.bind(Object(d.a)(n)),n.GridSetupChanged=n.GridSetupChanged.bind(Object(d.a)(n)),n.LoadSetup=n.LoadSetup.bind(Object(d.a)(n)),n.StepTimeChanged=n.StepTimeChanged.bind(Object(d.a)(n)),n.OnShowingSetup=n.OnShowingSetup.bind(Object(d.a)(n));var i=(new C).LoadGridSetup();return n.computer=new A(i),n.state={Computing:!1,Messages:[],GridSetup:i,Input:"",Output:"",StepTime:600,ShowingSetup:!1},n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"inputChanged",value:function(e){this.setState({Input:e.target.value})}},{key:"startComputation",value:function(){var e=this.computer.StartComputation(this.state.Input);this.setState({Computing:!0,Messages:e}),setTimeout(this.CalculateNextMessages,this.state.StepTime)}},{key:"CalculateNextMessages",value:function(){var e=this.computer.GetNextMessages(this.state.Messages),t=e.filter(function(e){return void 0===e.Cell});t.length>0&&this.setState({Output:t[0].Message});var n=e.filter(function(e){return void 0!==e.Cell});this.setState({Messages:n}),n.length>0?this.runningComputation=setTimeout(this.CalculateNextMessages,this.state.StepTime):this.setState({Computing:!1})}},{key:"LoadSetup",value:function(e){var t=JSON.parse(e.target.value);void 0!==t&&this.GridSetupChanged(t)}},{key:"render",value:function(){var e=this.computer.GetStartMachines().map(function(e){return e.MachineId}),t={height:this.state.GridSetup.NumberOfRows*(S.CellSize+2),width:this.state.GridSetup.NumberOfColumns*(S.CellSize+2)},n={display:"flex",flexWrap:"wrap",flexDirection:"column",justifyContent:"center",alignItems:"center"};return o.a.createElement("div",{style:n},o.a.createElement("h2",null,"StringCalculator"),o.a.createElement("div",{style:{display:"flex",flexWrap:"wrap",flexDirection:"row",justifyContent:"space-between"}},o.a.createElement("div",null,o.a.createElement(z,{Setup:this.state.GridSetup,OnSetupChanged:this.GridSetupChanged,StepTime:this.state.StepTime,OnStepTimeChanged:this.StepTimeChanged,ShowSetup:this.state.ShowingSetup,OnShowingSetup:this.OnShowingSetup})),o.a.createElement("div",{style:n},o.a.createElement("div",{className:"App",style:t},o.a.createElement(D,{GridSetup:this.state.GridSetup,Computing:this.state.Computing,Messages:this.state.Messages,OnChanged:this.GridSetupChanged})),o.a.createElement("div",null,o.a.createElement("input",{value:this.state.Input,onChange:this.inputChanged}),o.a.createElement("button",{onClick:this.startComputation,title:"start"},"Start")),o.a.createElement("label",null,"Output: ",this.state.Output)),o.a.createElement("div",null,o.a.createElement(L,{disallowedMachines:e}))))}},{key:"GridSetupChanged",value:function(e){this.computer.NewSetup(e),this.setState({GridSetup:e,ShowingSetup:!1})}},{key:"StepTimeChanged",value:function(e){this.setState({StepTime:e})}},{key:"OnShowingSetup",value:function(){this.setState({ShowingSetup:!0})}}]),t}(o.a.Component),U=n(21),W=function(){return o.a.createElement(y.b,{backend:U.a},o.a.createElement(B,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(W,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[23,1,2]]]);
//# sourceMappingURL=main.2b89da65.chunk.js.map